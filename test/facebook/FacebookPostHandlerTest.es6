import {Action} from '../../src/data/action.es6';
import {Comment} from '../../src/data/comment.es6';
import {Environment} from '../env/testEnv.es6';
import {FacebookPostHandler} from '../../src/facebook/FacebookPostHandler';
import {Post} from '../../src/data/post.es6';
import {Media} from '../../src/data/media.es6';
import {TestAid} from '../env/testAid.es6';
import {User} from '../../src/data/user.es6';

let subject = null;
let aid = new TestAid();
let chai = require('chai');
let env = new Environment();
let htmlparser = require('htmlparser2');

let CHARSET_TEST = '&charset_test=€,´,€,´,水,Д,Є'

describe('FacebookPostHandling ', function() {
  
  chai.should();
  this.error = (error) => chai.assert('Error thrown', false);

  var execute = (html) => {
		var parser = new htmlparser.Parser(subject, { recognizeSelfClosing: true });
		parser.write(html);
		parser.done();
  }
  
  var doTest = (done, html, expectedPost) => {
	subject = new FacebookPostHandler((error, data) => {
		// Propagate error
		if (error) {
			this.error(error);
		}

		// Validate the data
		aid.validate(expectedPost, data.post);

		// Successful
		done();
	});
	execute(html);
  }
  
	describe('#parse', function() {
    
	    it('multiple photos post', function(done) {
			let pageHtml = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><h1 class="i" id="header"><a class="j" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="k l" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="f"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_0"><div><div><h3 class="p q"><strong><a href="/mike.bur.3?fref=nf&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&amp;__tn__=C">Mike Bur</a></strong> added<a href="/story.php?story_fbid=10207137798899498&amp;id=1117810821&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&amp;__tn__=C">2 new photos</a>.</h3></div><div class="r"><p>Swim</p></div><div class="s"><div class="t u" style="width:205px; height:210px;"><a class="v w" href="/photo.php?fbid=10207137796139429&amp;id=1117810821&amp;set=pcb.10207137798899498&amp;source=48&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646" style="top:0px; left:0px;"><img src="https://scontent.fadl1-1.fna.fbcdn.net/hphotos-xtp1/v/t1.0-0/c27.0.106.213/p160x160/12348081_10207137796139429_6822283307896066403_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=3320fafade0bcf28d79f6147001a9fb8&amp;oe=56DB4836" width="104" height="210" class="x l" /></a><a class="v w" href="/photo.php?fbid=10207137796259432&amp;id=1117810821&amp;set=pcb.10207137798899498&amp;source=48&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646" style="top:0px; left:106px;"><img src="https://scontent.fadl1-1.fna.fbcdn.net/hphotos-xfl1/v/t1.0-0/c30.0.100.213/p160x160/12342467_10207137796259432_9116886526397470293_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=2b5e308d7465a2c7eab1c5c31763c522&amp;oe=56ECEDF7" width="99" height="210" class="x l" /></a></div></div></div><div class="y"><div class="z ba"><abbr>44 mins</abbr><span aria-hidden="true"> · </span><a class="bb" href="/profile.php?id=103317853043264&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Cottesloe</a><span aria-hidden="true"> · </span><span class="bc"><span><span class="z">Public</span></span></span></div><div class="z ba"><span aria-hidden="true"> · </span><a class="bd" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwMjA3NDY3t7SwsLQ0sbSoc80rCS5JLCktdi5KTSzJzM8LLskvqqyrMzQ0NLcwNLAwMqyrM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I1117810821%3A10207137798899498%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">More</a></div></div></div></div><div class="f be" id="ufi_10207137798899498"><div class="bf bg"><div class="bh bi bj"><table class="bk bl"><tbody><tr><td class="bm bn bo" style="width:33%"><a class="bp bq br bs" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10207137798899498&amp;av=550398225&amp;gfid=AQBVuYfvVw4HzHmO&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bt bu bv l" /><span class="bw">Like</span></a></td><td class="bm bn bo" style="width:33%"><a class="bp bq br bs" href="#composer-10207137798899498"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bt bu bv l" /><span class="bw">Comment</span></a></td><td class="bm bn bx bo" style="width:33%"><a class="bp bq br bs" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10207137798899498&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bt bu bv l" /><span class="bw">Share</span></a></td></tr></tbody></table></div><div class="by bz ca cb"><a href="/10207137798899498/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">4 people</a> like this.</div><div class="bf"><div class="by" id="10207137835660417"><h3><a class="cc" href="/wayne.burgess.7792?refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Wayne Burgess</a></h3><div>Beach looks good mike</div><div class="cd ce q"><span class="cf"><span class="cg ba"><a class="bd" href="/a/comment.php?like_comment_id=10207137835660417&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10207137798899498&amp;av=550398225&amp;gfid=AQDgRPgjdbJUR_1K&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10207137798899498_10207137835660417&amp;actor_id=550398225&amp;ft_ent_identifier=10207137798899498&amp;gfid=AQBtfkY8ITpTBizS&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646#comment_form_1117810821_10207137798899498">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDIwNzEzNzc5ODg5OTQ5OF8xMDIwNzEzNzgzNTY2MDQxNw%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Report</a><span aria-hidden="true"> · </span><abbr>32 minutes ago</abbr></div></div><div class="by" id="10207138080706543"><h3><a class="cc" href="/LiithaKrishnan?refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Liitha Krishnan</a></h3><div>Beautiful beach</div><div class="cd ce q"><span class="cf"><span class="cg ba"><a class="bd" href="/a/comment.php?like_comment_id=10207138080706543&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10207137798899498&amp;av=550398225&amp;gfid=AQDiYQZDS_NTxPaH&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10207137798899498_10207138080706543&amp;actor_id=550398225&amp;ft_ent_identifier=10207137798899498&amp;gfid=AQCgpuoSwMWpofw8&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646#comment_form_1117810821_10207137798899498">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDIwNzEzNzc5ODg5OTQ5OF8xMDIwNzEzODA4MDcwNjU0Mw%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Report</a><span aria-hidden="true"> · </span><abbr>26 minutes ago</abbr></div></div></div><div class="bf ch" id="u_0_1"></div><div class="ci cj" id="composer-10207137798899498"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=1&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10207137798899498&amp;gfid=AQDE_TTi8NjpNm9o&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQGDm4dPM5Tb" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ck" for="u_0_2">Write a comment...</label><table class="bk cl" id="u_0_2"><tbody><tr><td class="bm"><div class="cm cn"><table class="bk co cp"><tbody><tr><td class="bm cq bl"><input class="cr cs ct cu" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cv"><div class="cw"><input value="Comment" type="submit" class="bq cx cy cz" /></div></td></tr></tbody></table><span class="da z ba"><a href="/mbasic/comment/advanced/?target_id=10207137798899498&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10207137798899498%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10207137798899498%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>';
			let commentParameters = '&fb_dtsg=AQGDm4dPM5Tb' + CHARSET_TEST

			// Create the expected post (with additional properties for multiple photos)
			let expectedPost = {
				message: 'Swim',
				likeStatus: Post.LikeStatusNone,
				rawTimestamp: '44 mins',
				type: 'photo',
				media: [],
				actions: [
					new Action({ type: 'Share', target: '/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10207137798899498&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646' }),
					new Action({ type: 'Like', target: '/a/like.php?ul&perm&ifab&ft_ent_identifier=10207137798899498&av=550398225&gfid=AQBVuYfvVw4HzHmO&ref_component=mbasic_photo_permalink_actionbar&ref_page=%2Fwap%2Fstory.php&refid=52&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646' }),
					new Action({ type: 'Comment', target: '/a/comment.php?fs=8&actionsource=1&redirectosoftpermalink&comment_logging&ft_ent_identifier=10207137798899498&gfid=AQDE_TTi8NjpNm9o&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&av=550398225&refid=52' + commentParameters })
				]
			};
			expectedPost.multiplePhotos = [
				'/photo.php?fbid=10207137796139429&id=1117810821&set=pcb.10207137798899498&source=48&refid=52&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646',
				'/photo.php?fbid=10207137796259432&id=1117810821&set=pcb.10207137798899498&source=48&refid=52&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646'
			];
			expectedPost.firstCommentId = '10207137835660417'
			expectedPost.likeCount = 4
			expectedPost.username = '/mike.bur.3?fref=nf&refid=52&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&__tn__=C'

			// Undertake test
			doTest(done, pageHtml, expectedPost);
	    });

		it('multiple photos post (mk II)...', function(done) {
			let pageHtml = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comments</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"k\"><div class=\"l m\" id=\"u_0_0\"><div><div><h3 class=\"n o\"><strong><a href=\"/spandyandyfanpage/?refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051&amp;__tn__=C\">SpandyAndy</a></strong> added <a href=\"/story.php?story_fbid=10154563692109447&amp;id=22282574446&amp;refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051&amp;__tn__=C\">3 new photos</a>.</h3></div><div class=\"p\"><p>She said YES!! <img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yY/r/n0mjzFhUnLO.png\" width=\"16\" height=\"16\" class=\"m_fbEmoji_icon m_fbEmoji_size_16 img\" /><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yW/r/Pun6xYtLFfH.png\" width=\"16\" height=\"16\" class=\"m_fbEmoji_icon m_fbEmoji_size_16 img\" /></p></div><div class=\"q\"><div class=\"r s\" style=\"width:205px; height:205px;\"><a class=\"t u\" href=\"/spandyandyfanpage/photos/pcb.10154563692109447/10154563691004447/?type=3&amp;source=48&amp;refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051\" style=\"top:0px; left:0px; width: 205px; height: 102px;\"><img src=\"https://scontent.fper1-1.fna.fbcdn.net/hphotos-xft1/v/t1.0-0/cp0/e15/q65/c0.61.720.358/s206x206/12744264_10154563691004447_6147963670105064451_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=50e031d4d29367aef7f8416faa17846d&amp;oe=572C5150\" width=\"205\" height=\"102\" class=\"v img\" /></a><a class=\"t u\" href=\"/spandyandyfanpage/photos/pcb.10154563692109447/10154563691024447/?type=3&amp;source=48&amp;refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051\" style=\"top:104px; left:0px; width: 102px; height: 101px;\"><img src=\"https://scontent.fper1-1.fna.fbcdn.net/hphotos-xpt1/v/t1.0-0/cp0/e15/q65/c0.28.110.109/p110x80/12662437_10154563691024447_1923197365176613772_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=086521b85e2c4ebd9c873a7d371e1465&amp;oe=572BCF68\" width=\"102\" height=\"101\" class=\"v img\" /></a><a class=\"t u\" href=\"/spandyandyfanpage/photos/pcb.10154563692109447/10154563691044447/?type=3&amp;source=48&amp;refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051\" style=\"top:104px; left:104px; width: 101px; height: 101px;\"><img src=\"https://scontent.fper1-1.fna.fbcdn.net/hphotos-xpt1/v/t1.0-0/cp0/e15/q65/c20.0.118.118/p118x118/12744153_10154563691044447_524574582012007959_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=25b80aa543a5dde2e22dc0d227275528&amp;oe=576735EE\" width=\"101\" height=\"101\" class=\"v img\" /></a></div></div></div><div class=\"w\"><div class=\"x y\"><abbr>23 hrs</abbr><span aria-hidden=\"true\"> · </span><span class=\"z\"><span><span class=\"x\">Public</span></span></span></div><div class=\"x y\"><a class=\"ba bb\" href=\"/a/profile.php?fan&amp;id=22282574446&amp;origin=feed_story&amp;rb=1&amp;inlineSuggestionsOnLiking=1&amp;gfid=AQAUNQpw0TaT9W8N&amp;refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051\">Like Page</a><span aria-hidden=\"true\"> · </span><a class=\"ba\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDUxNTM2szQyNLA0MTGvc80rCS5JLCktdi5KTSzJzM8LLskvqqyrMzIysjAyNTcxMTGrqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I22282574446%3A10154563692109447%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10154563692109447%26id%3D22282574446%26bacr%3D1455510474%253A1455510474%253A1%253A4280141359045982182%253A1455509186%253A0%253A0%253A2160%26refid%3D7%26_ft_%3Dqid.6251370126177282241%253Amf_story_key.4912582124503217051&amp;refid=52&amp;_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051\">More</a></div></div></div></div></div></div></div></div></div></body></html>';

			let expectedPost = {
				multiplePhotos: [
					'/spandyandyfanpage/photos/pcb.10154563692109447/10154563691004447/?type=3&source=48&refid=52&_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051',
					'/spandyandyfanpage/photos/pcb.10154563692109447/10154563691024447/?type=3&source=48&refid=52&_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051',
					'/spandyandyfanpage/photos/pcb.10154563692109447/10154563691044447/?type=3&source=48&refid=52&_ft_=qid.6251370126177282241%3Amf_story_key.4912582124503217051'
				],
				type: 'photo'
			};

	      // Undertake test
	      doTest(done, pageHtml, expectedPost);
		});

	    it('status post', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><h1 class="i" id="header"><a class="j" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="k l" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="f"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_0"><div><div><h3 class="p q"><a href="/melanie.sagenschneider?refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095&amp;__tn__=C"><strong><a href="/melanie.sagenschneider?fref=nf&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095&amp;__tn__=C">Melanie Sagenschneider</a></strong><span class="fcg"> &gt; </span>‎<strong><a href="/profile.php?id=100006686568921&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095&amp;__tn__=C">Pam Sumner</a></strong></a></h3></div><div class="r"><p>Happy Birthday Nan!  Hope you have a lovely day &amp; we are thinking of you! Love Melanie xx</p></div></div><div class="s"><div class="t fcg"><abbr>1 hr</abbr><span aria-hidden="true"> · </span><span class="u"><span><span class="t">Friends</span></span></span></div><div class="t fcg"><span aria-hidden="true"> · </span><a class="v" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQ3MjUyNjIzNzc3sDQzMKxzzSsJT8zJCcgvLnEuSk0syczPCy7JL6qsqzM1szA2NDM0NamrM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I100006686568921%3A1725232677709601%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1725232677709601%26id%3D100006686568921%26bacr%3D1449801937%253A1449801937%253A12%253A3890930812153928679%253A1449773164%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6226861732912863536%253Amf_story_key.3562401730628574095&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095">More</a></div></div></div></div><div class="f w" id="ufi_1725232677709601"><div class="x y"><div class="z ba bb"><table class="bc bd"><tbody><tr><td class="be bf bg" style="width:33%"><a class="bh bi bj bk" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1725232677709601&amp;av=550398225&amp;gfid=AQBTPrEu2GcKGHUc&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bl bm bn l" /><span class="bo">Like</span></a></td><td class="be bf bg" style="width:33%"><a class="bh bi bj bk" href="#composer-1725232677709601"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bl bm bn l" /><span class="bo">Comment</span></a></td><td class="be bf bp bg" style="width:33%"><a class="bh bi bj bk" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=1725232677709601&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1725232677709601%26id%3D100006686568921%26bacr%3D1449801937%253A1449801937%253A12%253A3890930812153928679%253A1449773164%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6226861732912863536%253Amf_story_key.3562401730628574095&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bl bm bn l" /><span class="bo">Share</span></a></td></tr></tbody></table></div><div class="bq br bs bt"><a href="/james.sumner.505?refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095">James Sumner</a> likes this.</div><div class="x bu" id="u_0_1"></div><div class="bv bw" id="composer-1725232677709601"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=1725232677709601&amp;gfid=AQAVykz7SCvHIVbE&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQHiZqb_5Cci" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="bx" for="u_0_2">Write a comment...</label><table class="bc by" id="u_0_2"><tbody><tr><td class="be"><div class="bz ca"><table class="bc cb cc"><tbody><tr><td class="be cd bd"><input class="ce cf cg ch" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="ci"><div class="cj"><input value="Comment" type="submit" class="bi ck cl cm" /></div></td></tr></tbody></table><span class="cn t fcg"><a href="/mbasic/comment/advanced/?target_id=1725232677709601&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1725232677709601%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1725232677709601%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			let commentParameters = '&fb_dtsg=AQHiZqb_5Cci' + CHARSET_TEST
			let expectedPost = {
				message: "Happy Birthday Nan! Hope you have a lovely day & we are thinking of you! Love Melanie xx",
				likeStatus: Post.LikeStatusNone,
				rawTimestamp: '1 hr',
				type: 'status',
				media: [],
				comments: [],
				actions: [
					new Action({ type: 'Share', target:'/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=1725232677709601&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1725232677709601%26id%3D100006686568921%26bacr%3D1449801937%253A1449801937%253A12%253A3890930812153928679%253A1449773164%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6226861732912863536%253Amf_story_key.3562401730628574095&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095' }),
					new Action({ type: 'Like', target: '/a/like.php?ul&perm&ifab&ft_ent_identifier=1725232677709601&av=550398225&gfid=AQBTPrEu2GcKGHUc&ref_component=mbasic_photo_permalink_actionbar&ref_page=%2Fwap%2Fstory.php&refid=52&_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095' }),
					new Action({ type: 'Comment', target: '/a/comment.php?fs=8&actionsource=13&redirectosoftpermalink&comment_logging&ft_ent_identifier=1725232677709601&gfid=AQAVykz7SCvHIVbE&_ft_=qid.6226861732912863536%3Amf_story_key.3562401730628574095&av=550398225&refid=52' + commentParameters })
				]
			}
			doTest(done, html, expectedPost);
	    });

		it('video post', function(done) {
			let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comments</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"l\"><div class=\"m n\" id=\"u_0_2\"><div><div><h3 class=\"o p\"><strong><a href=\"/aztech.brando?fref=nf&amp;refid=52&amp;_ft_=qid.6251338571084953341%3Amf_story_key.-8293789335585162370&amp;__tn__=C\">Arron Vincent</a></strong> shared <a href=\"/JaneFooleSays/?refid=52&amp;_ft_=qid.6251338571084953341%3Amf_story_key.-8293789335585162370&amp;__tn__=C\">Jane Foole Says</a>&#039;s <a href=\"/story.php?story_fbid=1055725124493865&amp;id=270363256363393&amp;refid=52&amp;_ft_=qid.6251338571084953341%3Amf_story_key.-8293789335585162370&amp;__tn__=C\">video</a>.</h3></div><div class=\"q\"><div class=\"r s m t\" id=\"u_0_3\"><div><h3 class=\"o u\"><a href=\"/JaneFooleSays/?refid=52&amp;_ft_=qid.6251338571084953341%3Amf_story_key.-8293789335585162370&amp;__tn__=C\">Jane Foole Says</a></h3><div class=\"v\"><p>This is hilarious. A message to Americans.</p></div><div class=\"q\"><div class=\"w\"><div class=\"x\"><a class=\"y\" href=\"/video_redirect/?src=https%3A%2F%2Fvideo.fper1-1.fna.fbcdn.net%2Fhvideo-xpl1%2Fv%2Ft42.1790-2%2F12706639_1087008207989493_453396679_n.mp4%3Fefg%3DeyJ2ZW5jb2RlX3RhZyI6InN2ZV9zZCJ9%26oh%3D3a94423a9b953edf6cd9caf5a64e70e8%26oe%3D56C15F47&amp;source=misc&amp;id=1055725124493865&amp;refid=52&amp;_ft_=qid.6251338571084953341%3Amf_story_key.-8293789335585162370&amp;__tn__=F\" target=\"_blank\"><img src=\"https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQC_pNhu2wn-QAF_&amp;w=310&amp;h=175&amp;url=https%3A%2F%2Fscontent.fper1-1.fna.fbcdn.net%2Fhvthumb-xap1%2Fv%2Ft15.0-10%2Fcp0%2Fe15%2Fq65%2Fs320x320%2F12526038_1556331574693627_1301526843_n.jpg%3Fefg%3DeyJpIjoiYiJ9%26oh%3Dcfe01b1ce8446b2c75aedf541aeaf817%26oe%3D575CB673\" width=\"310\" height=\"175\" class=\"k\" /><div class=\"z\"><span style=\"display:block;height:0;overflow:hidden;position:absolute;width:0;padding:0\">Play Video</span><span class=\"ba bb\"></span></div></a></div></div></div></div></div></div></div><div class=\"bc\"><div class=\"bd be\"><abbr>11 mins</abbr><span aria-hidden=\"true\"> · </span><span class=\"bf\"><span><span class=\"bd\">Friends</span></span></span></div><div class=\"bd be\"><a class=\"bg\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQyNza3NDI3MbW0MLA0sKxzzSsJLkksKS12LkpNLMnMzwsuyS-qrKszNAABUwNTCwsDE1PDujqDOgA%22%2C%22story_permalink_token%22%3A%22S%3A_I100000505880451%3A1273792745980909%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1273792745980909%26id%3D100000505880451%26bacr%3D1455503183%253A1455503183%253A1%253A-8293789335585162370%253A1455502498%253A0%253A0%253A120%26refid%3D8%26_ft_%3Dqid.6251338571084953341%253Amf_story_key.-8293789335585162370&amp;refid=52&amp;_ft_=qid.6251338571084953341%3Amf_story_key.-8293789335585162370\">More</a></div></div></div></div></div></div></div></div></div></body></html>'
			let expectedPost = {
				type: 'video',
				media: [ new Media({
					description: '',
					duration: -1,
					imageUrl: 'https://scontent.fper1-1.fna.fbcdn.net/hvthumb-xap1/v/t15.0-10/cp0/e15/q65/s320x320/12526038_1556331574693627_1301526843_n.jpg?efg=eyJpIjoiYiJ9&oh=cfe01b1ce8446b2c75aedf541aeaf817&oe=575CB673',
					height: 175,
					mimeType: 'video/mp4',
					srcUrl: 'https://video.fper1-1.fna.fbcdn.net/hvideo-xpl1/v/t42.1790-2/12706639_1087008207989493_453396679_n.mp4?efg=eyJ2ZW5jb2RlX3RhZyI6InN2ZV9zZCJ9&oh=3a94423a9b953edf6cd9caf5a64e70e8&oe=56C15F47&source=misc&id=1055725124493865&refid=52&_ft_=qid.6251338571084953341:mf_story_key.-8293789335585162370&__tn__=F',
					type: 'video',
					width: 310
				})]
			};
			doTest(done, html, expectedPost);
		});

	    it('video YouTube post', function(done) {
	      let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div id="objects_container"><div class="l e" id="root" role="main"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_2"><div><div><div class="p q"><a class="r" href="/edit/post/dialog/?cid=S%3A_I100011376849188%3A247198072336086&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D247198072336086%26id%3D100011376849188%26refid%3D7&amp;perm&amp;loc=permalink&amp;refid=52">Edit</a><span aria-hidden="true"> · </span><a class="r" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100011376849188%3A247198072336086&amp;continue=%2Fstories.php%23s_479a444b1ce35692c3f897fc052a18ea&amp;refid=52">Delete</a></div><h3 class="s t"><a href="/feest.devisd?refid=52&amp;__tn__=C"><strong><a href="/feest.devisd?fref=nf&amp;refid=52&amp;__tn__=C">Feest Devisd</a></strong></a></h3></div><div class="u"><p>This YouTube will be of the working kind <a class="_5ayv" href="/hashtag/dab33f?refid=52&amp;__tn__=%2As"><span class="_5aw4">‪#‎</span><span class="_5ayu">dab33f‬</span></a></p><p></p></div><div class="v"><a class="w x" href="https://mbasic.facebook.com/l.php?u=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DC-7v5PTL7-8&amp;h=1AQHmComS&amp;s=1" id="u_0_3" target="_blank"><div class="e y z"><table class="ba bb"><tbody><tr><td class="bc bd"><img src="https://external.fper2-1.fna.fbcdn.net/safe_image.php?d=AQCbi5hVqeLVs2gp&amp;w=112&amp;h=112&amp;url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FC-7v5PTL7-8%2Fmaxresdefault.jpg&amp;cfs=1&amp;jq=75&amp;sx=468&amp;sy=0&amp;sw=1080&amp;sh=1080&amp;ext=jpg" width="112" height="112" class="k" /></td><td class="be"><h3 class="bf t bg">◀MechWarrior Online - Point-Blank AMS</h3><div class="bf bh">youtube.com<div class="bf"></div></div></td></tr></tbody></table></div></a></div></div><div class="bi"><div class="p q"><abbr>1 min</abbr><span aria-hidden="true"> · </span><span class="bj"><div><span class="p">Privacy:&nbsp;</span><span class="p"><a href="/privacyx/selector/?redir=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D247198072336086%26id%3D100011376849188%26refid%3D7&amp;ci=247198072336086&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQB50my7FXAiTx_N&amp;refid=52">Public</a></span></div></span></div><div class="p q"><a class="r" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzIxN7S0MDA3MjY2M7Awq3PNKwkuSSwpLXYuSk0syczPCy7JL6qsqzM0MDAwNDQ2N7MwsTS0sKirM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I100011376849188%3A247198072336086%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D247198072336086%26id%3D100011376849188%26refid%3D7&amp;refid=52">More</a></div></div></div></div><div class="e bk" id="ufi_247198072336086"><div class="bl bm"><div class="bn bo bp"><table class="ba bq"><tbody><tr><td class="be br bs" style="width:33%"><a class="bt bu bv bw" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=247198072336086&amp;av=100011376849188&amp;gfid=AQA88IBLYuSrjeb_&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bx by bz k" /><span class="ca">Like</span></a></td><td class="be br bs" style="width:33%"><a class="bt bu bv bw" href="#composer-247198072336086"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bx by bz k" /><span class="ca">Comment</span></a></td><td class="be br cb bs" style="width:33%"><a class="bt bu bv bw" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100011376849188&amp;sid=247198072336086&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D247198072336086%26id%3D100011376849188%26refid%3D7&amp;cwevent=composer_entry&amp;av=100011376849188&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bx by bz k" /><span class="ca">Share</span></a></td></tr></tbody></table></div></div></div></div></div></div></div></div></body></html>';
	      let expectedPost = {
	          media: [
	            new Media({
					height: 112,
					imageUrl: 'https://i.ytimg.com/vi/C-7v5PTL7-8/maxresdefault.jpg',
					mimeType: 'video/mp4',
					srcUrl: 'https://www.youtube.com/watch?v=C-7v5PTL7-8',
					type: 'video',
					width: 112
	            })
	          ],
	          message: 'This YouTube will be of the working kind #dab33f'
	      };
	      doTest(done, html, expectedPost);
	    });

	    it('YouTube video without any message body', function(done) {
	      let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div id="objects_container"><div class="l e" id="root" role="main"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_2"><div><div><h3 class="p q"><a href="/profile.php?id=100009834785112&amp;refid=52&amp;_ft_=qid.6280990523015808240%3Amf_story_key.3041832413550711856&amp;__tn__=C"><strong><a href="/profile.php?id=100009834785112&amp;fref=nf&amp;refid=52&amp;_ft_=qid.6280990523015808240%3Amf_story_key.3041832413550711856&amp;__tn__=C">Skooter Martin</a></strong></a></h3></div><div class="r"><p><a href="https://mbasic.facebook.com/l.php?u=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DOZOrIHeEN3s&amp;h=nAQFiUmj7&amp;enc=AZP-exKglVIi7i1k0jG8jLeSnRV1rZVER-fieDSi3MepVZx5nIK6uz-meP-Syt06zQUwdAdtYqQTittiLQoMbG57RevhHol8KNMbyEcQty8VSxcQErIv2Tatoy7oEz1FFyeBqctUu7fUqVFjSvaMVYjC9f6ZVG4TQ7XME-OAGmFyag&amp;s=1" target="_blank"><span>https://</span><wbr /><span class="word_break"></span><span>www.youtube.com/</span><wbr /><span class="word_break"></span><span>watch?v=OZOrIHeE</span><wbr /><span class="word_break"></span>N3s</a></p></div><div class="s"><a class="t u" href="https://mbasic.facebook.com/l.php?u=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DOZOrIHeEN3s&amp;h=AAQGWBM-X&amp;enc=AZMHehQhpizsXfJJUN6HCI_b4WiE0nMtX-NrUEF6XDlnsh7TAFu56i57CE5H_VlOT9m735x3NvD7RJJdv6K13TP9tsLgy8Y6DNlTGu0uEF8e3xDneOfF7PYwXMjC4GOfK2hGpaH38MOURRNZD-jDffvT&amp;s=1" id="u_0_3" target="_blank"><div class="e v w"><table class="x y"><tbody><tr><td class="z ba"><img src="https://external.fper2-1.fna.fbcdn.net/safe_image.php?d=AQDx8bf7MVxAoWU4&amp;w=112&amp;h=112&amp;url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FOZOrIHeEN3s%2Fhqdefault.jpg&amp;cfs=1&amp;jq=75&amp;sx=24&amp;sy=0&amp;sw=360&amp;sh=360&amp;ext=jpg" width="112" height="112" class="k" /></td><td class="bb"><h3 class="bc q bd">Muse – Sign O’ The Times (Prince cover)</h3><div class="bc be">youtube.com<div class="bc"></div></div></td></tr></tbody></table></div></a></div></div><div class="bf"><div class="bg bh"><abbr>15 hrs</abbr><span aria-hidden="true"> · </span><span class="bi"><span><span class="bg">Public</span></span></span></div><div class="bg bh"><a class="bj" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzI3MDU2NTAyNrIwMTYyqnPNKwkuSSwpLXYuSk0syczPCy7JL6qsqzM0AAJLC2MTcwtTQ0OjujqDOgA%22%2C%22story_permalink_token%22%3A%22S%3A_I100009834785112%3A270535023284322%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D270535023284322%26id%3D100009834785112%26bacr%3D1462350941%253A1462350941%253A3%253A3041832413550711856%253A1462350756%253A0%253A0%253A1620%26refid%3D28%26_ft_%3Dqid.6280990523015808240%253Amf_story_key.3041832413550711856&amp;refid=52&amp;_ft_=qid.6280990523015808240%3Amf_story_key.3041832413550711856">More</a></div></div></div></div><div class="e bk" id="ufi_270535023284322"><div class="bl bm"><div class="bn bo bp"><table class="x bq"><tbody><tr><td class="bb br bs" style="width:33%"><a class="bt bu bv bw" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=270535023284322&amp;av=100011376849188&amp;gfid=AQBwHfjHk6nYR6Rp&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6280990523015808240%3Amf_story_key.3041832413550711856"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bx by bz k" /><span class="ca">Like</span></a></td><td class="bb br bs" style="width:33%"><a class="bt bu bv bw" href="#composer-270535023284322"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bx by bz k" /><span class="ca">Comment</span></a></td><td class="bb br cb bs" style="width:33%"><a class="bt bu bv bw" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100011376849188&amp;sid=270535023284322&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D270535023284322%26id%3D100009834785112%26bacr%3D1462350941%253A1462350941%253A3%253A3041832413550711856%253A1462350756%253A0%253A0%253A1620%26refid%3D28%26_ft_%3Dqid.6280990523015808240%253Amf_story_key.3041832413550711856&amp;cwevent=composer_entry&amp;av=100011376849188&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6280990523015808240%3Amf_story_key.3041832413550711856"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bx by bz k" /><span class="ca">Share</span></a></td></tr></tbody></table></div></div></div></div></div></div></div></div></body></html>';
	      let expectedPost = {
	          media: [
	            new Media({
					height: 112,
					imageUrl: 'https://i.ytimg.com/vi/OZOrIHeEN3s/hqdefault.jpg',
					mimeType: 'video/mp4',
					srcUrl: 'https://www.youtube.com/watch?v=OZOrIHeEN3s',
					type: 'video',
					width: 112
	            })
	          ],
	          message: 'https://www.youtube.com/watch?v=OZOrIHeEN3s'
	      };
	      doTest(done, html, expectedPost);
	    });

		it('link to non-preview YouTube should have a link...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Brisbane Broncos : We Will Rise</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="be"><div class="bf bg" data-ft="{&quot;top_level_post_id&quot;:&quot;1689258124704032&quot;}" id="u_0_8"><div><div><h3 class="bh bi"><strong><a href="/BBFCjacob06?refid=18&amp;__tn__=C">Jacob Chaperon</a></strong>shared a <a href="/story.php?story_fbid=1792441317744131&amp;id=1555512511411928&amp;refid=18&amp;__tn__=C">link</a>to the group: <a href="/groups/1555512511411928?refid=18&amp;__tn__=C">Brisbane Broncos : We Will Rise</a>.</h3></div><div class="bj" style=""><p>Before the new season starts here are some of the best tries of the Brisbane broncos 2016 season</p></div><div class="bk bl"><a class="bm bn" href="https://lm.facebook.com/l.php?u=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DnT_c6IYjF-Y%26sns%3Dfb&amp;h=ATNKdSvwZSBLbJyd6GepO_ouDOxbHCyrq1ABdpm5qTCUK0HIaNzRMEborpcbA5Cm5gqB2bKxdLqPaBHCr6_7Xe9E9bvBQETtvB1DoVpiONlmxIPdnOXFIa6Ol0AqlYaD2hrdnKyRU6yS&amp;enc=AZPeBLn6-uKCta4zrZy3tAL_2ALg31fOxL6Qjz4eP9jjMbwxrrNh5Iu3qLkJlJj40YjZPFVtDe2DUWjaj6nzAyZebFZ8CLAoI0A-4Jq13NFQEWMayAPqtV7tyyffeZP_5xHlzh32V3kiMXS5wzo9-G2E&amp;s=1" id="u_0_9" target="_blank"><div class="e bo bp"><h3 class="bq br bs">Brisbane Broncos - Best Tries 2016 HD</h3><div class="bq bt">youtube.com<div class="bq"/></div></div></a></div></div><div class="bu"><div class="bv bw"><abbr>10 mins</abbr><span aria-hidden="true">· </span><span class="bx"><span><span class="bv">Brisbane Broncos...</span></span></span></div><div class="bv bw"><a href="/save/story/basic/?story_id=S%3A_I100009348419792%3AVK%3A1689258124704032&amp;action=SAVE&amp;surface=mbasic_story&amp;mechanism=ufi_action_link&amp;ext=1488338307&amp;hash=AeTh8TMy-Z_fXtKs&amp;refid=18">Save</a><span aria-hidden="true">· </span><a class="by" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzSzsDQytTA0MjE3MDEwNqpzzStxL8ovLfBNzMkJyC8ucS5KTSzJzM8LLskvqqyrMzQwMDCwNDaxMDG0NLc0qqszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I100009348419792%3AVK%3A1689258124704032%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1555512511411928%3Fview%3Dpermalink%26id%3D1689258124704032%26bacr%3D1488079102%253A1488079102%253A1%253A-8645175186577234977%253A1488078492%253A6391251081933409409%26refid%3D8%26_ft_%3Dqid.6391251081933409409%253Amf_story_key.-8645175186577234977%253Atop_level_post_id.1689258124704032&amp;refid=18">More</a></div></div></div></div><div class="e bz" id="ufi_1689258124704032"><div class="ca cb"><div class="cc cd ce cf"><table class="l cg" role="presentation"><tbody><tr><td class="s ch ci" style="width:25%"><a aria-pressed="false" class="cj x ck cl" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1689258124704032&amp;av=100014089845510&amp;gfid=AQBVcdGKcBPbtzKl&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fprofile_tribe.php&amp;refid=18" role="button"><img aria-hidden="true" class="cm cn co r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yc/r/yB-I64VDoBZ.png" width="16"/><span class="cp">Like</span></a></td><td class="s ch ci" style="width:25%"><a aria-pressed="false" class="cj x ck cl" href="/reactions/picker/?ft_id=1689258124704032&amp;origin_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1555512511411928%3Fview%3Dpermalink%26id%3D1689258124704032%26bacr%3D1488079102%253A1488079102%253A1%253A-8645175186577234977%253A1488078492%253A6391251081933409409%26refid%3D8%26_ft_%3Dqid.6391251081933409409%253Amf_story_key.-8645175186577234977%253Atop_level_post_id.1689258124704032&amp;av=100014089845510&amp;refid=18" role="button"><img aria-hidden="true" class="cm cn r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/4o8rk0I8aTS.png" width="16"/><span class="cp">React</span></a></td><td class="s ch ci" style="width:25%"><a class="cj x ck cl" href="#composer-1689258124704032"><img aria-hidden="true" class="cm cn co r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yx/r/Psiw6TN0rH8.png" width="16"/><span class="cp">Comment</span></a></td><td class="s ch cq ci" style="width:25%"><a class="cj x ck cl" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100014089845510&amp;sid=1689258124704032&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1555512511411928%3Fview%3Dpermalink%26id%3D1689258124704032%26bacr%3D1488079102%253A1488079102%253A1%253A-8645175186577234977%253A1488078492%253A6391251081933409409%26refid%3D8%26_ft_%3Dqid.6391251081933409409%253Amf_story_key.-8645175186577234977%253Atop_level_post_id.1689258124704032&amp;cwevent=composer_entry&amp;av=100014089845510&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fprofile_tribe.php&amp;refid=18"><img aria-hidden="true" class="cm cn co r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yU/r/qQMCy4a8cyx.png" width="16"/><span class="cp">Share</span></a></td></tr></tbody></table></div></div></div></div></div></div></div></div></body></html>';
			doTest(done, html, {
				media: [{
					imageUrl: '',
					srcUrl:  'https://www.youtube.com/watch?v=nT_c6IYjF-Y&sns=fb',
					type: 'video'
				}]
			});
		});

	    it('post without like/comment action', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="default" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .k{background:#f6f7f8;border:0;font-size:small;margin:0;}.k .n{font-size:x-small;}.l{margin:0 6px 6px;padding:6px;}.b .l .l{border-color:#e9eaed;margin:6px 0 0;}.z{display:inline-block;}.y{margin-top:5px;}.s,.t{margin:5px 0;}.l a,.l a:visited{color:#2b55ad;}.l a:hover,.l a:focus{background:#2b55ad;color:#fff;}.k .l{font-size:small;padding:4px;}.k .y{margin-top:6px;}.k .s,.k .t{margin:6px 0;}.b .m{background:white;margin:0;}.ca{color:#9197a3;}.q{color:#4e5665;}.bz{font-size:12px;line-height:16px;}.r{font-weight:normal;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .p,.b .p:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .p:focus,.b .p:hover{background-color:#3b5998;color:#fff;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}.o{color:gray;}.n{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.w{background:#000;cursor:pointer;display:inline-block;height:100%;overflow:hidden;position:relative;}.x{left:50%;position:absolute;top:50%;}.x{background-image:url(https://static.xx.fbcdn.net/rsrc.php/v2/yN/r/oltliAXqFO7.png);background-repeat:no-repeat;background-size:auto;background-position:0 0;height:68px;margin:-34px 0 0 -34px;width:68px;}.bc .bv a{font-weight:bold;}.bb>div{border-top:1px solid rgba(0, 0, 0, .101);}.bb>.bb>div:first-child{border-top:none;}.ba,.ba .bx{background-color:#f6f7f8;color:#141823;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;-webkit-transform:translateY(0%);}to{opacity:0;-webkit-transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;-webkit-transform:translateY(10%);}to{opacity:1;-webkit-transform:translateY(0%);}}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .bf{border-color:#ddd;border-width:1px 0 0;}.b .bf .bj{background-color:#f6f7f8;}.b .bf .bj:hover,.b .bf .bj:hover .bo{background-color:#e9eaed;}.b .bf .bo{background-color:inherit;}.be{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.bd .bo,.bd .bj{background-color:#fff;}.b .bg{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .bg tbody{vertical-align:top;}.b .bh>tr>td,.b .bh>tbody>tr>td,.b .bg td.bh{vertical-align:middle;}.b .bg td{padding:0;}.b .bg td.bu{padding:4px;}.b .bi{width:100%;}.bj{background-color:#fff;position:relative;}.bj.bj.bj{padding:6px 0;}.bo{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bp,button.bp{width:100%;}.bo{display:block;}.bo{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bj a.bo{color:#4e5665;}.b .bj a.bo:hover,.b .bj a.bo:focus{background:#f2f2f2;color:#4e5665;}.bj:hover,.bj:focus,.bj:hover .bo,.bj:focus .bo{background:#f2f2f2;}.bo{padding:0 4px;}.bj .bo .bq{display:block;margin:0 auto;}.bj .bm.bo .bq{margin:0 auto 1px;}.bj .bt{pointer-events:auto;}.br,.img.br{display:inline-block;pointer-events:none;vertical-align:middle;}.bt{pointer-events:none;}.bw{background:#eceff5;font-size:small;padding:8px;}.bw a{font-weight:bold;}.b .bu{padding:4px;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.img.cf{margin-right:3px;vertical-align:baseline;}.ce{white-space:nowrap;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_0"><div><div><div class="n o"><a class="p" href="/edits/?cid=1706361589585267&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">View Edit History</a></div><h3 class="q r"><strong><a href="/locreado.junior?fref=nf&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012&amp;__tn__=C">Locreado Pro Comp</a></strong> with <a href="/georgia.ebert.94?fref=nf&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012&amp;__tn__=C">Georgia Ebert</a> and <a href="/browse/users/?ids=100001786587965%2C100009453182196%2C100009201839648%2C100003670753742%2C100009589213525%2C100001402837775%2C794676037%2C100005763072783%2C1384762386%2C100009560418853%2C100010777660971%2C100006466874879%2C646417425%2C100010689701254%2C100001591862189%2C100000012437761%2C573953564%2C1458382169%2C100009686139380%2C100000568425105%2C100005440178484%2C644725949%2C100009582258187%2C100001281010451%2C100000165610673%2C100004087151439%2C100000333477659%2C100008321231997%2C100000588976109%2C100000199295063%2C100007653978823%2C100005447468258%2C100004029616955%2C100006356850211%2C100004257855259%2C100010363818732%2C100002312605467%2C100011066768688&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012&amp;__tn__=C">38 others</a>.</h3></div><div class="s"><p>Check out our Perth Program in Workshops with the Amazing <a href="/hannah.odonovan1?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012&amp;__tn__=%2As">Hannah O&#039;Donovan</a> and <a href="/StevenEatsGreenwood?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012&amp;__tn__=%2As">Steven Greenwood</a> the focus of the workshop was to allow the dancers to experience and different style and focus the attention on their feet, and FUN of Course. Enjoy <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></p></div><div class="t"><div class="u"><div class="v"><a class="w" href="/video_redirect/?src=https%3A%2F%2Fvideo.fper1-1.fna.fbcdn.net%2Fhvideo-xpa1%2Fv%2Ft42.1790-2%2F12607501_481863565325904_1531213834_n.mp4%3Fefg%3DeyJ2ZW5jb2RlX3RhZyI6InN2ZV9zZCJ9%26oh%3D61af741773461c9e2f4714b1c6fed4c0%26oe%3D569CCAFB&amp;source=misc&amp;id=1706361589585267&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012&amp;__tn__=F" target="_blank"><img src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQBAM9fcTtgrY5l4&amp;w=311&amp;h=175&amp;url=https%3A%2F%2Fscontent.fper1-1.fna.fbcdn.net%2Fhvthumb-xta1%2Fv%2Ft15.0-10%2Fcp0%2Fe15%2Fq65%2Fs320x320%2F12514360_176690359356716_432626908_n.jpg%3Fefg%3DeyJpIjoiYiJ9%26oh%3D276920e33742bb9c36920fb9a2546e89%26oe%3D57388FE8" width="311" height="175" class="img" /><div class="x"><span style="display:block;height:0;overflow:hidden;position:absolute;width:0;padding:0">Play Video</span></div></a></div></div></div></div><div class="y"><div class="n o"><abbr>11 hrs</abbr><span aria-hidden="true"> · </span><span class="z"><span><span class="n">Public</span></span></span></div><div class="n o"><span aria-hidden="true"> · </span><a class="p" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQ3MDM2MzS1sDS1MDUyM69zzSsJy0xJzXcuSk0syczPCy7JL6qsqzM0AAIzYxNjIzMDSwujujqDOgA%22%2C%22story_permalink_token%22%3A%22S%3A_I100006343260982%3A1706361589585267%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">More</a></div></div></div></div><div class="e ba" id="ufi_1706361589585267"><div class="bb bc"><div class="bd be bf"><table class="bg bh"><tbody><tr><td class="bi bj bk bl"><a class="bm bn bo bp" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=1706361589585267&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bq br bs img" /><span class="bt">Share</span></a></td></tr></tbody></table></div><div class="bu bv bw bx"><a href="/jacky.shue.9?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Jacky Shue</a> and <a href="/1706361589585267/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">117 others</a> like this.</div><div class="bb"><div class="bu" id="1706373979584028"><h3><a class="by" href="/kelly.hanson.3990?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Kelly Hanson</a></h3><div>Love this!!!! Amazing <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yj/r/mQaZAEsqD6w.png" width="16" height="16" class="m_fbEmoji_icon m_fbEmoji_size_16 img" /><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y3/r/EglQXjMgfoH.png" width="16" height="16" class="m_fbEmoji_icon m_fbEmoji_size_16 img" />!! And those legs Tamika <a href="/anita.farrugia?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Anita Farrugia</a> <img src="https://static.xx.fbcdn.net/rsrc.php/v2/ys/r/LCzu9hoerjG.png" width="16" height="16" class="m_fbEmoji_icon m_fbEmoji_size_16 img" /><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yj/r/mQaZAEsqD6w.png" width="16" height="16" class="m_fbEmoji_icon m_fbEmoji_size_16 img" /><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yj/r/mQaZAEsqD6w.png" width="16" height="16" class="m_fbEmoji_icon m_fbEmoji_size_16 img" />😀</div><div class="bz ca r"><a href="/comment/history/?ctoken=1706361589585267_1706373979584028&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Edited</a><span aria-hidden="true"> · </span><span class="cb"><span class="cc o"><a class="cd ce" aria-label="Like" href="/1706373979584028/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="cf img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDYzNzM5Nzk1ODQwMjg%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>9 hours ago</abbr></div></div><div class="bu" id="1706374726250620"><h3><a class="by" href="/elizabeth.hirschmann.5?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Elizabeth Hirschmann</a></h3><div>Fabulous !</div><div class="bz ca r"><span class="cb"><span class="cc o"><a class="cd ce" aria-label="Like" href="/1706374726250620/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="cf img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDYzNzQ3MjYyNTA2MjA%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>10 hours ago</abbr></div></div><div class="bu" id="1706377982916961"><h3><a class="by" href="/donna.hardie.5?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Donna Hardie</a></h3><div>Brandan loved this. Thank you for all the amazing things your doing for these kids. I hope you come back to Perth and do this again</div><div class="bz ca r"><a href="/comment/history/?ctoken=1706361589585267_1706377982916961&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Edited</a><span aria-hidden="true"> · </span><span class="cb"><span class="cc o"><a class="cd ce" aria-label="Likes" href="/1706377982916961/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="cf img" />4</a></span></span><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDYzNzc5ODI5MTY5NjE%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>9 hours ago</abbr></div></div><div class="bu" id="1706385072916252"><h3><a class="by" href="/joan.kemsley1?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Joan Kemsley</a></h3><div>Wow, what a workout.</div><div class="bz ca r"><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDYzODUwNzI5MTYyNTI%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>8 hours ago</abbr></div></div><div class="bu" id="1706393759582050"><h3><a class="by" href="/darol.garchev?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Darol Garchev</a></h3><div>Nice work! <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yi/r/Akq5NzBQWUE.png" width="16" height="16" class="img" alt="like emoticon" /></div><div class="bz ca r"><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDYzOTM3NTk1ODIwNTA%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>7 hours ago</abbr></div></div><div class="bu" id="1706397659581660"><h3><a class="by" href="/kasey.martyn?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Kasey Martyn</a></h3><div>Looks amazing Steven and Hannah xx</div><div class="bz ca r"><span class="cb"><span class="cc o"><a class="cd ce" aria-label="Like" href="/1706397659581660/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="cf img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDYzOTc2NTk1ODE2NjA%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>7 hours ago</abbr></div></div><div class="bu" id="1706400186248074"><h3><a class="by" href="/susan.rolton.5?refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Susan Rolton</a></h3><div>Looks like a wonderful workshop <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yH/r/SOe5wIZyutW.png" width="16" height="16" class="img" alt="grin emoticon" /></div><div class="bz ca r"><span class="cb"><span class="cc o"><a class="cd ce" aria-label="Like" href="/1706400186248074/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="cf img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxNzA2MzYxNTg5NTg1MjY3XzE3MDY0MDAxODYyNDgwNzQ%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012">Report</a><span aria-hidden="true"> · </span><abbr>7 hours ago</abbr></div></div></div><div class="bb cg" id="u_0_1"></div></div></div></div></div></div></div></div></body></html>'
			let expectedPost = {
				message: "Check out our Perth Program in Workshops with the Amazing Hannah O\'Donovan and Steven Greenwood the focus of the workshop was to allow the dancers to experience and different style and focus the attention on their feet, and FUN of Course. Enjoy",
				likeStatus: Post.LikeStatusNone,
				rawTimestamp: '11 hrs',
				type: 'video',
				actions: [
					new Action({ type: 'Share', target: '/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=1706361589585267&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706361589585267%26id%3D100006343260982%26bacr%3D1453102270%253A1453102270%253A117%253A-9205924718501405568%253A1453045560%253A0%253A0%253A1320%26refid%3D28%26_ft_%3Dqid.6241040412146880273%253Amf_story_key.2746687894282874012&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6241040412146880273%3Amf_story_key.2746687894282874012' })
				]
			}
			doTest(done, html, expectedPost)
	    });

	    it('liked post', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="default" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .l{background:#f6f7f8;border:0;font-size:small;margin:0;}.l .bf{font-size:x-small;}.l .bd{font-size:x-small;}.bl .cc a{font-weight:bold;}.bk>div{border-top:1px solid rgba(0, 0, 0, .101);}.bk>.bk>div:first-child{border-top:none;}.bj,.bj .ce{background-color:#f6f7f8;color:#141823;}.cg{border-bottom:1px solid #ddd;}.b .cg{padding-bottom:8px;}.m{margin:0 6px 6px;padding:6px;}.b .m .m{border-color:#e9eaed;margin:6px 0 0;}.bh{display:inline-block;}.be{margin-top:5px;}.q,.r{margin:5px 0;}.m a,.m a:visited{color:#2b55ad;}.m a:hover,.m a:focus{background:#2b55ad;color:#fff;}.l .m{font-size:small;padding:4px;}.l .be{margin-top:6px;}.l .q,.l .r{margin:6px 0;}.b .n{background:white;margin:0;}.e{background:#f6f7f8;}.b .bo{border-color:#ddd;border-width:1px 0 0;}.b .bo .bq{background-color:#f6f7f8;}.b .bo .bq:hover,.b .bo .bq:hover .bv{background-color:#e9eaed;}.b .bo .bv{background-color:inherit;}.b .bo .br .ca{color:#5890ff;}.cz{color:#9197a3;}.o{color:#4e5665;}.bb{font-size:12px;line-height:16px;}.cy{font-size:14px;line-height:20px;}.da{font-weight:normal;}.p{font-weight:bold;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .bi,.b .bi:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .bi:focus,.b .bi:hover{background-color:#3b5998;color:#fff;}.cf{padding:8px 8px 0;}.ch{color:#141823;display:block;font-size:small;}.b .cf .cj table{border:none;}.b .cf .cp{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cr{padding-left:4px;}.cv{margin-top:4px;}form{margin:0;border:0;}.b .w{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .w tbody,.b .x>tr>td,.b .x>tbody>tr>td,.b .w td.x{vertical-align:top;}.b .bp>tr>td,.b .bp>tbody>tr>td,.b .w td.bp{vertical-align:middle;}.b .w td{padding:0;}.b .w td.co{padding:2px;}.b .w td.u{padding:4px;}.b .ba{width:100%;}.cl{background:#fff;}.ci .cq{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .ci .ck{border:1px solid #9197a3;}.cn{border:0;display:block;margin:0;padding:0;}.b .co{padding:2px;}.b .u{padding:4px;}.cs{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cs{border-radius:2px;}.cs[disabled] .by{opacity:.3;}.cu,a.cu,html .b a.cu{color:#fff;}.b .cu{background-color:#4e69a2;border:1px solid #385490;}.b a.cu:hover,.b .cu:hover{background-color:#465e91;}.cu[disabled]{color:#899bc1;}.b .cu[disabled]:hover{background-color:#4e69a2;}.cs .ca{display:inline-block;}.b .cs .ca{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cs::after,.b .cs.bt::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cs .by{vertical-align:top;}.cs .ca{line-height:20px;margin-top:4px;}.cs .by.bz{margin-top:6px;}.cs.bt{padding-left:8px;}.cs.bt .by{margin-right:6px;}.b .cs{padding:0 8px;}.b a.cs{height:26px;line-height:26px;}.b a.cs .by.bz{margin-top:5px;}.b .cs.bt{padding-left:7px;}.by,.k.by{display:inline-block;pointer-events:none;vertical-align:middle;}.ca{pointer-events:none;}.bg{color:gray;}.bf{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.bn{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.bm .bv,.bm .bq{background-color:#fff;}.bq{background-color:#fff;position:relative;}.bq.bq.bq{padding:6px 0;}.bv{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bw,button.bw{width:100%;}.bv{display:block;}.bv{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bq a.bv{color:#4e5665;}.b .bq a.bv:hover,.b .bq a.bv:focus{background:#f2f2f2;color:#4e5665;}.bq:hover,.bq:focus,.bq:hover .bv,.bq:focus .bv{background:#f2f2f2;}.bv{padding:0 4px;}.bq .bv .bx{display:block;margin:0 auto;}.bq .bt.bv .bx{margin:0 auto 1px;}.bq .ca{pointer-events:auto;}.k{border:0;display:inline-block;vertical-align:top;}i.k u{position:absolute;width:0;height:0;overflow:hidden;}.cd{background:#eceff5;font-size:small;padding:8px;}.cd a{font-weight:bold;}.v{border:1px solid #ccc;margin:5px 0;word-wrap:break-word;}.b .v .z{padding-right:4px;}.s{display:block;}.b .s,.b .s:visited{color:#3e4350;}.b .s:focus,.b .s:hover,.b .s:focus .v,.b .s:hover .v{background:#3b5998;color:#fff;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;-webkit-transform:translateY(0%);}to{opacity:0;-webkit-transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;-webkit-transform:translateY(10%);}to{opacity:1;-webkit-transform:translateY(0%);}}@media only screen and (orientation: landscape){}.cx{margin:6px 0;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.k.df{margin-right:3px;vertical-align:baseline;}.de{white-space:nowrap;}.word_break{display:inline-block;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j k" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_0"><div><div><h3 class="o p"><a href="/MissNovember2011/?refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281&amp;__tn__=C">Ciara Price</a></h3></div><div class="q"><p>What you didn&#039;t know about Noah.</p></div><div class="r"><a class="s t" href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fwww.whosay.com%2Farticles%2F13748-the-notebook-nicholas-sparks%3Futm_source%3Dfacebook%26utm_medium%3Dpagefeed%26utm_content%3Dciaraprice%26utm_campaign%3Dfbpagedrivers&amp;h=FAQGmkbtd&amp;enc=AZPt6ISzMH8XzxvByD3FndJV8QCNzdrZ1UvKGY1qjBc5eEaZgFJ3XHqf70DxuJJ2_XWBX0z1DUruwaomC4mZJl9TeeWPITmDxZGQQH1aKjAABo2meC-eqzQpseAANvzqRqIDThImKU9VZ6IY1jSg-xSS&amp;s=1" id="u_0_2" target="_blank"><div class="e u v"><table class="w x"><tbody><tr><td class="y z"><img src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQBFiBRTyXD2daHN&amp;w=112&amp;h=112&amp;url=http%3A%2F%2Fmedia2.whosaystatic.com%2F883874%2F883874_654x440.jpg&amp;cfs=1&amp;jq=75&amp;sx=151&amp;sy=0&amp;sw=440&amp;sh=440&amp;ext=jpg" width="112" height="112" class="k" /></td><td class="ba"><h3 class="bb p bc">The One Fact About &#039;The Notebook&#039; Not Even Hardcore Fans Know</h3><div class="bb bd">whosay.com<div class="bb"></div></div></td></tr></tbody></table></div></a></div></div><div class="be"><div class="bf bg"><abbr>6 February at 06:15</abbr><span aria-hidden="true"> · </span><span class="bh"><span><span class="bf">Public</span></span></span></div><div class="bf bg"><span aria-hidden="true"> · </span><a class="bi" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDIxtDQzNTU1NLMwMatzzSsJzkgsSnUuSk0syczPCy7JL6qsqzM0sTQ2B6oztDAyNDMyqaszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I149371961821624%3A1012419655516846%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">More</a></div></div></div></div><div class="e bj" id="ufi_1012419655516846"><div class="bk bl"><div class="bm bn bo"><table class="w bp"><tbody><tr><td class="ba bq br bs" style="width:33%"><a class="bt bu bv bw" href="/a/like.php?ul=1&amp;perm&amp;ifab&amp;ft_ent_identifier=1012419655516846&amp;av=100009543463363&amp;gfid=AQAyBQHZAFvW_unN&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yu/r/VYNYSvu5NAQ.png" width="16" height="16" class="bx by bz k" /><span class="ca">Like</span></a></td><td class="ba bq bs" style="width:33%"><a class="bt bu bv bw" href="#composer-1012419655516846"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bx by bz k" /><span class="ca">Comment</span></a></td><td class="ba bq cb bs" style="width:33%"><a class="bt bu bv bw" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1012419655516846&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bx by bz k" /><span class="ca">Share</span></a></td></tr></tbody></table></div><div class="u cc cd ce">You and <a href="/1012419655516846/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">542 others</a> like this.</div><div class="cf cg" id="composer-1012419655516846"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQBIKmzi6gU13-Bw&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281&amp;av=100009543463363&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQHV74twN8Er:AQFG2LPnfzIL" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ch" for="u_0_1">Write a comment...</label><table class="w x" id="u_0_1"><tbody><tr><td class="ba"><div class="ci cj"><table class="w ck cl"><tbody><tr><td class="ba cm bp"><input class="cn co cp cq" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="y"><div class="cr"><input value="Comment" type="submit" class="bu cs ct cu" /></div></td></tr></tbody></table><span class="cv bf bg"><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1012419655516846%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1012419655516846%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Mention Friends</a></span></form></div><div class="bk"><div class="u" id="u_0_5"><h3><a class="cw" href="/bre.budianto?rc=p&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Bre Agus Budianto</a></h3><div>Hi Good Poeple, The Most Favorite Movies this year. Click!<br /> <br /> Watch &quot;Ride Along 2&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnridealongtwomovie.blogspot.co.id%2F2016%2F01%2Fride-along-2.html&amp;h=ZAQGh2swL&amp;enc=AZNS_tTzZT43dOuMPIZegfnMza341Fv4UKObeN8XiNk-7T1aQBwDJcMg0nRpWjprRhM-EEBBY_0kwuSi32VtMz1z6ySdTXPsFPIXVY2QsH0zNa3jtAXm1n6LS0gzvJNQ_imMGriWWLsq7Xo4u5EatHFE&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innridealongtwom</span><wbr /><span class="word_break"></span><span>ovie.blogspot.c</span><wbr /><span class="word_break"></span><span>o.id/2016/01/</span><wbr /><span class="word_break"></span><span>ride-along-2.htm</span><wbr /><span class="word_break"></span>l</a><br /> <br /> Watch &quot;Fifty Shades of Black&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnfiftyshadesofblack.blogspot.co.id%2F2016%2F01%2Ffifty-shades-of-black.html&amp;h=FAQGmkbtd&amp;enc=AZMUh7xFP9JUP15NX2iAl6KquDm3Q4FVm1O39hZcdVY99iCpBHwi_kcM2PunejsdKT70qionTh4kjY5oWKxIBDse_pwAv8Jk_o4Gs4OTb31DNiMPx0wBJyviT8O4zoCxmzHKihjDmjNc97DhHheb5T9T&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innfiftyshadesof</span><wbr /><span class="word_break"></span><span>black.blogspot.</span><wbr /><span class="word_break"></span><span>co.id/2016/01/</span><wbr /><span class="word_break"></span><span>fifty-shades-of-</span><wbr /><span class="word_break"></span>black.html</a><br /> <br /> Watch &quot;X-Man: Apocalysme&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnxmanapocalismemovie.blogspot.co.id%2F2016%2F01%2Fapocalypse.html&amp;h=TAQEG3PW4&amp;enc=AZOyc_r4tpOQI7_UQ9Om-RssHjTb3zjHS3JGzKzjluafPt84ekogO99PEYFO_UclnJIM7TLzynOUbHYjdTFcHCl0vH7fSiNSgiy32LFpB3dzBIi4XA5ku26SlUs3AffJ0PREeQDLnzP_PJTsdtIwhNil&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innxmanapocalism</span><wbr /><span class="word_break"></span><span>emovie.blogspot</span><wbr /><span class="word_break"></span><span>.co.id/2016/01/</span><wbr /><span class="word_break"></span>apocalypse.html</a><br /> <br /> Watch &quot;Hail, Caesar!&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnhailcaesarmovie.blogspot.co.id%2F2016%2F02%2Fhail-caesar.html&amp;h=KAQGBeG-8&amp;enc=AZOt_BR33jPofLftuII457_chL6xZLDnKQyEjCakze4RzhOtYx4OBJnxMMwp2IGRquAO5eMmbNIQvv2EA5zlFf6TkABH0ZEb-lT3BV5lLarSiih1jqMNQGe0JxGmPNUP3Qc_Rnt0kIT7FFYi2-U9oETD&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innhailcaesarmov</span><wbr /><span class="word_break"></span><span>ie.blogspot.co.</span><wbr /><span class="word_break"></span><span>id/2016/02/</span><wbr /><span class="word_break"></span>hail-caesar.html</a><br /> <br /> Watch &quot;Captain America: Civil War&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finncaptainamerikamovie.blogspot.co.id%2F2016%2F02%2Fcivil-war.html&amp;h=1AQFxtSWb&amp;enc=AZM47LSj5E8zbuu0ywv7gUIXDbXsBJfs6kM7N3NguG8FHWHHkMrkZHnMvVhu7EmDSdmKBAOdSTvyV1VVD7SlA81xVVC-nN3Q3L2kShrmUwgmxXyz3En8NK4mgH5OLZy_Ro1ZJJMZQlNpPiD9viavrASZ" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>inncaptainamerik</span><wbr /><span class="word_break"></span><span>amovie.blogspot</span><wbr /><span class="word_break"></span><span>.co.id/2016/02/</span><wbr /><span class="word_break"></span>civil-war.html</a><br /> <br /> Watch &quot;The Forest&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finntheforestmovie.blogspot.co.id%2F2016%2F01%2Fthe-forest.html&amp;h=rAQHZ7hou&amp;enc=AZOMRuhKMI1MdDSabzON3JQzzBh5M-cEQGOYR95IaeKoqBPZDZKzxwMawDp63kmcdTRbovSa3F2B0wR57vnueTTVZKoFic5tlNHmi65ZnhZo2f9IH3Rr3Rfp1hLpEYzzk8Ej0BB7mNh1t6A01kAzYGlc&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>inntheforestmovi</span><wbr /><span class="word_break"></span><span>e.blogspot.co.i</span><wbr /><span class="word_break"></span><span>d/2016/01/</span><wbr /><span class="word_break"></span>the-forest.html</a><br /> <br /> Watch &quot;The Finest Hours&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnthefineshoursmovie.blogspot.co.id%2F2016%2F02%2Fthe-finest-hours.html&amp;h=fAQGMKvZ5&amp;enc=AZPxASpz3BBNbTtKEu1xwn54cdvEF_-1DHgqoRrAp_xpPNn7hpstc0ECUT-9D7KvlKk02KhvET3FcKLYY79VaLocO7mksJqgpkM6GySiaiMemIfF66ij6932-iE1r3Oo-t4DWRPmVzn4uHP2-kbm3npD&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innthefineshours</span><wbr /><span class="word_break"></span><span>movie.blogspot.</span><wbr /><span class="word_break"></span><span>co.id/2016/02/</span><wbr /><span class="word_break"></span><span>the-finest-hours</span><wbr /><span class="word_break"></span>.html</a><br /> <br /> watch &quot;Daddy&#039;s Home&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finndaddyshomemovie.blogspot.co.id%2F2016%2F01%2Fdaddys-home.html&amp;h=lAQFmLzi3&amp;enc=AZMMj5XbGUDPLNx0pqWPoXUQedWKNQdMuJ8LHVIeCd6_hfUGi4kU_rq5v4LhMXlvhaNmZkeY6FMoYOjOljANvvXSTPh_1Qj8EzIcs-bjeRUT6GR4F2WfMytfZpUuNT-39AByGlTKMTqUELcu62kcXGU4&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>inndaddyshomemov</span><wbr /><span class="word_break"></span><span>ie.blogspot.co.</span><wbr /><span class="word_break"></span><span>id/2016/01/</span><wbr /><span class="word_break"></span>daddys-home.html</a><br /> <br /> Watch &quot;Deadpool&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finndeadpoolmovie.blogspot.co.id%2F2016%2F01%2Fdeadpool.html&amp;h=gAQE8J9Qv&amp;enc=AZPNW-Xg3i_p6WXWM3ORbkqWWpzl_EmxgZEUXxq5Xfv3ESf-CpBg-ngWHGhjnLGqBaFa1AUtEBZYVHIzLTgPzwBe8Pxk5VgHrxY5paIAZVVUwbbZC3E5_oxNCiHg4s33SDNIzeP7v-eM2GouujPHZTOj&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>inndeadpoolmovie</span><wbr /><span class="word_break"></span><span>.blogspot.co.id</span><wbr /><span class="word_break"></span><span>/2016/01/</span><wbr /><span class="word_break"></span>deadpool.html</a><br /> <br /> Watch &quot;Kung Fu Panda 3&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnkungfupandathreemovie.blogspot.co.id%2F2016%2F01%2Fkung-fu-panda-3.html&amp;h=rAQHZ7hou&amp;enc=AZNDCD3W0b2zTClz_6kPwdFeo34zZDQm-4nvCEHcIiC6K46HV-K62SwKjICx0aHBnuDpiMz-a4azJiFutXuqlA3LQLwvr1it3OMpmxnXXlYzzgDVK2l19vIUjEE_dU3zYg5mcjfooWvbmHfbiUrZlFS3&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innkungfupandath</span><wbr /><span class="word_break"></span><span>reemovie.blogsp</span><wbr /><span class="word_break"></span><span>ot.co.id/2016/</span><wbr /><span class="word_break"></span><span>01/</span><wbr /><span class="word_break"></span><span>kung-fu-panda-3.</span><wbr /><span class="word_break"></span>html</a><br /> <br /> Watch &quot;Batman v Superman: Dawn of Justice&quot; Full Movie<br /> <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnbatmanvsupermanjusticedownmovie.blogspot.co.id%2F2016%2F01%2Fbatman-v-superman-dawn-of-justice-play.html&amp;h=_AQFPWoA3&amp;enc=AZMEkCnlOlORfPOCMo0aFlDVW7t-Us_cIiGN1Imvkm6dAbsHwgxTqFmcqtwqxbAd2eLIh6DfBikAhECqa11QHlHWkW4S-c9pAOfStxT_aF2h_6ZTEQsR4hdFSy_Uscj5kP-fB0XXM84klTolldussCPW&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innbatmanvsuperm</span><wbr /><span class="word_break"></span><span>anjusticedownmo</span><wbr /><span class="word_break"></span><span>vie.blogspot.co</span><wbr /><span class="word_break"></span><span>.id/2016/01/</span><wbr /><span class="word_break"></span><span>batman-v-superma</span><wbr /><span class="word_break"></span><span>n-dawn-of-justi</span><wbr /><span class="word_break"></span>ce-play.html</a><br /> <br /> Watch &quot;Star Wars: Episode VII-The Force Awaken&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnstarwarstheforceawakenmovie.blogspot.co.id%2F2016%2F01%2Fstar-wars-episode-vii.html&amp;h=gAQE8J9Qv&amp;enc=AZOICzsLRHDIorCxMJCPDv-UcfygQ3A44lbnMC09bYksYYtuQMGBdoseoe9BhmkCULP_elqY1Y4cMixehhX4L9hYYbo1SvbK9Yeq_kyNnmp0cue0Soc610Bs70uXGLmupGyA1buzAwbh-wHg0iBcmq3j&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innstarwarsthefo</span><wbr /><span class="word_break"></span><span>rceawakenmovie.</span><wbr /><span class="word_break"></span><span>blogspot.co.id/</span><wbr /><span class="word_break"></span><span>2016/01/</span><wbr /><span class="word_break"></span><span>star-wars-episod</span><wbr /><span class="word_break"></span>e-vii.html</a><br /> <br /> Watch Pride Prejudice and Zombies&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnprideprejudiceandzombiemovie.blogspot.co.id%2F2016%2F02%2Fpride-and-prejudice-and-zombies-play.html&amp;h=BAQEZjQrf&amp;enc=AZN3SnjezRzOwnqpdM4_xC41GIeS8rwoct5ja66fkxRRGzk1yXuAyNTtDiyTlz6IWoKXW7GcT2XTb4ORposeE45b3r5y8GhhvduBwmPgv8m1ACanSSdhhvlkHoPizI8iL1uEb51l05wHp_K3l5D1bWMc&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innprideprejudic</span><wbr /><span class="word_break"></span><span>eandzombiemovie</span><wbr /><span class="word_break"></span><span>.blogspot.co.id</span><wbr /><span class="word_break"></span><span>/2016/02/</span><wbr /><span class="word_break"></span><span>pride-and-prejud</span><wbr /><span class="word_break"></span><span>ice-and-zombies</span><wbr /><span class="word_break"></span>-play.html</a><br /> <br /> Watch &quot;The Hatefull Eight&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnthehatefuleightmovie.blogspot.co.id%2F2016%2F01%2Fhateful-eight.html&amp;h=2AQFFBEaV&amp;enc=AZNyON0fDbUYkpnQyansgalpNy7xszLT2K9AD6Q2IYIO1kf3ajvfUqdRd83EzCurKlb6VtbrMxkfN056dBSUexViPsO8ZQu08X7kexXbSYViFnUmupf6crolK-KpXWsl4MxmwRLrP_hDk_za_gRdIQ7_&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innthehatefuleig</span><wbr /><span class="word_break"></span><span>htmovie.blogspo</span><wbr /><span class="word_break"></span><span>t.co.id/2016/</span><wbr /><span class="word_break"></span><span>01/</span><wbr /><span class="word_break"></span><span>hateful-eight.ht</span><wbr /><span class="word_break"></span>ml</a><br /> <br /> Watch &quot;The 5th Wave&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnthe5wavemovie.blogspot.co.id%2F2016%2F01%2Fthe-5th.html&amp;h=HAQFpPHxS&amp;enc=AZP-FEYOLryKOzYvZBnZN2qOs5TxUdUgzwHyCetPqxTvMC46xHE5imAi1yVq6mcNQZNZ5ofwlBL7P6XE8j1JwfIeB5PSPXn41BKy__7p4U8IMh-3b7uzunmbes04Yoj-OPyHFACzI6kT9FBle9mGKxYy&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innthe5wavemovie</span><wbr /><span class="word_break"></span><span>.blogspot.co.id</span><wbr /><span class="word_break"></span><span>/2016/01/</span><wbr /><span class="word_break"></span>the-5th.html</a><br /> <br /> Watch &quot;The Legend of Tarzan&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnlegendoftarzanmovie.blogspot.co.id%2F2016%2F01%2Ftarzan.html&amp;h=dAQGPuE11&amp;enc=AZPwJ1IMmRpllA0FmWYDYDLdHLR5vyfR3bIqRVPJQ5CNzBuu_32T6Zxy-ZaZN_DUOmaEg22d9-v85qTilVqH0GaB1lAYtB6GN81u0MDF3fjX7VcYFdZwR-H00HtAjb_UVHV4GSdtmAxvr2rS1Ur-oCxG&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innlegendoftarza</span><wbr /><span class="word_break"></span><span>nmovie.blogspot</span><wbr /><span class="word_break"></span><span>.co.id/2016/01/</span><wbr /><span class="word_break"></span>tarzan.html</a><br /> <br /> Watch &quot;Perfect Guy&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnperfectguymovie.blogspot.co.id%2F2016%2F01%2Fthe-perfect-guy-play-movie-perfect-guy.html&amp;h=fAQGMKvZ5&amp;enc=AZPFJxR1vpMiSsHvRBBSzN1zm9kHtJRgjuP3LkvXwc1FO93-ROCxzT2KD7mqWyiDWpi8YfW0JcDJ_rxZ1QSAvbmlg8Tpjba7x-LYQ6JeeO6pkkhVkMXpT29rtojO_XA_XFoXEQd5VsdcfE1JnIYwFWuO&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innperfectguymov</span><wbr /><span class="word_break"></span><span>ie.blogspot.co.</span><wbr /><span class="word_break"></span><span>id/2016/01/</span><wbr /><span class="word_break"></span><span>the-perfect-guy-</span><wbr /><span class="word_break"></span><span>play-movie-perf</span><wbr /><span class="word_break"></span>ect-guy.html</a><br /> <br /> Watch &quot;Creed&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finncreedmovie.blogspot.co.id%2F2016%2F01%2Fcreed.html&amp;h=KAQGBeG-8&amp;enc=AZMmRUf74jzoPT66fzWL0fjA5BpNNNR9G15EQQm9jgvuYjL_kXYTUhp_mDaElw_y_Fo58hyzgejYraZv-XzGLNWW7BvgeBfqMNzn5QWKJlShQrnpwaLdn1F7slWj0pY6xJvefFJgj1yIjG8rTi_Sv4Fi&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>inncreedmovie.bl</span><wbr /><span class="word_break"></span><span>ogspot.co.id/</span><wbr /><span class="word_break"></span><span>2016/01/</span><wbr /><span class="word_break"></span>creed.html</a><br /> <br /> Watch &quot;Straight Outta Compton&quot; Full Movie<br /> ==&gt; <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnstaraightouttacomptonmovie.blogspot.co.id%2F2016%2F02%2Foutta.html&amp;h=cAQH9LO7T&amp;enc=AZNSmlShWNwzXMluv2xCZAR44VCHs54FMsvLlEUNqODnxAumkhITJ4Umtk34GudhBUOVK3xfHkupWr5nGhH__4BsNOh1ehZcdsqwICKAr0VltrXSGxWCluSuQNOEnmix_kKPV0U7z6_6Da_0lnc0aSqY" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>innstaraightoutt</span><wbr /><span class="word_break"></span><span>acomptonmovie.b</span><wbr /><span class="word_break"></span><span>logspot.co.id/</span><wbr /><span class="word_break"></span><span>2016/02/</span><wbr /><span class="word_break"></span>outta.html</a><br /> <br /> Have nice Watch.</div><a class="s cx" href="http://lm.facebook.com/l.php?u=http%3A%2F%2Finnridealongtwomovie.blogspot.co.id%2F2016%2F01%2Fride-along-2.html&amp;h=xAQFSDehm&amp;enc=AZM4yfcBgYorFrY8SvZ_24upxl61zTUVsJLoK2ZlLYZEy7_rNnamd_lf_RBqMi12PBpBwltwYSa2Wc7C6_ot8gK8fGJ8MKT9dQSKQc9ewFhOeTF17AexceuaIhOHabpbjjl83QC2Rhh3bgfDRaohzjWa&amp;s=1" id="u_0_8" target="_blank"><div class="e u v"><table class="w x"><tbody><tr><td class="y z"><img src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQDh0ciZ5NMAmK6i&amp;w=52&amp;h=52&amp;url=https%3A%2F%2F3.bp.blogspot.com%2F-PnS9T7Bwa6c%2FVqqj4dFJI9I%2FAAAAAAAAABM%2Ffa0mxUZ6J2Q%2Fs640%2FRide_Along_2_poster.jpg&amp;cfs=1&amp;jq=75&amp;sx=0&amp;sy=0&amp;sw=350&amp;sh=350&amp;ext=jpg" width="52" height="52" class="k" /></td><td class="ba"><h3 class="cy p bc">ride along 2 | RIDE</h3><div class="bb bd">innridealongtwomovie.blogspot.co.id · <div class="bb"></div></div></td></tr></tbody></table></div></a><div class="bb cz da"><span class="db"><span class="dc bg"><a class="bi" href="/a/comment.php?like_comment_id=1012444675514344&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQAjPOS2zKGBDG2l&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=1012419655516846_1012444675514344&amp;actor_id=100009543463363&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQC85EMRfdnPO2cL&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281#comment_form_149371961821624_1012419655516846">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDEyNDE5NjU1NTE2ODQ2XzEwMTI0NDQ2NzU1MTQzNDQ%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Report</a><span aria-hidden="true"> · </span><abbr>Saturday at 06:16</abbr></div></div><div class="u" id="u_0_4"><h3><a class="cw" href="/profile.php?id=100011240952460&amp;rc=p&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Wesley Vival</a></h3><div><a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fbuda.online%2Fnow-is-your-favorite-point-of-view%2F&amp;h=GAQGic0oE&amp;enc=AZNV7WJqpq8cTta6NfOJVadz7KysVCqOLMrgFhMIs3W0ZXrffH1jy4J1aIB-UG3wnD_55gBPQbsxkdTxOv0l4COJs-gv5udpxxMTnTq0vzfIOZslA5hpGK1m1TIOAPq4cgEfZC20ir2FT1Wx2MqoLElR&amp;s=1" target="_blank"><span>http://</span><wbr /><span class="word_break"></span><span>buda.online/</span><wbr /><span class="word_break"></span><span>now-is-your-favo</span><wbr /><span class="word_break"></span><span>rite-point-of-v</span><wbr /><span class="word_break"></span>iew/</a></div><a class="s cx" href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fbuda.online%2Fnow-is-your-favorite-point-of-view%2F&amp;h=7AQGGcA-m&amp;enc=AZNSV1jTdGeZ9QXO1HsDUtHEpRdeGDLlBKa42mOT7SE7e9pUoNsv5kA4yfOk3OVWidvdO6fDQr8Jov45qj8ARLKgUzyLPNHhniCKP4SYYiGtqbK0ln1jpkAzWzypjyfmuReVhPP9XAvvnSAyjgJYkUIz&amp;s=1" id="u_0_7" target="_blank"><div class="e u v"><table class="w x"><tbody><tr><td class="y z"><img src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQBcPyBAk5OuQb9V&amp;w=52&amp;h=52&amp;url=http%3A%2F%2Fbuda.online%2Fwp-content%2Fuploads%2F2016%2F02%2F1-590x312.jpg&amp;cfs=1&amp;jq=75&amp;sx=278&amp;sy=0&amp;sw=312&amp;sh=312&amp;ext=jpg" width="52" height="52" class="k" /></td><td class="ba"><h3 class="cy p bc">Now is your favorite point of view – Life Style</h3><div class="bb bd">buda.online · <div class="bb"></div></div></td></tr></tbody></table></div></a><div class="bb cz da"><span class="db"><span class="dc bg"><a class="bi" href="/a/comment.php?like_comment_id=1012444812180997&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQCaoih1cb4x5m9J&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Like</a><span aria-hidden="true"> · </span><a class="dd de" aria-label="Likes" href="/1012444812180997/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="df k" />3</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=1012419655516846_1012444812180997&amp;actor_id=100009543463363&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQAkCNNeaW6Pp3AR&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281#comment_form_149371961821624_1012419655516846">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDEyNDE5NjU1NTE2ODQ2XzEwMTI0NDQ4MTIxODA5OTc%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Report</a><span aria-hidden="true"> · </span><abbr>Saturday at 06:16</abbr></div></div><div class="u" id="u_0_3"><h3><a class="cw" href="/mark.stuart.39?rc=p&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Mark Stuart</a></h3><div>That movie has &quot;hardcore fans&quot; ???</div><div class="bb cz da"><span class="db"><span class="dc bg"><a class="bi" href="/a/comment.php?like_comment_id=1012457355513076&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQBpAqBvZsu7S15_&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Like</a><span aria-hidden="true"> · </span><a class="dd de" aria-label="Like" href="/1012457355513076/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="df k" />1</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=1012419655516846_1012457355513076&amp;actor_id=100009543463363&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQDPipg5qQdNGa7A&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281#comment_form_149371961821624_1012419655516846">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDEyNDE5NjU1NTE2ODQ2XzEwMTI0NTczNTU1MTMwNzY%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Report</a><span aria-hidden="true"> · </span><abbr>Saturday at 06:58</abbr></div></div><div class="u" id="u_0_6"><h3><a class="cw" href="/steve.manganoo?rc=p&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Steve Manganoo</a></h3><div>tell me</div><div class="bb cz da"><span class="db"><span class="dc bg"><a class="bi" href="/a/comment.php?like_comment_id=1012444852180993&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQBT9NEiok7ddhJc&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=1012419655516846_1012444852180993&amp;actor_id=100009543463363&amp;ft_ent_identifier=1012419655516846&amp;gfid=AQCHZ9EAKkzahva8&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281#comment_form_149371961821624_1012419655516846">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDEyNDE5NjU1NTE2ODQ2XzEwMTI0NDQ4NTIxODA5OTM%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1012419655516846%26id%3D149371961821624%26bacr%3D1454892556%253A1454892556%253A7%253A4961967704820047726%253A1454777055%253A0%253A0%253A259200%26refid%3D28%26_ft_%3Dqid.6248787150133681054%253Amf_story_key.3572767757270612281%26fbt_id%3D1012419655516846%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281">Report</a><span aria-hidden="true"> · </span><abbr>Saturday at 06:16</abbr></div></div><div class="u dg" id="see_next_1012419655516846"><a href="/story.php?story_fbid=1012419655516846&amp;id=149371961821624&amp;p=10&amp;refid=52&amp;_ft_=qid.6248787150133681054%3Amf_story_key.3572767757270612281"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bz k" />&nbsp;View next comments…</a></div></div><div id="add_comment_link_placeholder"></div></div></div></div></div></div></div></div></body></html>';
			let expectedPost = {
				message: "What you didn\'t know about Noah.",
				likeStatus: Post.LikeStatusLike
			};

			doTest(done, html, expectedPost);
	    });

		it('group post', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Perth Beer Economy.</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div id="objects_container"><div class="be e" id="root" role="main"><div/><div id="m_story_permalink_view"><div class="bf"><div class="bg bh" id="u_0_1"><div><div><h3 class="bi bj"><a href="/mark.elliot.5?refid=18&amp;__tn__=C"><strong><a href="/mark.elliot.5?fref=nf&amp;refid=18&amp;__tn__=C">Mark Elliot</a></strong><span class="fcg">&gt; </span>‎<strong><a href="/groups/1667167856835981?refid=18&amp;__tn__=C">Perth Beer Economy.</a></strong></a></h3></div><div class="bk"><div class="bl bm"><div class="bn"><span class="bo">(Sold)</span><span>7 new toilet roll holders</span></div><div><span class="bp">$150</span></div><div class="bq"><span class="br">Perth, Australia</span></div><div class="bs"><p>7 toilet roll holders new in box$150 worth of grog</p></div></div></div></div><div class="bt"><div class="bu fcg"><abbr>19 mins</abbr><span aria-hidden="true">· </span><span class="bv"><span><span class="bu">Perth Beer Economy.</span></span></span></div><div class="bu fcg"><a class="bw" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22M7QwNjYwNTI2NTa1MLAwM65zzStxL8ovLfBNzMkJyC8ucS5KTSzJzM8LLskvqqyrMzQ2NzA0NjC3NKirM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I1370130790%3AVK%3A1833052353580863%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1667167856835981%3Fview%3Dpermalink%26id%3D1833052353580863%26bacr%3D1471312516%253A1471312516%253A1%253A4650269322943201881%253A1471312279%253A0%26refid%3D8%26_ft_%3Dqid.6319239838831608585%253Amf_story_key.-5969637953764279132&amp;refid=18">More</a></div></div></div></div><div class="e bx" id="ufi_1833052353580863"><div class="by bz"><div class="ca cb cc"><table class="l cd"><tbody><tr><td class="s ce cf" style="width:33%"><a class="cg x ch ci" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1833052353580863&amp;av=100009834785112&amp;gfid=AQCmArbBXZMMHkpB&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fprofile_tribe.php&amp;refid=18"><img class="cj ck cl r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16"/><span class="cm">Like</span></a></td><td class="s ce cf" style="width:33%"><a class="cg x ch ci" href="#composer-1833052353580863"><img class="cj ck cl r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16"/><span class="cm">Comment</span></a></td><td class="s ce cn cf" style="width:33%"><a class="cg x ch ci" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=1833052353580863&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1667167856835981%3Fview%3Dpermalink%26id%3D1833052353580863%26bacr%3D1471312516%253A1471312516%253A1%253A4650269322943201881%253A1471312279%253A0%26refid%3D8%26_ft_%3Dqid.6319239838831608585%253Amf_story_key.-5969637953764279132&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fprofile_tribe.php&amp;refid=18"><img class="cj ck cl r" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16"/><span class="cm">Share</span></a></td></tr></tbody></table></div><div class="by"><div class="co" id="1833052763580822"><h3><a class="cp" href="/dave.antrobus.37?refid=18">Dave Antrobus</a></h3><div>Photo?</div><div class="cq cr cs"><span class="ct"><span class="cu fcg"><a href="/a/comment.php?like_comment_id=1833052763580822&amp;snowflake&amp;ft_ent_identifier=1833052353580863&amp;gfid=AQBSLFp5t3vXuMb5&amp;refid=18">Like</a></span></span><span aria-hidden="true">· </span><a href="/comment/replies/?ctoken=1833052353580863_1833052763580822&amp;actor_id=100009834785112&amp;ft_ent_identifier=1833052353580863&amp;gfid=AQAKReUWpKmXJhOe&amp;refid=18#comment_form_1370130790_1833052353580863_reply_1833052763580822">Reply</a><span aria-hidden="true">· </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%221833052763580822%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1667167856835981%3Fview%3Dpermalink%26id%3D1833052353580863%26bacr%3D1471312516%253A1471312516%253A1%253A4650269322943201881%253A1471312279%253A0%26refid%3D8%26_ft_%3Dqid.6319239838831608585%253Amf_story_key.-5969637953764279132&amp;refid=18">Report</a><span aria-hidden="true">· </span><abbr>17 minutes ago</abbr></div></div></div><div class="by cz" id="u_0_0"/><div class="da db" id="composer-1833052353580863"><form action="/a/comment.php?fs=8&amp;fr=%2F&amp;actionsource=1&amp;comment_logging&amp;ft_ent_identifier=1833052353580863&amp;gfid=AQD0JAgwd30APbR0&amp;av=100009834785112&amp;refid=18" method="post"><input autocomplete="off" name="fb_dtsg" type="hidden" value="AQE7OvMAXxJr:AQGeNJsrZDp_"/><input name="charset_test" type="hidden" value="€,´,€,´,水,Д,Є"/><label class="dc" for="u_0_2">Write a comment...</label><table class="l cd" id="u_0_2"><tbody><tr><td class="s"><div class="dd de"><table class="l df dg"><tbody><tr><td class="s dh di"><input class="u v dj dk" id="composerInput" name="comment_text" type="text"/></td></tr></tbody></table></div></td><td class="m"><div class="dl"><input class="x y dm ba" type="submit" value="Comment"/></div></td></tr></tbody></table><span class="dn bu fcg"><a href="/mbasic/comment/advanced/?target_id=1833052353580863&amp;pap=1&amp;at=compose&amp;refid=18">Attach a Photo</a><span aria-hidden="true">· </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1833052353580863%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1833052353580863%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=18">Mention Friends</a></span></form></div></div></div></div></div></div><div class="ea"><div class="ek el"><a class="et" href="#header">Back To Top</a></div></div></div></div></body></html>';
			let expectedPost = {
				message: '(Sold) 7 new toilet roll holders\n\n$150\n\nPerth, Australia\n\n7 toilet roll holders new in box$150 worth of grog',
				type: 'status'
			};

			doTest(done, html, expectedPost);
		});

		it('scraping post created via Apollo should not have a link...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" role="banner" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y8/r/k97pj8-or6s.png" width="77" height="16" class="j k" alt="facebook" /></a></h1></div><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_2"><div><div><div class="o p"><a class="q" href="/edit/post/dialog/?cid=S%3A_I100009834785112%3A375325909471899&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D375325909471899%26id%3D100009834785112%26bacr%3D1481503010%253A1481503010%253A3%253A-7808796074867363565%253A1481383905%253A6363009210758840712%26refid%3D7%26_ft_%3Dqid.6363009210758840712%253Amf_story_key.-3273472508875796079%253Atop_level_post_id.375325909471899&amp;perm&amp;loc=permalink&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">Edit</a><span aria-hidden="true"> · </span><a class="q" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100009834785112%3A375325909471899&amp;continue=%2Fstories.php%3Faftercursorr%3D1481503010%253A1481503010%253A3%253A-7808796074867363565%253A1481383905%253A6363009210758840712%23s_428bc9424c8100f32545b7cebb85514b&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">Delete</a></div><h3 class="r s"><span><strong><a href="/profile.php?fref=nf&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899&amp;__tn__=C">Skooter Martin</a></strong></span></h3></div><div class="t" style="padding-bottom:8px;padding-top:10px"><p><div style="font-size:24px;font-weight:300;line-height:1.2;display:inline">Leg</p><p> Status updated with Social Stream<br /></div><span style="font-size:24px;font-weight:300;line-height:1.2"><a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fmysocialstream.com%2Ffind-out-more&amp;h=eAQFHnags&amp;enc=AZOC4kwCPyhy24lBhvSqi-KaZ6Kj-ILxAgR2OGYFx_-Fai8O2m0t8lesWnVDMoHCFKSw0itQT306uKJWZZ1yVC8YHImt1oXp5MO7aTHv4HqzQg5Zx38mZhFaiu2SkLiDkpViutuqSPhchna-_aZBjmtLwa1cqdsM7BSSOh-KybvCyl4jCkWXfpCuXJz5flCsU64sNziTnzAv3OxOOiDxI6q5veDUQTx0sQZ6PnfjtIB2hM82S3g56L47WHE505SPvYGxgEbn0pikYWKDkQDvosBSlTqISh_LDp6skf6G2efnoljbLxmZvQixo5NHd32rh-0&amp;s=1" target="_blank"><div style="font-size:24px;font-weight:300;line-height:1.2;display:inline"><span>http://</span><wbr /><span class="word_break"></span><span>mysocialstream.c</span><wbr /><span class="word_break"></span><span>om/</span><wbr /><span class="word_break"></span>find-out-more</div></a></span></p></div></div><div class="u"><div class="o p"><abbr>13 mins</abbr><span aria-hidden="true"> · </span><span class="v"><div><span class="o">Privacy:&nbsp;</span><span class="o"><a href="/privacyx/selector/?redir=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375325909471899%26id%3D100009834785112%26bacr%3D1481503010%253A1481503010%253A3%253A-7808796074867363565%253A1481383905%253A6363009210758840712%26refid%3D7%26_ft_%3Dqid.6363009210758840712%253Amf_story_key.-3273472508875796079%253Atop_level_post_id.375325909471899&amp;ci=375325909471899&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQAyhxKHnVrdjuxn&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">Public</a></span><input type="hidden" name="privacy[375325909471899]" value="300645083384735" /></div></span></div><div class="o p"><a class="q" href="/composer/mbasic/?c_src=feed_story&amp;referrer=feed_story&amp;target=100009834785112&amp;story_id=375325909471899&amp;ctype=inline&amp;cwevent=composer_entry&amp;av=100009834785112&amp;icv=lgc_view_photo&amp;lgc_view_photo&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">Add Photos</a><span aria-hidden="true"> · </span><a class="q" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzY3NTYytTSwNDE3tLC0rHPNKwkuSSwpLXYuSk0syczPCy7JL6qsqzM0AAJLC2MTcwtTQ0OjujqDOgA%22%2C%22story_permalink_token%22%3A%22S%3A_I100009834785112%3A375325909471899%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375325909471899%26id%3D100009834785112%26bacr%3D1481503010%253A1481503010%253A3%253A-7808796074867363565%253A1481383905%253A6363009210758840712%26refid%3D7%26_ft_%3Dqid.6363009210758840712%253Amf_story_key.-3273472508875796079%253Atop_level_post_id.375325909471899&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">More</a></div></div></div></div><div class="e w" id="ufi_375325909471899"><div class="x y"><div class="z ba bb bc"><table class="bd be" role="presentation"><tbody><tr><td class="bf bg bh" style="width:25%"><a class="bi bj bk bl" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=375325909471899&amp;av=100009834785112&amp;gfid=AQBIGLQfn9oYCuxR&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899" role="button" aria-pressed="false"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bm bn bo k" aria-hidden="true" /><span class="bp">Like</span></a></td><td class="bf bg bh" style="width:25%"><a class="bi bj bk bl" href="/reactions/picker/?ft_id=375325909471899&amp;origin_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375325909471899%26id%3D100009834785112%26bacr%3D1481503010%253A1481503010%253A3%253A-7808796074867363565%253A1481383905%253A6363009210758840712%26refid%3D7%26_ft_%3Dqid.6363009210758840712%253Amf_story_key.-3273472508875796079%253Atop_level_post_id.375325909471899&amp;av=100009834785112&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899&amp;refid=52" role="button" aria-pressed="false"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yZ/r/wCftkR_lm8T.png" width="16" height="16" class="bm bn k" aria-hidden="true" /><span class="bp">React</span></a></td><td class="bf bg bh" style="width:25%"><a class="bi bj bk bl" href="#composer-375325909471899"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bm bn bo k" aria-hidden="true" /><span class="bp">Comment</span></a></td><td class="bf bg bq bh" style="width:25%"><a class="bi bj bk bl" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=375325909471899&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375325909471899%26id%3D100009834785112%26bacr%3D1481503010%253A1481503010%253A3%253A-7808796074867363565%253A1481383905%253A6363009210758840712%26refid%3D7%26_ft_%3Dqid.6363009210758840712%253Amf_story_key.-3273472508875796079%253Atop_level_post_id.375325909471899&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bm bn bo k" aria-hidden="true" /><span class="bp">Share</span></a></td></tr></tbody></table></div><div class="br bs"><a class="bt" href="/ufi/reaction/profile/browser/?ft_ent_identifier=375325909471899&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899"><div></div></a></div><div class="x bu" id="u_0_0"></div><div class="bv bw" id="composer-375325909471899"><form method="post" action="/a/comment.php?fs=8&amp;fr=%2Fhome%2F&amp;actionsource=1&amp;comment_logging&amp;ft_ent_identifier=375325909471899&amp;gfid=AQBZRW8ah6Z6BF6H&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899&amp;av=100009834785112&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQGH-fMydt4Z:AQGbeF0u0kK3" autocomplete="off" /><label class="bx" for="u_0_1">Write a comment...</label><table class="bd be" role="presentation" id="u_0_1"><tbody><tr><td class="bf"><div class="by bz"><table class="bd ca cb" role="presentation"><tbody><tr><td class="bf cc cd"><input class="ce cf cg ch" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="ci"><div class="cj"><input value="Comment" type="submit" class="bj ck cl cm" /></div></td></tr></tbody></table><span class="cn o p"><a href="/mbasic/comment/advanced/?target_id=375325909471899&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D375325909471899%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D375325909471899%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6363009210758840712%3Amf_story_key.-3273472508875796079%3Atop_level_post_id.375325909471899">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>';
			let expectedPost = {
				type: 'status'
			};

			doTest(done, html, expectedPost);
		});

		it('should not parse fbstaging image urls...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body class="nontouch x2 _513c _59e9" tabindex="0"><div class="mfsm"><div id="viewport"><div class="_129-"><h1 class="_5xjd" id="header" role="banner"><a class="_5xje" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="_5xjg img" height="15" src="https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/5Zo8s-IGqA1.png" width="77"/></a></h1></div><div id="objects_container"><div class="_59e9" id="root" role="main"><div id="m_story_permalink_view"><div class="_5d1"><div class="_5rgl _3ziv" id="u_0_1"><div><div><h3 class="_52ja _52jh"><span><strong><a href="/perthscorchers/?refid=52&amp;_ft_=qid.6371261762674684222%3Amf_story_key.-8362052284011115996%3Atop_level_post_id.1421723674526551&amp;__tn__=C">Perth Scorchers</a></strong></span></h3></div><div class="_5rgn" style=""><p><span>C\'mon team ... let\'s make it a WBBL-BBL top-of-the-tabl</span><wbr/><span class="word_break"/>e double act!</p></div><div class="_5rgo _27x0"><a class="_5tip _5tfq" href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fwww.perthscorchers.com.au%2Fnews%2Fperth-looks-to-double-header-in-push-for-top%2F2017-01-03&amp;h=6AQGvLIWg&amp;enc=AZMhJ74UifrJ-qEj4pVMTFA3IhUtTMJu9mgXUHwKLiU3prSva7Dy2X0phmyv4Y5KRT_SSuWMAvHLkw7Dj2kYZx4cakipaUjXr_omw8BuoY2qEwcHGUHB0cJAXdNK6-Ep1-ldGO7O__SE_i4lWckwUlEniw_jPH4gTcBgBC7__FoRa_UT08V6v8QThbeHnA4uDQ_FS3sFiQnZKcevcZ8w7vBAR0xUejRG_PPyji_54z0IlVXlOCy_CR1LTLMjdw3C6MgSgLacfx2qJBvVjs14GQoXFy2HupWSstqcapKWHZWBNQ&amp;s=1" id="u_0_2" target="_blank"><div class="_59e9 _55wr _5til"><table class="_4g33 _52wc" role="presentation"><tbody><tr><td class="_5s61 _3lsd"><img class="img" height="112" role="presentation" src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQAWCDIaWpesleA1&amp;w=224&amp;h=224&amp;url=fbstaging%3A%2F%2Fgraph.facebook.com%2Fstaging_resources%2FMDExNDIxNzIzMjQ0NTI2NTk0OjExMzY3NzI0ODg%3D&amp;cfs=1&amp;jq=75&amp;sx=24&amp;sy=0&amp;sw=778&amp;sh=778&amp;ext=jpg&amp;_nc_hash=AQAj8jUr001t6Axb" width="112"/></td><td class="_4g34"><h3 class="_52jc _52jh _ing">Scorchers Look To Melbourne Double In Push For Top</h3><div class="_52jc _2b-u">perthscorchers.com.au<div class="_52jc"/></div></td></tr></tbody></table></div></a></div></div><div class="_5sq4"><div class="mfss fcg"><abbr>1 hr</abbr><span aria-hidden="true">· </span><span class="_26zb"><span><span class="mfss">Custom</span></span></span></div><div class="mfss fcg"><a class="sec" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzQxMjQ3MjYzNzE1MjM1NaxzzSsJzkgsSnUuSk0syczPCy7JL6qsqzO0NDAzMDA0NrA0NzICKqszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I190600130972251%3A1421723674526551%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1421723674526551%26id%3D190600130972251%26bacr%3D1483423929%253A1483423929%253A3%253A-1436031825477414022%253A1483423444%253A6371261762674684222%26refid%3D28%26_ft_%3Dqid.6371261762674684222%253Amf_story_key.-8362052284011115996%253Atop_level_post_id.1421723674526551&amp;refid=52&amp;_ft_=qid.6371261762674684222%3Amf_story_key.-8362052284011115996%3Atop_level_post_id.1421723674526551">More</a></div></div></div></div></div></div></div></div></div></body></html>';
			let expectedPost = {
				media: [{
					imageUrl: 'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQAWCDIaWpesleA1&w=224&h=224&url=fbstaging://graph.facebook.com/staging_resources/MDExNDIxNzIzMjQ0NTI2NTk0OjExMzY3NzI0ODg=&cfs=1&jq=75&sx=24&sy=0&sw=778&sh=778&ext=jpg&_nc_hash=AQAj8jUr001t6Axb'
				}]
			};
			doTest(done, html, expectedPost)
		});
	});

	describe('Link Post parsing', function() {

	    it('link posts should have actions, comments, and likes...', function(done) {
			let html = '<!DOCTYPE html PUBLIC \'-//WAPFORUM//DTD XHTML Mobile 1.0//EN\' \'http://www.wapforum.org/DTD/xhtml-mobile10.dtd\'><html xmlns=\'http://www.w3.org/1999/xhtml\'><head><title>Comments</title></head><body tabindex=\'0\' class=\'b c d e\'><div class=\'f\'><div id=\'viewport\'><div class=\'g\'><h1 class=\'h\' id=\'header\'><a class=\'i\' href=\'/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png\' width=\'77\' height=\'16\' class=\'j k\' alt=\'facebook\' /></a></h1></div><div id=\'objects_container\'><div id=\'root\' role=\'main\' class=\'e\'><div id=\'m_story_permalink_view\'><div class=\'l\'><div class=\'m n\' id=\'u_0_0\'><div><div><div class=\'o p\'><a class=\'q\' href=\'/edits/?cid=1298400163514325&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>View Edit History</a></div><h3 class=\'r s\'><strong><a href=\'/IFeakingLoveScience/?refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076&amp;__tn__=C\'>I fucking love science</a></strong> shared a <a href=\'/story.php?story_fbid=1298400163514325&amp;id=367116489976035&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076&amp;__tn__=C\'>link</a>.</h3></div><div class=\'t\'><a class=\'u v\' href=\'http://lm.facebook.com/l.php?u=http%3A%2F%2Fwww.iflscience.com%2Fplants-and-animals%2Fhow-much-bacteria-does-human-body-really-contain&amp;h=nAQERjcrH&amp;enc=AZPe3HTJEL7ylOlsHGC1FFR2NS2BJwhV6ddlKHLPzZkD5oSAPRwD_2tRWAWnNEOTD7Zje0aAxzTnFc-fFcENAJgzJ_FY-B5AdgLtqaCLAjb0XJyCcYNj-PNfzzde7iTqYpOuEOW-0fdv_WKNstHI2o2N&amp;s=1\' id=\'u_0_1\' target=\'_blank\'><div class=\'e w x\'><table class=\'y z\'><tbody><tr><td class=\'ba bb\'><img src=\'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQB4l7MOtsR7yHDD&amp;w=112&amp;h=112&amp;url=http%3A%2F%2Fwww.iflscience.com%2Fsites%2Fwww.iflscience.com%2Ffiles%2Fblog%2F%255Bnid%255D%2Fbacteria.jpg&amp;cfs=1&amp;jq=75&amp;ext=jpg\' width=\'112\' height=\'112\' class=\'k\' /></td><td class=\'bc\'><h3 class=\'bd be bf\'>How Much Bacteria Does The Human Body Really Contain?</h3><div class=\'bd bg\'>iflscience.com<div class=\'bd\'></div></div></td></tr></tbody></table></div></a></div></div><div class=\'bh\'><div class=\'o p\'><abbr>9 hrs</abbr><span aria-hidden=\'true\'> · </span><span class=\'bi\'><span><span class=\'o\'>Custom</span></span></span></div><div class=\'o p\'><span aria-hidden=\'true\'> · </span><a class=\'q\' href=\'/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzSytDAxMDA0MzY1NDE2Mq1zzSsJzkgsSnUuSk0syczPCy7JL6qsqzM2Mzc0NDOxsLQ0NzMwNq2rM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I367116489976035%3A1298400163514325%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>More</a></div></div></div></div><div class=\'e bj\' id=\'ufi_1298400163514325\'><div class=\'bk bl\'><div class=\'bm bn bo\'><table class=\'y bp\'><tbody><tr><td class=\'bc bq br\' style=\'width:33%\'><a class=\'bs bt bu bv\' href=\'/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1298400163514325&amp;av=550398225&amp;gfid=AQD9lpJ3o1Cd_ouy&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png\' width=\'16\' height=\'16\' class=\'bw bx by k\' /><span class=\'bz\'>Like</span></a></td><td class=\'bc bq br\' style=\'width:33%\'><a class=\'bs bt bu bv\' href=\'#composer-1298400163514325\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\' width=\'16\' height=\'16\' class=\'bw bx by k\' /><span class=\'bz\'>Comment</span></a></td><td class=\'bc bq ca br\' style=\'width:33%\'><a class=\'bs bt bu bv\' href=\'/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=1298400163514325&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png\' width=\'16\' height=\'16\' class=\'bw bx by k\' /><span class=\'bz\'>Share</span></a></td></tr></tbody></table></div><div class=\'w cb cc cd\'><a href=\'/1298400163514325/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>2,778 people</a> like this.</div><div class=\'bk\'><div class=\'w ce\' id=\'see_prev_1298400163514325\'><a href=\'/story.php?story_fbid=1298400163514325&amp;id=367116489976035&amp;p=20&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\' width=\'16\' height=\'16\' class=\'by k\' />&nbsp;View previous comments…</a></div><div class=\'w\' id=\'1298655416822133\'><h3><a class=\'cf\' href=\'/jurgenjuve?refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Jurgen Shkoza</a></h3><div><a href=\'http://lm.facebook.com/l.php?u=http%3A%2F%2F3w1w.blogspot.al%2F2016%2F01%2Fifselftop-top_12.html&amp;h=YAQFOtPyZ&amp;enc=AZN8-1j4KWIMqQ-C7w0i8uQ4iIw4s7rlq_THPeevlJ-PRWKKIA2JJYBYng_rIv0xdurQtQ40M_0f30Dn-k0Hpt0sxTWcaIoYeFWptFPcZY06S_d7t39c_5KJnF75fRqiJTiyeJEj58fZscY4CwnEfON2&amp;s=1\' target=\'_blank\'><span>http://</span><wbr /><span class=\'word_break\'></span><span>3w1w.blogspot.al</span><wbr /><span class=\'word_break\'></span><span>/2016/01/</span><wbr /><span class=\'word_break\'></span><span>ifselftop-top_12</span><wbr /><span class=\'word_break\'></span>.html</a></div><a class=\'u cg\' href=\'http://lm.facebook.com/l.php?u=http%3A%2F%2F3w1w.blogspot.al%2F2016%2F01%2Fifselftop-top_12.html&amp;h=VAQEvjXd-&amp;enc=AZNvvHwhBrdcOnfGTMP0JVl1CkiqXk97_rrjgQJe4fACYFFn3zTAhNUqf20IMlZz_c5O3wFk9iSfAge62-0PRXgXbseNti1nTx8yMhnpwlx7rAFWhxoY-nCKwgxgPxNR9E5gbJGCnUNsLEB9dzfuj9Mo&amp;s=1\' id=\'u_0_4\' target=\'_blank\'><div class=\'e w x\'><table class=\'y z\'><tbody><tr><td class=\'ba bb\'><img src=\'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQA2nNwzP965ZXks&amp;w=52&amp;h=52&amp;url=http%3A%2F%2Fi.imgur.com%2FzYY3yDp.jpg&amp;cfs=1&amp;jq=75&amp;sx=29&amp;sy=0&amp;sw=185&amp;sh=185&amp;ext=jpg\' width=\'52\' height=\'52\' class=\'k\' /></td><td class=\'bc\'><h3 class=\'ch be bf\'>Crazy Protest in France Nude Women</h3><div class=\'bd bg\'>3w1w.blogspot.com · <div class=\'bd\'></div></div></td></tr></tbody></table></div></a><div class=\'bd ci s\'><a href=\'/comment/history/?ctoken=1298400163514325_1298655416822133&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Edited</a><span aria-hidden=\'true\'> · </span><span class=\'cj\'><span class=\'ck p\'><a class=\'q\' href=\'/a/comment.php?like_comment_id=1298655416822133&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1298400163514325&amp;av=550398225&amp;gfid=AQBwGFG9sB3kmcFb&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Like</a></span></span><span aria-hidden=\'true\'> · </span><a href=\'/comment/replies/?ctoken=1298400163514325_1298655416822133&amp;actor_id=550398225&amp;ft_ent_identifier=1298400163514325&amp;gfid=AQCUHPPjjAOLKd6R&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076#comment_form_367116489976035_1298400163514325\'>Reply</a><span aria-hidden=\'true\'> · </span><a href=\'/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMjk4NDAwMTYzNTE0MzI1XzEyOTg2NTU0MTY4MjIxMzM%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Report</a><span aria-hidden=\'true\'> · </span><abbr>2 hours ago</abbr></div></div><div class=\'w\' id=\'1298659166821758\'><h3><a class=\'cf\' href=\'/dave.godwin.98?refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Dave Godwin</a></h3><div></div><div class=\'cg cl\'><a class=\'cm\' href=\'/photo.php?fbid=1289118747780734&amp;id=100000478620575&amp;set=p.1289118747780734&amp;source=47&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'><img src=\'https://scontent.fper1-1.fna.fbcdn.net/hphotos-xft1/v/t1.0-0/cp0/e15/q65/s180x540/10419643_1289118747780734_5366764341108656249_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=c8f7bb770a79e66f322c6a8ab1e5fce7&amp;oe=5739265B\' width=\'180\' height=\'180\' class=\'cn k\' /></a></div><div class=\'bd ci s\'><span class=\'cj\'><span class=\'ck p\'><a class=\'q\' href=\'/a/comment.php?like_comment_id=1298659166821758&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1298400163514325&amp;av=550398225&amp;gfid=AQCkQM0qxC00IpIa&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Like</a></span></span><span aria-hidden=\'true\'> · </span><a href=\'/comment/replies/?ctoken=1298400163514325_1298659166821758&amp;actor_id=550398225&amp;ft_ent_identifier=1298400163514325&amp;gfid=AQC6n_hVmUORgqPF&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076#comment_form_367116489976035_1298400163514325\'>Reply</a><span aria-hidden=\'true\'> · </span><a href=\'/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMjk4NDAwMTYzNTE0MzI1XzEyOTg2NTkxNjY4MjE3NTg%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Report</a><span aria-hidden=\'true\'> · </span><abbr>2 hours ago</abbr></div></div><div class=\'w\' id=\'1298667156820959\'><h3><a class=\'cf\' href=\'/john.muthama.75?refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>John Muthama</a></h3><div>&gt;&gt;1</div><div class=\'bd ci s\'><span class=\'cj\'><span class=\'ck p\'><a class=\'q\' href=\'/a/comment.php?like_comment_id=1298667156820959&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1298400163514325&amp;av=550398225&amp;gfid=AQBOaENNuS-dlWED&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Like</a></span></span><span aria-hidden=\'true\'> · </span><a href=\'/comment/replies/?ctoken=1298400163514325_1298667156820959&amp;actor_id=550398225&amp;ft_ent_identifier=1298400163514325&amp;gfid=AQCvlJolxPvlGmlZ&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076#comment_form_367116489976035_1298400163514325\'>Reply</a><span aria-hidden=\'true\'> · </span><a href=\'/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMjk4NDAwMTYzNTE0MzI1XzEyOTg2NjcxNTY4MjA5NTk%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Report</a><span aria-hidden=\'true\'> · </span><abbr>2 hours ago</abbr></div></div><div class=\'w\' id=\'1298668290154179\'><h3><a class=\'cf\' href=\'/jurgen.tr.3?refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Jurgen Tr</a></h3><div><a href=\'http://lm.facebook.com/l.php?u=http%3A%2F%2F3w1w.blogspot.al%2F2016%2F01%2Fifselftop-top_12.html&amp;h=8AQHfhvZ5&amp;enc=AZMU6YxCJgIeA7qpdbQ4y82ugKWeJfTno1zjZTQqSzCKG8fXCkB09Obh2kWtitAbAe0r6d3i2HJDxUrnuzLV-G316OEP1w9-wZDp7Bi3ebKkX3IE5hhyfQJzeBcGFjHvKCQCWFDKuyLxmBl76uNSzL77&amp;s=1\' target=\'_blank\'><span>http://</span><wbr /><span class=\'word_break\'></span><span>3w1w.blogspot.al</span><wbr /><span class=\'word_break\'></span><span>/2016/01/</span><wbr /><span class=\'word_break\'></span><span>ifselftop-top_12</span><wbr /><span class=\'word_break\'></span>.html</a></div><a class=\'u cg\' href=\'http://lm.facebook.com/l.php?u=http%3A%2F%2F3w1w.blogspot.al%2F2016%2F01%2Fifselftop-top_12.html&amp;h=CAQF7tOi4&amp;enc=AZO0SGSE2hk-EWku8zktoy0ZISEqV8-fs6vgxysNYQXrLdZOP-3ui-oTTkAUKe7SZ_DZz9S1MaQ4mgUt59eRo4XJTm4w9n9sgohahdT3Zax9GIpf-m2vS1nHMe0koh7fDqz59wJiRR8HUn2JTXeN-UYL&amp;s=1\' id=\'u_0_5\' target=\'_blank\'><div class=\'e w x\'><table class=\'y z\'><tbody><tr><td class=\'ba bb\'><img src=\'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQA2nNwzP965ZXks&amp;w=52&amp;h=52&amp;url=http%3A%2F%2Fi.imgur.com%2FzYY3yDp.jpg&amp;cfs=1&amp;jq=75&amp;sx=29&amp;sy=0&amp;sw=185&amp;sh=185&amp;ext=jpg\' width=\'52\' height=\'52\' class=\'k\' /></td><td class=\'bc\'><h3 class=\'ch be bf\'>Crazy Protest in France Nude Women</h3><div class=\'bd bg\'>3w1w.blogspot.com · <div class=\'bd\'></div></div></td></tr></tbody></table></div></a><div class=\'bd ci s\'><a href=\'/comment/history/?ctoken=1298400163514325_1298668290154179&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Edited</a><span aria-hidden=\'true\'> · </span><span class=\'cj\'><span class=\'ck p\'><a class=\'q\' href=\'/a/comment.php?like_comment_id=1298668290154179&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1298400163514325&amp;av=550398225&amp;gfid=AQDUIt_oSSBlKkh8&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Like</a></span></span><span aria-hidden=\'true\'> · </span><a href=\'/comment/replies/?ctoken=1298400163514325_1298668290154179&amp;actor_id=550398225&amp;ft_ent_identifier=1298400163514325&amp;gfid=AQCD_SerS7EdoT3M&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076#comment_form_367116489976035_1298400163514325\'>Reply</a><span aria-hidden=\'true\'> · </span><a href=\'/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMjk4NDAwMTYzNTE0MzI1XzEyOTg2NjgyOTAxNTQxNzk%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Report</a><span aria-hidden=\'true\'> · </span><abbr>2 hours ago</abbr></div></div><div class=\'w ce\' id=\'see_next_1298400163514325\'><a href=\'/story.php?story_fbid=1298400163514325&amp;id=367116489976035&amp;p=0&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\' width=\'16\' height=\'16\' class=\'by k\' />&nbsp;View next comments…</a></div></div><div class=\'bk co\' id=\'u_0_2\'></div><div class=\'cp cq\' id=\'composer-1298400163514325\'><form method=\'post\' action=\'/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=1298400163514325&amp;gfid=AQDKAv12w7HV79R-&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076&amp;av=550398225&amp;refid=52\'><input type=\'hidden\' name=\'fb_dtsg\' value=\'AQGh1aDzJqcz\' autocomplete=\'off\' /><input type=\'hidden\' name=\'charset_test\' value=\'&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;\' /><label class=\'cr\' for=\'u_0_3\'>Write a comment...</label><table class=\'y z\' id=\'u_0_3\'><tbody><tr><td class=\'bc\'><div class=\'cs ct\'><table class=\'y cu cv\'><tbody><tr><td class=\'bc cw bp\'><input class=\'cx cy cz da\' id=\'composerInput\' name=\'comment_text\' type=\'text\' /></td></tr></tbody></table></div></td><td class=\'ba\'><div class=\'db\'><input value=\'Comment\' type=\'submit\' class=\'bt dc dd de\' /></div></td></tr></tbody></table><span class=\'df o p\'><a href=\'/mbasic/comment/advanced/?target_id=1298400163514325&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Attach a Photo</a><span aria-hidden=\'true\'> · </span><a href=\'/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1298400163514325%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1298400163514325%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076\'>Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>';
			let commentParameters = '&fb_dtsg=AQGh1aDzJqcz' + CHARSET_TEST
			let expectedPost = {
				actions: [
					new Action({ type: 'Share', target: '/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=1298400163514325&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1298400163514325%26id%3D367116489976035%26p%3D10%26refid%3D52%26_ft_%3Dqid.6239106366976061893%253Amf_story_key.5053164921379243076&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076' }),
					new Action({ type: 'Like', target: '/a/like.php?ul&perm&ifab&ft_ent_identifier=1298400163514325&av=550398225&gfid=AQD9lpJ3o1Cd_ouy&ref_component=mbasic_photo_permalink_actionbar&ref_page=%2Fwap%2Fstory.php&refid=52&_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076' }),
					new Action({ type: 'Comment', target: '/a/comment.php?fs=8&actionsource=13&redirectosoftpermalink&comment_logging&ft_ent_identifier=1298400163514325&gfid=AQDKAv12w7HV79R-&_ft_=qid.6239106366976061893%3Amf_story_key.5053164921379243076&av=550398225&refid=52' + commentParameters })
				]
			};
			doTest(done, html, expectedPost)
	    });

		it('link to Facebook post should not create a link...', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><h1 class="i" id="header"><a class="j" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="k img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="f"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_0"><div><div><h3 class="o p"><strong><a href="/tim.hoff.100?fref=nf&amp;refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401&amp;__tn__=C">Tim Hoff</a></strong><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yT/r/LDWD2fqgedV.png" width="16" height="16" class="_52h1 img" />eating<a href="/BirBintang/?refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401&amp;__tn__=C">Bir Bintang</a> at<img src="https://static.xx.fbcdn.net/rsrc.php/v2/yd/r/32_wChdUjm_.png" width="12" height="16" class="_52h1 img" /><a href="/GrainEspresso/?refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401&amp;__tn__=C">Grain Espresso</a>.</h3></div><div class="q"><p>Damn hot in here!</p></div><div class="r"><div class="f s t u" id="u_0_3"><a class="v" href="/BirBintang/?refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401&amp;__tn__=H"><table class="w x"><tbody><tr><td class="y z"><img src="https://scontent.fadl1-1.fna.fbcdn.net/hprofile-xft1/v/t1.0-1/p60x60/12274544_1170803679601095_3240246319012324482_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=57b3d0e391ae3422b65d52fc0dddee04&amp;oe=5716A55B" width="60" class="ba img" alt="Bir Bintang" /></td><td class="bb"><h3 class="bc bd be">Bir Bintang<span class="bf bg bh bi" id="u_0_4"></span></h3><h3 class="bc p bj"><span>Official Page of Indonesia&#039;s Number One &amp; Most Favorite Beer. Check our twitter page as well at &#064;...</span></h3><div class="bc bk"><span class="bl bm"><span class="bn bo bp"><span class="bq" style="width: 91%">4.5 stars</span></span></span></div></td></tr></tbody></table></a><div class="bc"></div></div></div></div><div class="br"><div class="bl bm"><abbr>5 mins</abbr><span aria-hidden="true"> · </span><span class="bs"><span><span class="bl">Friends</span></span></span></div><div class="bl bm"><span aria-hidden="true"> · </span><a class="bt" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDUzMjIyN7UwNDMwMTCsc80rCS5JLCktdi5KTSzJzM8LLskvqqyrMzOyNDEyNTEwqKszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I629425400%3A10156222758160401%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10156222758160401%26id%3D629425400%26bacr%3D1449811143%253A1449811143%253A1%253A3002828240312714129%253A1449810809%253A0%253A0%253A660%26refid%3D8%26_ft_%3Dqid.6226891445536418075%253Amf_story_key.3002828240312714129%253Aog_action_id.10156222758175401&amp;refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401">More</a></div></div></div></div><div class="f bu" id="ufi_10156222758160401"><div class="bv bw"><div class="bx by bz"><table class="w ca"><tbody><tr><td class="bb cb cc" style="width:33%"><a class="cd ce cf cg" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10156222758160401&amp;av=550398225&amp;gfid=AQDbhFmcYlxO62Gd&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="ch ci cj img" /><span class="ck">Like</span></a></td><td class="bb cb cc" style="width:33%"><a class="cd ce cf cg" href="#composer-10156222758160401"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="ch ci cj img" /><span class="ck">Comment</span></a></td><td class="bb cb cl cc" style="width:33%"><a class="cd ce cf cg" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10156222758160401&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10156222758160401%26id%3D629425400%26bacr%3D1449811143%253A1449811143%253A1%253A3002828240312714129%253A1449810809%253A0%253A0%253A660%26refid%3D8%26_ft_%3Dqid.6226891445536418075%253Amf_story_key.3002828240312714129%253Aog_action_id.10156222758175401&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="ch ci cj img" /><span class="ck">Share</span></a></td></tr></tbody></table></div><div class="bv cm" id="u_0_1"></div><div class="cn co" id="composer-10156222758160401"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=1&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10156222758160401&amp;gfid=AQDe36awRqzWuhae&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQFp0ujIdbpS" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="cp" for="u_0_2">Write a comment...</label><table class="w x" id="u_0_2"><tbody><tr><td class="bb"><div class="cq cr"><table class="w cs ct"><tbody><tr><td class="bb cu ca"><input class="cv cw cx cy" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="y"><div class="cz"><input value="Comment" type="submit" class="ce da db dc" /></div></td></tr></tbody></table><span class="dd bl bm"><a href="/mbasic/comment/advanced/?target_id=10156222758160401&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10156222758160401%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10156222758160401%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6226891445536418075%3Amf_story_key.3002828240312714129%3Aog_action_id.10156222758175401">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			let expectedPost = {
				link: '',
				type: 'photo',
				media: [ new Media({
					description: '',
					imageUrl: 'https://scontent.fadl1-1.fna.fbcdn.net/hprofile-xft1/v/t1.0-1/p60x60/12274544_1170803679601095_3240246319012324482_n.jpg?efg=eyJpIjoiYiJ9&oh=57b3d0e391ae3422b65d52fc0dddee04&oe=5716A55B',
					mimeType: 'image/jpeg',
					srcUrl: 'https://scontent.fadl1-1.fna.fbcdn.net/hprofile-xft1/v/t1.0-1/p60x60/12274544_1170803679601095_3240246319012324482_n.jpg?efg=eyJpIjoiYiJ9&oh=57b3d0e391ae3422b65d52fc0dddee04&oe=5716A55B',
					type: 'photo'
				}) ]
			};
			doTest(done, html, expectedPost);
		});

		it('link with a photo should have a photo...', function(done) {
			let html = '<!DOCTYPE html PUBLIC \'-//WAPFORUM//DTD XHTML Mobile 1.0//EN\' \'http://www.wapforum.org/DTD/xhtml-mobile10.dtd\'><html xmlns=\'http://www.w3.org/1999/xhtml\'><head><title>Comments</title></head><body tabindex=\'0\' class=\'b c d e\'><div class=\'f\'><div id=\'viewport\'><div id=\'objects_container\'><div id=\'root\' role=\'main\' class=\'e\'><div id=\'m_story_permalink_view\'><div class=\'k\'><div class=\'l m\' id=\'u_0_2\'><div><div><h3 class=\'n o\'><a href=\'/IFeakingLoveScience/?refid=52&amp;_ft_=qid.6239436263170701335%3Amf_story_key.-4668977324530158165&amp;__tn__=C\'>I fucking love science</a></h3></div><div class=\'p\'><p>What&#039;s making trails on Pluto?</p></div><div class=\'q\'><a class=\'r s\' href=\'http://lm.facebook.com/l.php?u=http%3A%2F%2Fwww.iflscience.com%2Fspace%2Fwhat-weird-snail-trail-found-pluto&amp;h=NAQFExyU4&amp;enc=AZPnerAdd9GammQ_XyJnU7qTfV7tYDzEUvG6Xqd-ap3jWxzIUQQ4E2EwS_qNMlULHXaRIyl3_iuqpaOMOpemT4gUgfZbYm1lmOcnnmg71FSbYoA2cvuq2hYjuvYYzowd-dw48RdZ8kgteCGS98dCoKeS&amp;s=1\' id=\'u_0_3\' target=\'_blank\'><div class=\'e t u\'><table class=\'v w\'><tbody><tr><td class=\'x y\'><img src=\'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQC7CD6c5GopsTqV&amp;w=112&amp;h=112&amp;url=http%3A%2F%2Fwww.iflscience.com%2Fsites%2Fwww.iflscience.com%2Ffiles%2Fblog%2F%255Bnid%255D%2Fplutosnail.PNG&amp;cfs=1&amp;jq=75&amp;ext=jpg\' width=\'112\' height=\'112\' class=\'img\' /></td><td class=\'z\'><h3 class=\'ba o bb\'>What Is This Weird &quot;Snail Trail&quot; Found On Pluto?</h3><div class=\'ba bc\'>iflscience.com<div class=\'ba\'></div></div></td></tr></tbody></table></div></a></div></div><div class=\'bd\'><div class=\'be bf\'><abbr>47 mins</abbr><span aria-hidden=\'true\'> · </span><span class=\'bg\'><span><span class=\'be\'>Custom</span></span></span></div><div class=\'be bf\'><span aria-hidden=\'true\'> · </span><a class=\'bh\' href=\'/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzSytDQ2MLE0NDM3NTe0MK5zzSsJzkgsSnUuSk0syczPCy7JL6qsqzM2Mzc0NDOxsLQ0NzMwNq2rM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I367116489976035%3A1299304916757183%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1299304916757183%26id%3D367116489976035%26bacr%3D1452731195%253A1452731195%253A1%253A305200789325592441%253A1452731100%253A0%253A0%253A1560%26refid%3D8%26_ft_%3Dqid.6239436263170701335%253Amf_story_key.-4668977324530158165&amp;refid=52&amp;_ft_=qid.6239436263170701335%3Amf_story_key.-4668977324530158165\'>More</a></div></div></div></div><div class=\'e bi\' id=\'ufi_1299304916757183\'><div class=\'bj bk\'><div class=\'bl bm bn\'><table class=\'v bo\'><tbody><tr><td class=\'z bp bq\' style=\'width:33%\'><a class=\'br bs bt bu\' href=\'/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1299304916757183&amp;av=100009543463363&amp;gfid=AQBJWbbU87Mgaoqk&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6239436263170701335%3Amf_story_key.-4668977324530158165\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png\' width=\'16\' height=\'16\' class=\'bv bw bx img\' /><span class=\'by\'>Like</span></a></td><td class=\'z bp bq\' style=\'width:33%\'><a class=\'br bs bt bu\' href=\'#composer-1299304916757183\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\' width=\'16\' height=\'16\' class=\'bv bw bx img\' /><span class=\'by\'>Comment</span></a></td><td class=\'z bp bz bq\' style=\'width:33%\'><a class=\'br bs bt bu\' href=\'/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1299304916757183&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1299304916757183%26id%3D367116489976035%26bacr%3D1452731195%253A1452731195%253A1%253A305200789325592441%253A1452731100%253A0%253A0%253A1560%26refid%3D8%26_ft_%3Dqid.6239436263170701335%253Amf_story_key.-4668977324530158165&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6239436263170701335%3Amf_story_key.-4668977324530158165\'><img src=\'https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png\' width=\'16\' height=\'16\' class=\'bv bw bx img\' /><span class=\'by\'>Share</span></a></td></tr></tbody></table></div></div></div></div></div></div></div></div></body></html>';
			let expectedPost = {
				message: 'What\'s making trails on Pluto?',
				type: 'photo',
				media: [ new Media({
					description: '',
					imageUrl: 'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQC7CD6c5GopsTqV&w=112&h=112&url=http://www.iflscience.com/sites/www.iflscience.com/files/blog/%5Bnid%5D/plutosnail.PNG&cfs=1&jq=75&ext=jpg',
					mimeType: 'image/jpeg',
					srcUrl: 'https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQC7CD6c5GopsTqV&w=112&h=112&url=http://www.iflscience.com/sites/www.iflscience.com/files/blog/%5Bnid%5D/plutosnail.PNG&cfs=1&jq=75&ext=jpg',
					type: 'photo'
				}) ]
			};
			doTest(done, html, expectedPost);
		});

		it('ignore edit/delete of own post', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="default" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .m{background:#f6f7f8;border:0;font-size:small;margin:0;}.m .p{font-size:x-small;}.y>div{border-top:1px solid rgba(0, 0, 0, .101);}.y>.y>div:first-child{border-top:none;}.x{background-color:#f6f7f8;color:#141823;}.bt{border-bottom:1px solid #ddd;}.b .bt{padding-bottom:8px;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media only screen and (device-width: 320px) and (device-height: 568px){}@media only screen and (device-width: 320px) and (device-height: 480px){}@media (max-height:540px){}@media (max-height:400px){}@media screen and (orientation:portrait){}@media only screen and (orientation: portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .bc{border-color:#ddd;border-width:1px 0 0;}.b .bc .bg{background-color:#f6f7f8;}.b .bc .bg:hover,.b .bc .bg:hover .bk{background-color:#e9eaed;}.b .bc .bk{background-color:inherit;}.bs{padding:8px 8px 0;}.bu{color:#141823;display:block;font-size:small;}.b .bs .bx table{border:none;}.b .bs .cd{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cg{padding-left:4px;}.ck{margin-top:4px;}form{margin:0;border:0;}.b .bd{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .bd tbody,.b .bv>tr>td,.b .bv>tbody>tr>td,.b .bd td.bv{vertical-align:top;}.b .be>tr>td,.b .be>tbody>tr>td,.b .bd td.be{vertical-align:middle;}.b .bd td{padding:0;}.b .bd td.cc{padding:2px;}.b .bf{width:100%;}.bz{background:#fff;}.bw .ce{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .bw .by{border:1px solid #9197a3;}.cb{border:0;display:block;margin:0;padding:0;}.b .cc{padding:2px;}.ch{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .ch{border-radius:2px;}.ch[disabled] .bn{opacity:.3;}.cj,a.cj,html .b a.cj{color:#fff;}.b .cj{background-color:#4e69a2;border:1px solid #385490;}.b a.cj:hover,.b .cj:hover{background-color:#465e91;}.cj[disabled]{color:#899bc1;}.b .cj[disabled]:hover{background-color:#4e69a2;}.ch .bp{display:inline-block;}.b .ch .bp{display:inline-block;margin-top:0;vertical-align:middle;}.b a.ch::after,.b .ch.bi::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .ch .bn{vertical-align:top;}.ch .bp{line-height:20px;margin-top:4px;}.ch .bn.bo{margin-top:6px;}.ch.bi{padding-left:8px;}.ch.bi .bn{margin-right:6px;}.b .ch{padding:0 8px;}.b a.ch{height:26px;line-height:26px;}.b a.ch .bn.bo{margin-top:5px;}.b .ch.bi{padding-left:7px;}.bn,.k.bn{display:inline-block;pointer-events:none;vertical-align:middle;}.bp{pointer-events:none;}.q{color:gray;}.p{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .r,.b .r:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .r:focus,.b .r:hover{background-color:#3b5998;color:#fff;}.bb{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.ba .bk,.ba .bg{background-color:#fff;}.bg{background-color:#fff;position:relative;}.bg.bg.bg{padding:6px 0;}.bk{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bl,button.bl{width:100%;}.bk{display:block;}.bk{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bg a.bk{color:#4e5665;}.b .bg a.bk:hover,.b .bg a.bk:focus{background:#f2f2f2;color:#4e5665;}.bg:hover,.bg:focus,.bg:hover .bk,.bg:focus .bk{background:#f2f2f2;}.bk{padding:0 4px;}.bg .bk .bm{display:block;margin:0 auto;}.bg .bi.bk .bm{margin:0 auto 1px;}.bg .bp{pointer-events:auto;}.k{border:0;display:inline-block;vertical-align:top;}i.k u{position:absolute;width:0;height:0;overflow:hidden;}.n{margin:0 6px 6px;padding:6px;}.b .n .n{border-color:#e9eaed;margin:6px 0 0;}.w{display:inline-block;}.v{margin-top:5px;}.u{margin:5px 0;}.n a,.n a:visited{color:#2b55ad;}.n a:hover,.n a:focus{background:#2b55ad;color:#fff;}.m .n{font-size:small;padding:4px;}.m .v{margin-top:6px;}.m .u{margin:6px 0;}.b .o{background:white;margin:0;}.s{color:#4e5665;}.t{font-weight:bold;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j k" alt="facebook" /></a></h1></div><div id="objects_container"><div class="l e" id="root" role="main"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_2"><div><div><div class="p q"><a class="r" href="/edit/post/dialog/?cid=S%3A_I100009543463363%3A1555524704775630&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D1555524704775630%26id%3D100009543463363%26refid%3D7&amp;perm&amp;loc=permalink&amp;refid=52">Edit</a><span aria-hidden="true"> · </span><a class="r" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100009543463363%3A1555524704775630&amp;continue=%2Fstories.php%23s_540c2a79fd2776d3377c1f0f33a46840&amp;refid=52">Delete</a></div><h3 class="s t"><a href="/teest.devisd?refid=52&amp;__tn__=C"><strong><a href="/teest.devisd?fref=nf&amp;refid=52&amp;__tn__=C">Teest Devisd</a></strong></a></h3></div><div class="u"><p>Test my post</p></div></div><div class="v"><div class="p q"><abbr>1 min</abbr><span aria-hidden="true"> · </span><span class="w"><div><span class="p">Privacy:&nbsp;</span><span class="p"><a href="/privacyx/selector/?redir=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1555524704775630%26id%3D100009543463363%26refid%3D7&amp;ci=1555524704775630&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQAUKPPRjPt90ns0&amp;refid=52">Public</a></span></div></span></div><div class="p q"><a class="r" href="/composer/mbasic/?c_src=feed_story&amp;referrer=feed_story&amp;target=100009543463363&amp;story_id=1555524704775630&amp;ctype=inline&amp;cwevent=composer_entry&amp;av=100009543463363&amp;icv=lgc_view_photo&amp;lgc_view_photo&amp;refid=52">Add Photos</a><span aria-hidden="true"> · </span><a class="r" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQFAiMTcwMTc3NTM2ODOte8kuCSxJLSYuei1MSSzPy84JL8osq6OkMDILA0NTE2MTM2NjOuqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I100009543463363%3A1555524704775630%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1555524704775630%26id%3D100009543463363%26refid%3D7&amp;refid=52">More</a></div></div></div></div><div class="e x" id="ufi_1555524704775630"><div class="y z"><div class="ba bb bc"><table class="bd be"><tbody><tr><td class="bf bg bh" style="width:33%"><a class="bi bj bk bl" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1555524704775630&amp;av=100009543463363&amp;gfid=AQDFfvt--yYdbY8w&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bm bn bo k" /><span class="bp">Like</span></a></td><td class="bf bg bh" style="width:33%"><a class="bi bj bk bl" href="#composer-1555524704775630"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bm bn bo k" /><span class="bp">Comment</span></a></td><td class="bf bg bq bh" style="width:33%"><a class="bi bj bk bl" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1555524704775630&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1555524704775630%26id%3D100009543463363%26refid%3D7&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bm bn bo k" /><span class="bp">Share</span></a></td></tr></tbody></table></div><div class="y br" id="u_0_0"></div><div class="bs bt" id="composer-1555524704775630"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=1&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=1555524704775630&amp;gfid=AQB31Yk2dremsL0P&amp;av=100009543463363&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQGeSFT6xpqK:AQG04kYRiLZw" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="bu" for="u_0_1">Write a comment...</label><table class="bd bv" id="u_0_1"><tbody><tr><td class="bf"><div class="bw bx"><table class="bd by bz"><tbody><tr><td class="bf ca be"><input class="cb cc cd ce" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cf"><div class="cg"><input value="Comment" type="submit" class="bj ch ci cj" /></div></td></tr></tbody></table><span class="ck p q"><a href="/mbasic/comment/advanced/?target_id=1555524704775630&amp;pap=1&amp;at=compose&amp;refid=52">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1555524704775630%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1555524704775630%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			let expectedPost = {
				message: 'Test my post'
			}
			doTest(done, html, expectedPost)
		})

		it('exception html to ensure does not link in gif as link', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="j k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77"/></a></h1></div><div id="objects_container"><div class="l e" id="root" role="main"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_2"><div><div><h3 class="p q"><a href="/theprojecttv/?refid=52&amp;_ft_=qid.6257279365729005277%3Amf_story_key.6014984650057900322&amp;__tn__=C">The Project</a></h3></div><div class="r"><p>Dad successfully takes down hostile pillow fight opponent with impressive accuracy <a class="_5ayv" href="/hashtag/ko?refid=52&amp;_ft_=qid.6257279365729005277%3Amf_story_key.6014984650057900322&amp;__tn__=%2As"><span class="_5aw4">‪#‎</span><span class="_5ayu">KO‬</span></a><a class="_5ayv" href="/hashtag/theprojecttv?refid=52&amp;_ft_=qid.6257279365729005277%3Amf_story_key.6014984650057900322&amp;__tn__=%2As"><span class="_5aw4">‪#‎</span><span class="_5ayu">TheProjectTV‬</span></a><br/>Story: <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fon.mash.to%2F1oL0med&amp;h=JAQGpJA4H&amp;enc=AZNFQu6Okiu9HvS0pc4jh0snsTQv1m1bC7zxhWSvzWCZU__Qd6HcVap-3o--jarqFlsmqFmO4yut9pxKRzvOBgNoOGt5_ZrWFccmfDriyvMXSKq5hWA1K5JGichUcAk1tR-aaGlqC_s63ddTJiljiRRMHQhXRvC6BBFtxKft9UKR-A&amp;s=1" target="_blank"><span>http://</span><wbr/><span class="word_break"/><span>on.mash.to/</span><wbr/><span class="word_break"/>1oL0med</a></p></div><div class="s"><a class="t u" href="https://m.facebook.com/l.php?u=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FxT9DPrafMHB3fsdMeA%2Fgiphy.gif&amp;h=jAQGW_xGk&amp;enc=AZPTWWjzuikAQBGwDownwX5xtK9_0vH1269VK1sjYqPQ_xTa-swkvNVuJOYL3Pez4qvjR1XH6kQdpH88RfzXSgF3Oh4FGKC15dR9AMpm_5RmTHtX-XIPPuKrzbn7kRdoenUaP67Yfa4NIYvO9fVrTHzF&amp;s=1" id="u_0_3" target="_blank"><div class="e v w"><table class="x y"><tbody><tr><td class="z ba"><img class="k" height="112" src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQCLfc1vb5kg0vOG&amp;url=https%3A%2F%2Fmedia.giphy.com%2Fmedia%2FxT9DPrafMHB3fsdMeA%2Fgiphy.gif&amp;jq=75&amp;ext=jpg" width="112"/></td><td class="bb"><h3 class="bc q bd">media.giphy.com</h3><div class="bc be">media.giphy.com<div class="bc"/></div></td></tr></tbody></table></div></a></div></div><div class="bf"><div class="bg bh"><abbr>21 hrs</abbr><span aria-hidden="true">· </span><span class="bi"><span><span class="bg">Public</span></span></span></div><div class="bg bh"><a class="bj" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDU2MTY1NjI3NDA2MTGsc80rCc5ILEp1LkpNLMnMzwsuyS-qrKszNDA3tzA3MLQwMTGoqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I107787018440%3A10153435327103441%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10153435327103441%26id%3D107787018440%26bacr%3D1456810526%253A1456810526%253A2%253A-7396756222335034312%253A1456810470%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6257279365729005277%253Amf_story_key.6014984650057900322&amp;refid=52&amp;_ft_=qid.6257279365729005277%3Amf_story_key.6014984650057900322">More</a></div></div></div></div><div class="e bk" id="ufi_10153435327103441"><div class="bl bm"><div class="bn bo bp"><table class="x bq"><tbody><tr><td class="bb br bs" style="width:33%"><a class="bt bu bv bw" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10153435327103441&amp;av=100009543463363&amp;gfid=AQBpnESTrW_0HwPZ&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6257279365729005277%3Amf_story_key.6014984650057900322"><img class="bx by bz k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16"/><span class="ca">Like</span></a></td><td class="bb br bs" style="width:33%"><a class="bt bu bv bw" href="#composer-10153435327103441"><img class="bx by bz k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16"/><span class="ca">Comment</span></a></td><td class="bb br cb bs" style="width:33%"><a class="bt bu bv bw" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=10153435327103441&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10153435327103441%26id%3D107787018440%26bacr%3D1456810526%253A1456810526%253A2%253A-7396756222335034312%253A1456810470%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6257279365729005277%253Amf_story_key.6014984650057900322&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6257279365729005277%3Amf_story_key.6014984650057900322"><img class="bx by bz k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16"/><span class="ca">Share</span></a></td></tr></tbody></table></div></div></div></div></div></div></div></div></body></html>';
			let expectedPost = {
				link: 'http://on.mash.to/1oL0med',
				media: [{
					imageUrl: 'https://media.giphy.com/media/xT9DPrafMHB3fsdMeA/giphy.gif'
				}],
				message: 'Dad successfully takes down hostile pillow fight opponent with impressive accuracy #KO #TheProjectTV\nStory: http://on.mash.to/1oL0med',
				type: 'photo'
			}
			doTest(done, html, expectedPost);
		});

	    it('ensure link to photo treated as a photo', function(done) {
			let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comments</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div class=\"g\"><h1 class=\"h\" id=\"header\"><a class=\"i\" href=\"/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png\" width=\"77\" height=\"16\" class=\"j k\" alt=\"facebook\" /></a></h1></div><div id=\"objects_container\"><div class=\"l e\" id=\"root\" role=\"main\"><div id=\"m_story_permalink_view\"><div class=\"m\"><div class=\"n o\" id=\"u_0_0\"><div><div><h3 class=\"p q\"><a href=\"/DeusEx/?refid=52&amp;_ft_=qid.6257643858037959396%3Amf_story_key.-707790598968266475&amp;__tn__=C\">Deus Ex</a></h3></div><div class=\"r\"><p>Running to the store to get some cereals.</p></div><div class=\"s\"><a class=\"t u\" href=\"https://mbasic.facebook.com/l.php?u=https%3A%2F%2Fgiant.gfycat.com%2FHoarseLikableGoral.gif&amp;h=pAQHclYCY&amp;enc=AZMwcXpcsfgGE5vCCasI2MBb4zzshvNqMT8opFPNgN4y4QAWJQC1FDHKJKDtwza_BTb9WHqD82ZOZZ2fh_KMC11x2XJzBJMkHaW9EB_CqNwVPwg1qtM7TD_nwacJrCm832jHI4pbZH0J3RliekC16UQH&amp;s=1\" id=\"u_0_2\" target=\"_blank\"><div class=\"e v w\"><table class=\"x y\"><tbody><tr><td class=\"z ba\"><img src=\"https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQCXY2p9Qt-66Z1C&amp;url=https%3A%2F%2Fgiant.gfycat.com%2FHoarseLikableGoral.gif&amp;jq=75&amp;ext=jpg\" width=\"112\" height=\"112\" class=\"k\" /></td><td class=\"bb\"><h3 class=\"bc q bd\">giant.gfycat.com</h3><div class=\"bc be\">giant.gfycat.com<div class=\"bc\"></div></div></td></tr></tbody></table></div></a></div></div><div class=\"bf\"><div class=\"bg bh\"><abbr>9 hrs</abbr><span aria-hidden=\"true\"> · </span><span class=\"bi\"><span><span class=\"bg\">Custom</span></span></span></div><div class=\"bg bh\"><a class=\"bj\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22szQxMjAzNTA1tTAxszAxrnPNKwnOSCxKdS5KTSzJzM8LLskvqqyrMzS0NDExMjQxBJIm5mZ1dQZ1AA%22%2C%22story_permalink_token%22%3A%22S%3A_I119442141442476%3A942065055846843%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D942065055846843%26id%3D119442141442476%26bacr%3D1456970141%253A1456970141%253A3%253A6074615045830882743%253A1456865536%253A0%253A0%253A61200%26refid%3D7%26_ft_%3Dqid.6257643858037959396%253Amf_story_key.-707790598968266475&amp;refid=52&amp;_ft_=qid.6257643858037959396%3Amf_story_key.-707790598968266475\">More</a></div></div></div></div></div></div></div></div></div></body></html>';
			let expectedPost = {
				link: '',
				media: [
					new Media({
						imageUrl: 'https://giant.gfycat.com/HoarseLikableGoral.gif',
						mimeType: 'image/jpeg',
						srcUrl: 'https://giant.gfycat.com/HoarseLikableGoral.gif',
						type: 'photo'
					})
				],
				type: 'photo'
			}
			doTest(done, html, expectedPost);
	    });

	    it('exception scenario of composed image being shrunk', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="default" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .n{background:#f6f7f8;border:0;font-size:small;margin:0;}.n .q{font-size:x-small;}.n .bi{font-size:x-small;}.bm>div{border-top:1px solid rgba(0, 0, 0, .101);}.bm>.bm>div:first-child{border-top:none;}.bl{background-color:#f6f7f8;color:#141823;}.cf{border-bottom:1px solid #ddd;}.b .cf{padding-bottom:8px;}@keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media only screen and (device-width: 320px) and (device-height: 568px){}@media only screen and (device-width: 320px) and (device-height: 480px){}@media (max-height:540px){}@media (max-height:400px){}@media screen and (orientation:portrait){}@media only screen and (orientation: portrait){}@media only screen and (orientation: landscape){}.f{background:#f6f7f8;}.b .bq{border-color:#ddd;border-width:1px 0 0;}.b .bq .bs{background-color:#f6f7f8;}.b .bq .bs:hover,.b .bq .bs:hover .bw{background-color:#e9eaed;}.b .bq .bw{background-color:inherit;}.ce{padding:8px 8px 0;}.cg{color:#141823;display:block;font-size:small;}.b .ce .ci table{border:none;}.b .ce .co{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cq{padding-left:4px;}.cu{margin-top:4px;}form{margin:0;border:0;}.b .bb{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .bb tbody,.b .bc>tr>td,.b .bc>tbody>tr>td,.b .bb td.bc{vertical-align:top;}.b .br>tr>td,.b .br>tbody>tr>td,.b .bb td.br{vertical-align:middle;}.b .bb td{padding:0;}.b .bb td.cn{padding:2px;}.b .bb td.z{padding:4px;}.b .bf{width:100%;}.ck{background:#fff;}.ch .cp{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .ch .cj{border:1px solid #9197a3;}.cm{border:0;display:block;margin:0;padding:0;}.b .cn{padding:2px;}.b .z{padding:4px;}.cr{-moz-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cr{border-radius:2px;}.cr[disabled] .bz{opacity:.3;}.ct,a.ct,html .b a.ct{color:#fff;}.b .ct{background-color:#4e69a2;border:1px solid #385490;}.b a.ct:hover,.b .ct:hover{background-color:#465e91;}.ct[disabled]{color:#899bc1;}.b .ct[disabled]:hover{background-color:#4e69a2;}.cr .cb{display:inline-block;}.b .cr .cb{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cr::after,.b .cr.bu::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cr .bz{vertical-align:top;}.cr .cb{line-height:20px;margin-top:4px;}.cr .bz.ca{margin-top:6px;}.cr.bu{padding-left:8px;}.cr.bu .bz{margin-right:6px;}.b .cr{padding:0 8px;}.b a.cr{height:26px;line-height:26px;}.b a.cr .bz.ca{margin-top:5px;}.b .cr.bu{padding-left:7px;}.bz,.l.bz{display:inline-block;pointer-events:none;vertical-align:middle;}.cb{pointer-events:none;}.r{color:gray;}.q{font-size:small;}body,tr,input,textarea,.g{font-size:medium;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .s,.b .s:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .s:focus,.b .s:hover{background-color:#3b5998;color:#fff;}.bp{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.bo .bw,.bo .bs{background-color:#fff;}.bs{background-color:#fff;position:relative;}.bs.bs.bs{padding:6px 0;}.bw{-moz-appearance:none;border:none;margin:0;padding:0;}input.bx,button.bx{width:100%;}.bw{display:block;}.bw{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bs a.bw{color:#4e5665;}.b .bs a.bw:hover,.b .bs a.bw:focus{background:#f2f2f2;color:#4e5665;}.bs:hover,.bs:focus,.bs:hover .bw,.bs:focus .bw{background:#f2f2f2;}.bw{padding:0 4px;}.bs .bw .by{display:block;margin:0 auto;}.bs .bu.bw .by{margin:0 auto 1px;}.bs .cb{pointer-events:auto;}.l{border:0;display:inline-block;vertical-align:top;}i.l u{position:absolute;width:0;height:0;overflow:hidden;}.o{margin:0 6px 6px;padding:6px;}.b .o .o{border-color:#e9eaed;margin:6px 0 0;}.bk{display:inline-block;}.bj{margin-top:5px;}.v,.w{margin:5px 0;}.o a,.o a:visited{color:#2b55ad;}.o a:hover,.o a:focus{background:#2b55ad;color:#fff;}.n .o{font-size:small;padding:4px;}.n .bj{margin-top:6px;}.n .v,.n .w{margin:6px 0;}.b .p{background:white;margin:0;}.t{color:#4e5665;}.bg{font-size:12px;line-height:16px;}.u{font-weight:bold;}.ba{border:1px solid #ccc;margin:5px 0;word-wrap:break-word;}.b .ba .be{padding-right:4px;}.x{display:block;}.b .x,.b .x:visited{color:#3e4350;}.b .x:focus,.b .x:hover,.b .x:focus .ba,.b .x:hover .ba{background:#3b5998;color:#fff;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.e #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.i{background:#3b5998;height:24px;}.j{display:inline-block;}.k{padding:4px 5px 5px;}/*]]>*/</style></head><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><h1 class="i" id="header"><a class="j" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="k l" alt="facebook" /></a></h1></div><div id="objects_container"><div class="m f" id="root" role="main"><div id="m_story_permalink_view"><div class="n"><div class="o p" id="u_0_2"><div><div><div class="q r"><a class="s" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100009543463363%3A1556626174665483&amp;continue=%2Fstories.php%3Faftercursorr%3D1456986094%253A1456986094%253A2%253A-2638931692767207595%253A1456986094%253A0%253A0%253A120%23s_e46960c62e8b490fa3c4321c4710b9b8&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120">Delete</a></div><h3 class="t u"><a href="/teest.devisd?refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120&amp;__tn__=C"><strong><a href="/teest.devisd?fref=nf&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120&amp;__tn__=C">Teest Devisd</a></strong></a></h3></div><div class="v"><p>Photo to be thumbnail</p></div><div class="w"><a class="x y" href="https://www.facebook.com/photo.php?fbid=1556626164665484&amp;set=a.1555094294818671.1073741846.100009543463363&amp;type=3&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120" id="u_0_3"><div class="f z ba"><table class="bb bc"><tbody><tr><td class="bd be"><img src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQDRxDKMAAMiBnu3&amp;w=112&amp;h=112&amp;url=https%3A%2F%2Fscontent.fper1-1.fna.fbcdn.net%2Fhphotos-xfl1%2Fv%2Ft1.0-0%2Fcp0%2Fe15%2Fq65%2Fp118x90%2F12814296_1556626164665484_3889336831766367693_n.jpg%3Fefg%3DeyJpIjoiYiJ9%26oh%3D6a3ea6bde8174e6a60621871a4a894ca%26oe%3D57673695&amp;cfs=1" width="112" height="112" class="l" /></td><td class="bf"><h3 class="bg u bh"></h3><div class="bg bi">www.facebook.com<div class="bg"></div></div></td></tr></tbody></table></div></a></div></div><div class="bj"><div class="q r"><abbr>5 mins</abbr><span aria-hidden="true"> · </span>Social Stream<span aria-hidden="true"> · </span><span class="bk"><div><span class="q">Privacy:&nbsp;</span><span class="q"><a href="/privacyx/selector/?redir=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1556626174665483%26id%3D100009543463363%26bacr%3D1456986094%253A1456986094%253A2%253A-2638931692767207595%253A1456986094%253A0%253A0%253A120%26refid%3D7%26_ft_%3Dqid.6257708454204931084%253Amf_story_key.-4645026555726532120&amp;ci=100009543463363&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQCQ6nm8zp6tS60L&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120">Public</a></span></div></span></div><div class="q r"><a class="s" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22DcZBD4IgGIDhvwR96ObBQwuqy8dKRWc3XG5BKpvRDA_89ni3Z3urLiMKqvDozl5dWzNcpl2Lwui5tU_ufsiPG_I3lRyJtLgnOTaKStsHaQVI3h9kc2e4lWUUi6_9Our59h0m83md0nvjltq7NcRISarIGLAcIIcYSfwD%22%2C%22story_permalink_token%22%3A%22S%3A_I100009543463363%3A1556626174665483%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1556626174665483%26id%3D100009543463363%26bacr%3D1456986094%253A1456986094%253A2%253A-2638931692767207595%253A1456986094%253A0%253A0%253A120%26refid%3D7%26_ft_%3Dqid.6257708454204931084%253Amf_story_key.-4645026555726532120&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120">More</a></div></div></div></div><div class="f bl" id="ufi_1556626174665483"><div class="bm bn"><div class="bo bp bq"><table class="bb br"><tbody><tr><td class="bf bs bt" style="width:33%"><a class="bu bv bw bx" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=100009543463363%3A1556626174665483%3A63&amp;av=100009543463363&amp;gfid=AQCV0JBa7KzqEksp&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="by bz ca l" /><span class="cb">Like</span></a></td><td class="bf bs bt" style="width:33%"><a class="bu bv bw bx" href="#composer-1556626174665483"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="by bz ca l" /><span class="cb">Comment</span></a></td><td class="bf bs cc bt" style="width:33%"><a class="bu bv bw bx" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1556626174665483&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1556626174665483%26id%3D100009543463363%26bacr%3D1456986094%253A1456986094%253A2%253A-2638931692767207595%253A1456986094%253A0%253A0%253A120%26refid%3D7%26_ft_%3Dqid.6257708454204931084%253Amf_story_key.-4645026555726532120&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="by bz ca l" /><span class="cb">Share</span></a></td></tr></tbody></table></div><div class="bm cd" id="u_0_0"></div><div class="ce cf" id="composer-1556626174665483"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=1&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=100009543463363%3A1556626174665483%3A63&amp;gfid=AQCr6niW5-_xIio_&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120&amp;av=100009543463363&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQHIb-C5aEBC:AQFbxqK03NLd" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="cg" for="u_0_1">Write a comment...</label><table class="bb bc" id="u_0_1"><tbody><tr><td class="bf"><div class="ch ci"><table class="bb cj ck"><tbody><tr><td class="bf cl br"><input class="cm cn co cp" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="bd"><div class="cq"><input value="Comment" type="submit" class="bv cr cs ct" /></div></td></tr></tbody></table><span class="cu q r"><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1556626174665483%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1556626174665483%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6257708454204931084%3Amf_story_key.-4645026555726532120">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			let expectedPost = {
				media: [
					new Media({
						imageUrl: 'https://scontent.fper1-1.fna.fbcdn.net/hphotos-xfl1/v/t1.0-0/cp0/e15/q65/p118x90/12814296_1556626164665484_3889336831766367693_n.jpg?efg=eyJpIjoiYiJ9&oh=6a3ea6bde8174e6a60621871a4a894ca&oe=57673695',
						mimeType: 'image/jpeg',
						srcUrl: 'https://scontent.fper1-1.fna.fbcdn.net/hphotos-xfl1/v/t1.0-0/cp0/e15/q65/p118x90/12814296_1556626164665484_3889336831766367693_n.jpg?efg=eyJpIjoiYiJ9&oh=6a3ea6bde8174e6a60621871a4a894ca&oe=57673695',
						type: 'photo'
					})
				]
			}
			doTest(done, html, expectedPost);
	    });

		it('exception scenario link image shrunk', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="origin-when-crossorigin" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .n{background:#f6f7f8;border:0;font-size:small;margin:0;}.n .bh{font-size:x-small;}.n .bf{font-size:x-small;}.bn .cd a{font-weight:bold;}.bm>div{border-top:1px solid rgba(0, 0, 0, .101);}.bm>.bm>div:first-child{border-top:none;}.bl,.bl .cf{background-color:#f6f7f8;color:#141823;}.ch{border-bottom:1px solid #ddd;}.b .ch{padding-bottom:8px;}.f{background:#f6f7f8;}.b .bq{border-color:#ddd;border-width:1px 0 0;}.b .bq .bs{background-color:#f6f7f8;}.b .bq .bs:hover,.b .bq .bs:hover .bw{background-color:#e9eaed;}.b .bq .bw{background-color:inherit;}.cg{padding:8px 8px 0;}.ci{color:#141823;display:block;font-size:small;}.b .cg .ck table{border:none;}.b .cg .cq{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cs{padding-left:4px;}.cw{margin-top:4px;}form{margin:0;border:0;}.b .y{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .y tbody,.b .z>tr>td,.b .z>tbody>tr>td,.b .y td.z{vertical-align:top;}.b .br>tr>td,.b .br>tbody>tr>td,.b .y td.br{vertical-align:middle;}.b .y td{padding:0;}.b .y td.cp{padding:2px;}.b .y td.w{padding:4px;}.b .bc{width:100%;}.cm{background:#fff;}.cj .cr{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cj .cl{border:1px solid #9197a3;}.co{border:0;display:block;margin:0;padding:0;}.b .cp{padding:2px;}.b .w{padding:4px;}.ct{-moz-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .ct{border-radius:2px;}.ct[disabled] .bz{opacity:.3;}.cv,a.cv,html .b a.cv{color:#fff;}.b .cv{background-color:#4e69a2;border:1px solid #385490;}.b a.cv:hover,.b .cv:hover{background-color:#465e91;}.cv[disabled]{color:#899bc1;}.b .cv[disabled]:hover{background-color:#4e69a2;}.ct .cb{display:inline-block;}.b .ct .cb{display:inline-block;margin-top:0;vertical-align:middle;}.b a.ct::after,.b .ct.bu::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .ct .bz{vertical-align:top;}.ct .cb{line-height:20px;margin-top:4px;}.ct .bz.ca{margin-top:6px;}.ct.bu{padding-left:8px;}.ct.bu .bz{margin-right:6px;}.b .ct{padding:0 8px;}.b a.ct{height:26px;line-height:26px;}.b a.ct .bz.ca{margin-top:5px;}.b .ct.bu{padding-left:7px;}.bz,.l.bz{display:inline-block;pointer-events:none;vertical-align:middle;}.cb{pointer-events:none;}.bi{color:gray;}.bh{font-size:small;}body,tr,input,textarea,.g{font-size:medium;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .bk,.b .bk:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .bk:focus,.b .bk:hover{background-color:#3b5998;color:#fff;}.bp{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.bo .bw,.bo .bs{background-color:#fff;}.bs{background-color:#fff;position:relative;}.bs.bs.bs{padding:6px 0;}.bw{-moz-appearance:none;border:none;margin:0;padding:0;}input.bx,button.bx{width:100%;}.bw{display:block;}.bw{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bs a.bw{color:#4e5665;}.b .bs a.bw:hover,.b .bs a.bw:focus{background:#f2f2f2;color:#4e5665;}.bs:hover,.bs:focus,.bs:hover .bw,.bs:focus .bw{background:#f2f2f2;}.bw{padding:0 4px;}.bs .bw .by{display:block;margin:0 auto;}.bs .bu.bw .by{margin:0 auto 1px;}.bs .cb{pointer-events:auto;}.l{border:0;display:inline-block;vertical-align:top;}i.l u{position:absolute;width:0;height:0;overflow:hidden;}.ce{background:#eceff5;font-size:small;padding:8px;}.ce a{font-weight:bold;}.o{margin:0 6px 6px;padding:6px;}.b .o .o{border-color:#e9eaed;margin:6px 0 0;}.bj{display:inline-block;}.bg{margin-top:5px;}.s,.t{margin:5px 0;}.o a,.o a:visited{color:#2b55ad;}.o a:hover,.o a:focus{background:#2b55ad;color:#fff;}.n .o{font-size:small;padding:4px;}.n .bg{margin-top:6px;}.n .s,.n .t{margin:6px 0;}.b .p{background:white;margin:0;}.q{color:#4e5665;}.bd{font-size:12px;line-height:16px;}.r{font-weight:bold;}.x{border:1px solid #ccc;margin:5px 0;word-wrap:break-word;}.b .x .bb{padding-right:4px;}.u{display:block;}.b .u,.b .u:visited{color:#3e4350;}.b .u:focus,.b .u:hover,.b .u:focus .x,.b .u:hover .x{background:#3b5998;color:#fff;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.e #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.i{background:#3b5998;height:24px;}.j{display:inline-block;}.k{padding:4px 5px 5px;}/*]]>*/</style></head><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><h1 class="i" id="header"><a class="j" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="k l" alt="facebook" /></a></h1></div><div id="objects_container"><div class="m f" id="root" role="main"><div id="m_story_permalink_view"><div class="n"><div class="o p" id="u_0_1"><div><div><h3 class="q r"><a href="/uniladmag/?refid=52&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874&amp;__tn__=C">UNILAD</a></h3></div><div class="s"><p>You may love it, you may hate, but there have been some absolutely amazing Snapchat faceswaps since the update. This is the best of the lot...</p></div><div class="t"><a class="u v" href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fwww.unilad.co.uk%2Fpics%2Fthese-pics-prove-faceswap-is-the-best-snapchat-update-ever%2F&amp;h=eAQGGKKPe&amp;enc=AZMXY9EDRhGbH5BadwYXf20PMumiiTykDJISM12FH1GupIh_OXw1ZLhQMV7aXSCoyIyToHYqj2P234bJQh44wlh0idMLrTjyhOqkTTPF5Sp59vfvF3Gv_H7BHGrl0I9Kf6YGieQ9Yv9g9P5_ncl0x9pa&amp;s=1" id="u_0_2" target="_blank"><div class="f w x"><table class="y z"><tbody><tr><td class="ba bb"><img src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQB5FhuG4G3Yi9vE&amp;w=112&amp;h=112&amp;url=https%3A%2F%2Fscontent-lhr3-1.xx.fbcdn.net%2Fhphotos-xat1%2Fv%2Ft1.0-9%2F12821352_2207187815970932_1123565561842989891_n.jpg%3Foh%3Daf2e7699ce3843590fdec277695a385b%26oe%3D575B6C74&amp;cfs=1&amp;jq=75&amp;sx=0&amp;sy=0&amp;sw=438&amp;sh=438&amp;ext=jpg" width="112" height="112" class="l" /></td><td class="bc"><h3 class="bd r be">These Pics Prove Faceswap Is The Best Snapchat Update Ever</h3><div class="bd bf">unilad.co.uk<div class="bd"></div></div></td></tr></tbody></table></div></a></div></div><div class="bg"><div class="bh bi"><abbr>3 mins</abbr><span aria-hidden="true"> · </span><span class="bj"><span><span class="bh">Public</span></span></span></div><div class="bh bi"><a class="bk" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzIyMDe0sDA3MzIzNjc1MKlzzSsJzkgsSnUuSk0syczPCy7JL6qsqzM0MTM1MDUyNDIwtjQyNK6rM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I146505212039213%3A2207188762637504%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D2207188762637504%26id%3D146505212039213%26bacr%3D1456990091%253A1456990091%253A1%253A3446187331056436874%253A1456989900%253A0%253A0%253A38%26refid%3D8%26_ft_%3Dqid.6257724792419079008%253Amf_story_key.3446187331056436874&amp;refid=52&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874">More</a></div></div></div></div><div class="f bl" id="ufi_2207188762637504"><div class="bm bn"><div class="bo bp bq"><table class="y br"><tbody><tr><td class="bc bs bt" style="width:33%"><a class="bu bv bw bx" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=2207188762637504&amp;av=100009543463363&amp;gfid=AQDID0OtJBQZZjN4&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="by bz ca l" /><span class="cb">Like</span></a></td><td class="bc bs bt" style="width:33%"><a class="bu bv bw bx" href="#composer-2207188762637504"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="by bz ca l" /><span class="cb">Comment</span></a></td><td class="bc bs cc bt" style="width:33%"><a class="bu bv bw bx" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=2207188762637504&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D2207188762637504%26id%3D146505212039213%26bacr%3D1456990091%253A1456990091%253A1%253A3446187331056436874%253A1456989900%253A0%253A0%253A38%26refid%3D8%26_ft_%3Dqid.6257724792419079008%253Amf_story_key.3446187331056436874&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="by bz ca l" /><span class="cb">Share</span></a></td></tr></tbody></table></div><div class="w cd ce cf">60 people like this.</div><div class="cg ch" id="composer-2207188762637504"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=1&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=2207188762637504&amp;gfid=AQCO3YhjVmTxO9ol&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874&amp;av=100009543463363&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQG9ecpW2RDT:AQGK_1r5gTy5" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ci" for="u_0_0">Write a comment...</label><table class="y z" id="u_0_0"><tbody><tr><td class="bc"><div class="cj ck"><table class="y cl cm"><tbody><tr><td class="bc cn br"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="ba"><div class="cs"><input value="Comment" type="submit" class="bv ct cu cv" /></div></td></tr></tbody></table><span class="cw bh bi"><a href="/mbasic/comment/advanced/?target_id=2207188762637504&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D2207188762637504%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D2207188762637504%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6257724792419079008%3Amf_story_key.3446187331056436874">Mention Friends</a></span></form></div><div id="add_comment_link_placeholder"></div></div></div></div></div></div></div></div></body></html>'
			let expectedPost = {
				media: [
					new Media({
						imageUrl: 'https://scontent-lhr3-1.xx.fbcdn.net/hphotos-xat1/v/t1.0-9/12821352_2207187815970932_1123565561842989891_n.jpg?oh=af2e7699ce3843590fdec277695a385b&oe=575B6C74',
						mimeType: 'image/jpeg',
						srcUrl: 'https://scontent-lhr3-1.xx.fbcdn.net/hphotos-xat1/v/t1.0-9/12821352_2207187815970932_1123565561842989891_n.jpg?oh=af2e7699ce3843590fdec277695a385b&oe=575B6C74',
						type: 'photo'
					})
				]
			}
			doTest(done, html, expectedPost)
		});
	});

	describe('Reshared posts testing', function() {

		it('reshared photo from multiple photoes', function(done) {
			let html = "<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comments</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"l\"><div class=\"m n\" id=\"u_0_0\"><div><div><h3 class=\"o p\"><strong><a href=\"/EndTheWoo/?refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&amp;__tn__=C\">Stop the Anti-Science Movement</a></strong> shared <a href=\"/therealcrediblehulk/?refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&amp;__tn__=C\">The Credible Hulk</a>&#039;s <a href=\"/therealcrediblehulk/photos/a.892787380752581.1073741828.892778157420170/1102056659825651/?type=3&amp;refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&amp;__tn__=C\">photo</a>.</h3></div><div class=\"q\"><p>Via<a href=\"/therealcrediblehulk/?refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&amp;__tn__=%2As\">Credible Hulk</a>, and originally from the Useless, Unsuccesful, and/or Unpopular Memes group.</p></div><div class=\"r\"><div class=\"s t m u\" id=\"u_0_1\"><div><h3 class=\"o v\"><a href=\"/therealcrediblehulk/?refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&amp;__tn__=C\">The Credible Hulk</a></h3><div class=\"q\"><p>One of the perks of having a liver. <br /> I have no idea who made this. Otherwise I&#039;d tag their page for credit.</p><p> EDIT: This apparently first appeared in the group, Useless, Unsuccessful, and/or Unpopular Memes.</p></div><div class=\"r\"><div class=\"w x\"><a class=\"y z ba\" href=\"/therealcrediblehulk/photos/a.892787380752581.1073741828.892778157420170/1102056659825651/?type=3&amp;refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&amp;__tn__=E\"><img src=\"https://scontent.fper2-1.fna.fbcdn.net/hphotos-xpt1/v/t1.0-0/cp0/e15/q65/p200x200/12647377_1102056659825651_8320142660827209790_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=d276becb0ab65d2ec3484f3e1102038b&amp;oe=57355E84\" width=\"200\" height=\"200\" class=\"k\" /></a></div></div></div></div></div></div><div class=\"bb\"><div class=\"bc bd\"><abbr>23 mins</abbr><span aria-hidden=\"true\"> · </span><span class=\"be\"><span><span class=\"bc\">Public</span></span></span></div><div class=\"bc bd\"><span aria-hidden=\"true\"> · </span><a class=\"bf\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQ3MDM3NrEwM7KwtLQwMqlzzSsJzkgsSnUuSk0syczPCy7JL6qsqzM0MTAytDA0MjYA0abmdXUGdQA%22%2C%22story_permalink_token%22%3A%22S%3A_I1402181230021857%3A1706734862899824%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706734862899824%26id%3D1402181230021857%26refid%3D17%26_ft_%3Dtop_level_post_id.1706734862899824%253Atl_objid.1706734862899824%253Athid.1402181230021857%253A306061129499414%253A3%253A0%253A1456819199%253A2100071402277425483&amp;refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857\">More</a></div></div></div></div><div class=\"e bg\" id=\"ufi_1706734862899824\"><div class=\"bh bi\"><div class=\"bj bk bl\"><table class=\"bm bn\"><tbody><tr><td class=\"bo bp bq\" style=\"width:33%\"><a class=\"br bs bt bu\" href=\"/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1706734862899824&amp;av=100009834785112&amp;gfid=AQAZK73K56eLr2dR&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png\" width=\"16\" height=\"16\" class=\"bv bw bx k\" /><span class=\"by\">Like</span></a></td><td class=\"bo bp bq\" style=\"width:33%\"><a class=\"br bs bt bu\" href=\"#composer-1706734862899824\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\" width=\"16\" height=\"16\" class=\"bv bw bx k\" /><span class=\"by\">Comment</span></a></td><td class=\"bo bp bz bq\" style=\"width:33%\"><a class=\"br bs bt bu\" href=\"/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=1706734862899824&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706734862899824%26id%3D1402181230021857%26refid%3D17%26_ft_%3Dtop_level_post_id.1706734862899824%253Atl_objid.1706734862899824%253Athid.1402181230021857%253A306061129499414%253A3%253A0%253A1456819199%253A2100071402277425483&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png\" width=\"16\" height=\"16\" class=\"bv bw bx k\" /><span class=\"by\">Share</span></a></td></tr></tbody></table></div><div class=\"ca cb cc cd\"><a href=\"/1706734862899824/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1706734862899824%26id%3D1402181230021857%26refid%3D17%26_ft_%3Dtop_level_post_id.1706734862899824%253Atl_objid.1706734862899824%253Athid.1402181230021857%253A306061129499414%253A3%253A0%253A1456819199%253A2100071402277425483&amp;refid=52&amp;_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857\">67 people</a> like this.</div></div></div></div></div></div></div></div></body></html>";

			let parsed = {
				message: "Via Credible Hulk, and originally from the Useless, Unsuccesful, and/or Unpopular Memes group.",
				resharedPhoto: '/therealcrediblehulk/photos/a.892787380752581.1073741828.892778157420170/1102056659825651/?type=3&refid=52&_ft_=top_level_post_id.1706734862899824%3Atl_objid.1706734862899824%3Athid.1402181230021857&__tn__=E',
				type: 'photo'
			};

			doTest(done, html, parsed);
		});

		it('reshared photo...', function(done) {
			let html = "<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comments</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div class=\"g\"><h1 class=\"h\" id=\"header\"><a class=\"i\" href=\"/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png\" width=\"77\" height=\"16\" class=\"j k\" alt=\"facebook\" /></a></h1></div><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"l\"><div class=\"m n\" id=\"u_0_1\"><div><div><h3 class=\"o p\"><strong><a href=\"/PerthCity/?refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;__tn__=C\">Perth City</a></strong> shared <a href=\"/CityofPerthWA/?refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;__tn__=C\">City of Perth</a>&#039;s <a href=\"/CityofPerthWA/photos/a.257034867711305.61840.109067629174697/955794267835358/?type=3&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;__tn__=C\">photo</a>.</h3></div><div class=\"q\"><div class=\"r s m t\" id=\"u_0_2\"><div><h3 class=\"o u\"><a href=\"/CityofPerthWA/?refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;__tn__=C\">City of Perth</a></h3><div class=\"v\"><p>The new City of Perth Library is opening on Tuesday the 1st of March this year! <a class=\"_5ayv\" href=\"/hashtag/perthlibrary?refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;__tn__=%2As\"><span class=\"_5aw4\">‪#‎</span><span class=\"_5ayu\">PerthLibrary‬</span></a></p></div><div class=\"q\"><div class=\"w x\"><a class=\"y z ba\" href=\"/CityofPerthWA/photos/a.257034867711305.61840.109067629174697/955794267835358/?type=3&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;__tn__=E\"><img src=\"https://scontent.fper1-1.fna.fbcdn.net/hphotos-xta1/v/t1.0-0/cp0/e15/q65/s240x240/12651351_955794267835358_5154988604450715575_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=a7d22a240bf7098d07875fb2b9f50144&amp;oe=572897C2\" width=\"240\" height=\"159\" class=\"k\" /></a></div></div></div></div></div></div><div class=\"bb\"><div class=\"bc bd\"><abbr>5 hrs</abbr><span aria-hidden=\"true\"> · </span><span class=\"be\"><span><span class=\"bc\">Public</span></span></span></div><div class=\"bc bd\"><span aria-hidden=\"true\"> · </span><a class=\"bf\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22szSzMDYyMTS0tDS0NDSwrHPNKwnOSCxKdS5KTSzJzM8LLskvqqyrMzQ0tzSxMLIwsTQ1MzcwrKszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I117948284956701%3A968324119919109%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D968324119919109%26id%3D117948284956701%26bacr%3D1454655370%253A1454655370%253A1%253A-6252262325224337115%253A1454635037%253A0%253A0%253A3%26refid%3D28%26_ft_%3Dqid.6247699041746947630%253Amf_story_key.-9153767561298823559&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559\">More</a></div></div></div></div><div class=\"e bg\" id=\"ufi_968324119919109\"><div class=\"bh bi\"><div class=\"bj bk bl\"><table class=\"bm bn\"><tbody><tr><td class=\"bo bp bq\" style=\"width:33%\"><a class=\"br bs bt bu\" href=\"/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=968324119919109&amp;av=100009834785112&amp;gfid=AQDB6PLYtcba6W_m&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png\" width=\"16\" height=\"16\" class=\"bv bw bx k\" /><span class=\"by\">Like</span></a></td><td class=\"bo bp bq\" style=\"width:33%\"><a class=\"br bs bt bu\" href=\"#composer-968324119919109\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\" width=\"16\" height=\"16\" class=\"bv bw bx k\" /><span class=\"by\">Comment</span></a></td><td class=\"bo bp bz bq\" style=\"width:33%\"><a class=\"br bs bt bu\" href=\"/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=968324119919109&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D968324119919109%26id%3D117948284956701%26bacr%3D1454655370%253A1454655370%253A1%253A-6252262325224337115%253A1454635037%253A0%253A0%253A3%26refid%3D28%26_ft_%3Dqid.6247699041746947630%253Amf_story_key.-9153767561298823559&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png\" width=\"16\" height=\"16\" class=\"bv bw bx k\" /><span class=\"by\">Share</span></a></td></tr></tbody></table></div><div class=\"ca cb cc cd\"><a href=\"/968324119919109/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D968324119919109%26id%3D117948284956701%26bacr%3D1454655370%253A1454655370%253A1%253A-6252262325224337115%253A1454635037%253A0%253A0%253A3%26refid%3D28%26_ft_%3Dqid.6247699041746947630%253Amf_story_key.-9153767561298823559&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559\">119 people</a> like this.</div><div class=\"ce cf\" id=\"composer-968324119919109\"><form method=\"post\" action=\"/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=968324119919109&amp;gfid=AQBKAeAu81ONJ3eq&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&amp;av=100009834785112&amp;refid=52\"><input type=\"hidden\" name=\"fb_dtsg\" value=\"AQEkGNARHLdB:AQGi742HrSHN\" autocomplete=\"off\" /><input type=\"hidden\" name=\"charset_test\" value=\"&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;\" /><label class=\"cg\" for=\"u_0_0\">Write a comment...</label><table class=\"bm ch\" id=\"u_0_0\"><tbody><tr><td class=\"bo\"><div class=\"ci cj\"><table class=\"bm ck cl\"><tbody><tr><td class=\"bo cm bn\"><input class=\"cn co cp cq\" id=\"composerInput\" name=\"comment_text\" type=\"text\" /></td></tr></tbody></table></div></td><td class=\"cr\"><div class=\"cs\"><input value=\"Comment\" type=\"submit\" class=\"bs ct cu cv\" /></div></td></tr></tbody></table><span class=\"cw bc bd\"><a href=\"/mbasic/comment/advanced/?target_id=968324119919109&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559\">Attach a Photo</a><span aria-hidden=\"true\"> · </span><a href=\"/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D968324119919109%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D968324119919109%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559\">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>";

			let parsed = {
				message: 'The new City of Perth Library is opening on Tuesday the 1st of March this year! #PerthLibrary',
				resharedPhoto: '/CityofPerthWA/photos/a.257034867711305.61840.109067629174697/955794267835358/?type=3&refid=52&_ft_=qid.6247699041746947630%3Amf_story_key.-9153767561298823559&__tn__=E',
				type: 'photo'
			};

			doTest(done, html, parsed);
		});

		it('story generated from own photoes...', function(done) {
			let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comments</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div class=\"g\"><h1 class=\"h\" id=\"header\"><a class=\"i\" href=\"/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png\" width=\"77\" height=\"16\" class=\"j img\" alt=\"facebook\" /></a></h1></div><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"k\"><div class=\"l m\" id=\"u_0_2\"><div><div><h3 class=\"n o\"><a href=\"/paulbrown.drafting?refid=52&amp;_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308&amp;__tn__=C\"><strong><a href=\"/paulbrown.drafting?fref=nf&amp;refid=52&amp;_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308&amp;__tn__=C\">Paul Brown</a></strong></a></h3></div><div class=\"p\"><div class=\"q r\"><a class=\"s t u\" href=\"/photo.php?fbid=1684238775124489&amp;id=100006151475998&amp;set=a.1376787369202966.1073741824.100006151475998&amp;refid=52&amp;_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308&amp;__tn__=E\"><img src=\"https://scontent.fper2-1.fna.fbcdn.net/hphotos-xlt1/v/t1.0-0/cp0/e15/q65/p200x200/12742320_1684238775124489_1316147695492051587_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=76b6d0b9630055d714f764aa1feac3b2&amp;oe=572D7011\" width=\"200\" height=\"200\" class=\"img\" /></a></div></div></div><div class=\"v\"><div class=\"w x\"><abbr>3 hrs</abbr><span aria-hidden=\"true\"> · </span><span class=\"y\"><span><span class=\"w\">Friends</span></span></span></div><div class=\"w x\"><a class=\"z\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzSzMDEytrAwsDAxNbcwtKxzzSsJLkksKS12LkpNLMnMzwsuyS-qrKszNAACM0NTQxNzU0tLi7o6gzoA%22%2C%22story_permalink_token%22%3A%22S%3A_I100006151475998%3A1684238808457819%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1684238808457819%26id%3D100006151475998%26bacr%3D1455254898%253A1455254898%253A3%253A-5447159100613485906%253A1455250566%253A0%253A0%253A60%26refid%3D7%26_ft_%3Dqid.6250272500057654532%253Amf_story_key.-7437218492307841308&amp;refid=52&amp;_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308\">More</a></div></div></div></div><div class=\"e ba\" id=\"ufi_1684238808457819\"><div class=\"bb bc\"><div class=\"bd be bf\"><table class=\"bg bh\"><tbody><tr><td class=\"bi bj bk\" style=\"width:33%\"><a class=\"bl bm bn bo\" href=\"/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1684238808457819&amp;av=100009834785112&amp;gfid=AQDEkd_rbtMsO002&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png\" width=\"16\" height=\"16\" class=\"bp bq br img\" /><span class=\"bs\">Like</span></a></td><td class=\"bi bj bk\" style=\"width:33%\"><a class=\"bl bm bn bo\" href=\"#composer-1684238808457819\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\" width=\"16\" height=\"16\" class=\"bp bq br img\" /><span class=\"bs\">Comment</span></a></td><td class=\"bi bj bt bk\" style=\"width:33%\"><a class=\"bl bm bn bo\" href=\"/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=1684238808457819&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1684238808457819%26id%3D100006151475998%26bacr%3D1455254898%253A1455254898%253A3%253A-5447159100613485906%253A1455250566%253A0%253A0%253A60%26refid%3D7%26_ft_%3Dqid.6250272500057654532%253Amf_story_key.-7437218492307841308&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png\" width=\"16\" height=\"16\" class=\"bp bq br img\" /><span class=\"bs\">Share</span></a></td></tr></tbody></table></div></div></div></div></div></div></div></div></body></html>';
			let expected = {
				resharedPhoto: '/photo.php?fbid=1684238775124489&id=100006151475998&set=a.1376787369202966.1073741824.100006151475998&refid=52&_ft_=qid.6250272500057654532%3Amf_story_key.-7437218492307841308&__tn__=E',
				type: 'photo'
			};

			doTest(done, html, expected);
		});

		it('reshared Instagram image should not have share text appended... ', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header" role="banner"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="j img" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/y8/r/k97pj8-or6s.png" width="77"/></a></h1></div><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_2"><div><div><div class="n o"><a class="p" href="/edit/post/dialog/?cid=S%3A_I100009543463363%3A1717115765283189&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D1717115765283189%26id%3D100009543463363%26refid%3D17%26_ft_%3Dtop_level_post_id.1717115765283189%253Atl_objid.1717115765283189%253Athid.100009543463363%253A306061129499414%253A2%253A0%253A1483257599%253A-5571514212372509227&amp;perm&amp;loc=permalink&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Edit</a><span aria-hidden="true">· </span><a class="p" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100009543463363%3A1717115765283189&amp;continue=%2Fstories.php%23s_f08a2fe91cd2076fe6420e88a684f1bc&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Delete</a></div><h3 class="q r"><span><strong><a href="/teest.devisd?fref=nf&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=C">Teest Devisd</a></strong></span></h3></div><div class="s" style=""><p><span class="_5mfr _47e3"><img alt="" aria-hidden="1" class="img" height="16" src="https://static.xx.fbcdn.net/images/emoji.php/v6/f60/1/16/1f51d.png" width="16"/></span>Goals from Walcott, Ozil &amp; Iwobi send <a class="_5ayv _qdx" href="/hashtag/arsenal?refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">Arsenal</span></a>to the top of the <a class="_5ayv _qdx" href="/hashtag/pl?refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">PL</span></a>tree <a class="_5ayv _qdx" href="/hashtag/arsstk?refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">ARSSTK</span></a><a href="https://m.facebook.com/l.php?u=https%3A%2F%2Fscontent-syd2-1.cdninstagram.com%2Ft51.2885-15%2Fs320x320%2Fe35%2F15258932_203493920110604_616485410800926720_n.jpg%3Fig_cache_key%3DMTQwMjMyMjI2ODc4NTAwNjg3OA%253D%253D.2&amp;h=zAQHRCj6V&amp;enc=AZM0KsoONXeTNb6vfrddnjaZYwpSjP4MPbrF476Il8sJ5U-hnXxOVIPYbDtZz21wahrjTZc0PKVvGRsrtnMipKyIlsKtaL4sAhR3WuBGRQ1uvCW8Ojwc208eHVoAtNrJeLGlyCQOPF1r_PfYrO4yGHlQehnd_UdWdq5PkYQbVrAPYng24I56YUTStPTFoZHOGoS36E2wgpQCosGgEwIuc42sjzAf-libkyMuWplPVQ62rtnm1BeOwYuLlgoZpEPzFNYl6r5rcSXBjJ6mp04rY4nKt_Mloln82m31HjwWSQRIW_0PdCxa8H40uyylq6DndAQ&amp;s=1" target="_blank"><span>https://</span><wbr/><span class="word_break"/><span>scontent-syd2-1.</span><wbr/><span class="word_break"/><span>cdninstagram.co</span><wbr/><span class="word_break"/><span>m/t51.2885-15/</span><wbr/><span class="word_break"/><span>s320x320/e35/</span><wbr/><span class="word_break"/><span>15258932_2034939</span><wbr/><span class="word_break"/><span>20110604_616485</span><wbr/><span class="word_break"/><span>410800926720_n.</span><wbr/><span class="word_break"/><span>jpg?ig_cache_ke</span><wbr/><span class="word_break"/><span>y=MTQwMjMyMjI2O</span><wbr/><span class="word_break"/><span>Dc4NTAwNjg3OA%3</span><wbr/><span class="word_break"/>D%3D.2</a></p><p>Status updated with Social Stream<br/><a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fmysocialstream.com%2Ffind-out-more&amp;h=9AQG5W9O4&amp;enc=AZPXMx-7HFh2WsW8UesPPyFQNKt6eZgnD4hsyu_fGNMb2b9-N2qRyX6bAuTJzh6TcQR--l6GbmRTiNbNFijajHZiPTJAFHzvj6_RqDy40zEGRhYABZ3-Oocg6SDzwbSts2tquWHkgyZDk6aN0NhNH1F5IcS8Y7MhKI-JGdOvpoFDeQNUX_QJ6j4M2fgPt1sNMqKwhDQxu8DiKPLCyz72InsGJPRqwKXboysj7uY-u6bYEbFE68NSSr0D3ds55x1tv0qkdGfqbrOy-cTS6U4nojh7LCW4DEbp0A3PQ4hk3QmKz9ana4nkSAPnhTx0i0ZmMt4&amp;s=1" target="_blank"><span>http://</span><wbr/><span class="word_break"/><span>mysocialstream.c</span><wbr/><span class="word_break"/><span>om/</span><wbr/><span class="word_break"/>find-out-more</a></p></div></div><div class="t"><div class="n o"><abbr>12 hrs</abbr><span aria-hidden="true">· </span><span class="u"><div><span class="n">Privacy:</span><span class="n"><a href="/privacyx/selector/?redir=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1717115765283189%26id%3D100009543463363%26refid%3D17%26_ft_%3Dtop_level_post_id.1717115765283189%253Atl_objid.1717115765283189%253Athid.100009543463363%253A306061129499414%253A2%253A0%253A1483257599%253A-5571514212372509227&amp;ci=1717115765283189&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQB6RVP-uKNcpii_&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Public</a></span><input name="privacy[1717115765283189]" type="hidden" value="300645083384735"/></div></span></div><div class="n o"><a class="p" href="/composer/mbasic/?c_src=feed_story&amp;referrer=feed_story&amp;target=100009543463363&amp;story_id=1717115765283189&amp;ctype=inline&amp;cwevent=composer_entry&amp;av=100009543463363&amp;icv=lgc_view_photo&amp;lgc_view_photo&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Add Photos</a><span aria-hidden="true">· </span><a href="/save/story/basic/?story_id=S%3A_I100009543463363%3A1717115765283189&amp;action=SAVE&amp;surface=mbasic_story&amp;mechanism=ufi_action_link&amp;ext=1481765027&amp;hash=AeRYtLhBnUfQAZlX&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Save</a><span aria-hidden="true">· </span><a class="p" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzQ3NDc0NDU3MzWyMDa0sKxzzSsJLkksKS12LkpNLMnMzwsuyS-qrKszNAACS1MTYxMzY2Mz47o6gzoA%22%2C%22story_permalink_token%22%3A%22S%3A_I100009543463363%3A1717115765283189%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1717115765283189%26id%3D100009543463363%26refid%3D17%26_ft_%3Dtop_level_post_id.1717115765283189%253Atl_objid.1717115765283189%253Athid.100009543463363%253A306061129499414%253A2%253A0%253A1483257599%253A-5571514212372509227&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">More</a></div></div></div></div><div class="e v" id="ufi_1717115765283189"><div class="w x"><div class="y z ba bb"><table class="bc bd" role="presentation"><tbody><tr><td class="be bf bg" style="width:25%"><a aria-pressed="false" class="bh bi bj bk" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1717115765283189&amp;av=100009543463363&amp;gfid=AQDrYERU2PlfC_PB&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363" role="button"><img aria-hidden="true" class="bl bm bn img" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yy/r/P2H0Ng8Ff2w.png" width="16"/><span class="bo">Like</span></a></td><td class="be bf bg" style="width:25%"><a aria-pressed="false" class="bh bi bj bk" href="/reactions/picker/?ft_id=1717115765283189&amp;origin_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1717115765283189%26id%3D100009543463363%26refid%3D17%26_ft_%3Dtop_level_post_id.1717115765283189%253Atl_objid.1717115765283189%253Athid.100009543463363%253A306061129499414%253A2%253A0%253A1483257599%253A-5571514212372509227&amp;av=100009543463363&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;refid=52" role="button"><img aria-hidden="true" class="bl bm img" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yZ/r/wCftkR_lm8T.png" width="16"/><span class="bo">React</span></a></td><td class="be bf bg" style="width:25%"><a class="bh bi bj bk" href="#composer-1717115765283189"><img aria-hidden="true" class="bl bm bn img" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yw/r/ks_T7R1PM8o.png" width="16"/><span class="bo">Comment</span></a></td><td class="be bf bp bg" style="width:25%"><a class="bh bi bj bk" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1717115765283189&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D1717115765283189%26id%3D100009543463363%26refid%3D17%26_ft_%3Dtop_level_post_id.1717115765283189%253Atl_objid.1717115765283189%253Athid.100009543463363%253A306061129499414%253A2%253A0%253A1483257599%253A-5571514212372509227&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363"><img aria-hidden="true" class="bl bm bn img" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yP/r/_ByufLrUwa0.png" width="16"/><span class="bo">Share</span></a></td></tr></tbody></table></div><div class="bq br"><a class="bs" href="/ufi/reaction/profile/browser/?ft_ent_identifier=1717115765283189&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363"><div/></a></div><div class="w"><div class="bt" id="1717115775283188"><div><h3><a class="bu" href="/teest.devisd?refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=R">Teest Devisd</a></h3><div>Boo</div><div class="bv bw bx"><span class="by"><span class="bz o"><a href="/a/comment.php?like_comment_id=1717115775283188&amp;snowflake&amp;ft_ent_identifier=1717115765283189&amp;gfid=AQC_U8fPmWkrZjO6&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=R">Like</a></span></span><span aria-hidden="true">· </span><a href="/comment/replies/?ctoken=1717115765283189_1717115775283188&amp;actor_id=100009543463363&amp;ft_ent_identifier=1717115765283189&amp;gfid=AQBVt3lyAwWMD5ib&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=R#comment_form_100009543463363_1717115765283189_reply_1717115765283189_1717115775283188">Reply</a><span aria-hidden="true">· </span><a href="/mbasic/comment/advanced/?target_id=1717115765283189&amp;at=edit&amp;ctoken=1717115765283189_1717115775283188&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;__tn__=R">Edit</a><span aria-hidden="true">· </span><abbr>Yesterday at 20:37</abbr></div></div></div></div><div class="w ca" id="u_0_0"/><div class="cb cc" id="composer-1717115765283189"><form action="/a/comment.php?fs=8&amp;fr=%2Fprofile.php&amp;actionsource=13&amp;comment_logging&amp;ft_ent_identifier=1717115765283189&amp;gfid=AQAZC43e6Ehb3Hmy&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363&amp;av=100009543463363&amp;refid=52" method="post"><input autocomplete="off" name="fb_dtsg" type="hidden" value="AQGnMZKL_OYc:AQGeE4k40rGc"/><label class="cd" for="u_0_1">Write a comment...</label><table class="bc bd" id="u_0_1" role="presentation"><tbody><tr><td class="be"><div class="ce cf"><table class="bc cg ch" role="presentation"><tbody><tr><td class="be ci cj"><input class="ck cl cm cn" id="composerInput" name="comment_text" type="text"/></td></tr></tbody></table></div></td><td class="co"><div class="cp"><input class="bi cq cr cs" type="submit" value="Comment"/></div></td></tr></tbody></table><span class="ct n o"><a href="/mbasic/comment/advanced/?target_id=1717115765283189&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Attach a Photo</a><span aria-hidden="true">· </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1717115765283189%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1717115765283189%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=top_level_post_id.1717115765283189%3Atl_objid.1717115765283189%3Athid.100009543463363">Mention Friends</a></span></form></div></div></div></div><div/></div></div></div></div></body></html>';
			let expected = {
				media: [{
					imageUrl: 'https://scontent-syd2-1.cdninstagram.com/t51.2885-15/s320x320/e35/15258932_203493920110604_616485410800926720_n.jpg'
				}],
				message: 'Goals from Walcott, Ozil & Iwobi send #Arsenal to the top of the #PL tree #ARSSTK',
				type: 'photo'
			}

			doTest(done, html, expected);
		});

		it('reshared Instagram video should be a video...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header" role="banner"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="j k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/y8/r/k97pj8-or6s.png" width="77"/></a></h1></div><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_2"><div><div><div class="o p"><a class="q" href="/edit/post/dialog/?cid=S%3A_I100009834785112%3A375486636122493&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D375486636122493%26id%3D100009834785112%26refid%3D7&amp;perm&amp;loc=permalink&amp;refid=52">Edit</a><span aria-hidden="true">· </span><a class="q" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100009834785112%3A375486636122493&amp;continue=%2Fstories.php%23s_59694b76d1899f0db5de6cab1052aaf8&amp;refid=52">Delete</a></div><h3 class="r s"><span><strong><a href="/profile.php?fref=nf&amp;refid=52&amp;__tn__=C">Skooter Martin</a></strong></span></h3></div><div class="t" style=""><p><a href="https://instagram.fper1-1.fna.fbcdn.net/t50.2886-16/15502011_343634922671328_2901688185874546688_n.mp4"><span>https://</span><wbr/><span class="word_break"/><span>instagram.fper1-</span><wbr/><span class="word_break"/><span>1.fna.fbcdn.net</span><wbr/><span class="word_break"/><span>/t50.2886-16/</span><wbr/><span class="word_break"/><span>15502011_3436349</span><wbr/><span class="word_break"/><span>22671328_290168</span><wbr/><span class="word_break"/><span>8185874546688_n</span><wbr/><span class="word_break"/>.mp4</a></p><p>Status updated with Social Stream<br/><a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fmysocialstream.com%2Ffind-out-more&amp;h=CAQGrmOiB&amp;enc=AZOUfpWqHTuFLManA4kyS1er6MutQGSjW_cVbOMDAd11eapUaBqyt5tGvqV-ibOrW8RzhBV7Ufi0ahdtc2DdfPWpQA9Q9omPj-uHxZQq4ylbVk7CgAccn31r9jhaQvZm6vbYG7dMiRPDoe8udY6G2upy8a-w1r1ojQH0UrQckwKHhdc3yIT1GhtTvo7PbhTSsLM&amp;s=1" target="_blank"><span>http://</span><wbr/><span class="word_break"/><span>mysocialstream.c</span><wbr/><span class="word_break"/><span>om/</span><wbr/><span class="word_break"/>find-out-more</a></p></div><div class="u v"/></div><div class="w"><div class="o p"><abbr>1 min</abbr><span aria-hidden="true">· </span><span class="x"><div><span class="o">Privacy:</span><span class="o"><a href="/privacyx/selector/?redir=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375486636122493%26id%3D100009834785112%26refid%3D7&amp;ci=375486636122493&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQA9qC05W0tAx9LC&amp;refid=52">Public</a></span><input name="privacy[375486636122493]" type="hidden" value="300645083384735"/></div></span></div><div class="o p"><a class="q" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzY3NbEwMzM2MzQyMrE0rnPNKwkuSSwpLXYuSk0syczPCy7JL6qsqzM0AAJLC2MTcwtTQ0OjujqDOgA%22%2C%22story_permalink_token%22%3A%22S%3A_I100009834785112%3A375486636122493%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375486636122493%26id%3D100009834785112%26refid%3D7&amp;refid=52">More</a></div></div></div></div><div class="e y" id="ufi_375486636122493"><div class="z ba"><div class="bb bc bd be"><table class="bf bg" role="presentation"><tbody><tr><td class="bh bi bj" style="width:25%"><a aria-pressed="false" class="bk bl bm bn" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=375486636122493&amp;av=100009834785112&amp;gfid=AQDawSCtLHB1b3zR&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52" role="button"><img aria-hidden="true" class="bo bp bq k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yy/r/P2H0Ng8Ff2w.png" width="16"/><span class="br">Like</span></a></td><td class="bh bi bj" style="width:25%"><a aria-pressed="false" class="bk bl bm bn" href="/reactions/picker/?ft_id=375486636122493&amp;origin_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375486636122493%26id%3D100009834785112%26refid%3D7&amp;av=100009834785112&amp;refid=52" role="button"><img aria-hidden="true" class="bo bp k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yZ/r/wCftkR_lm8T.png" width="16"/><span class="br">React</span></a></td><td class="bh bi bj" style="width:25%"><a class="bk bl bm bn" href="#composer-375486636122493"><img aria-hidden="true" class="bo bp bq k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yw/r/ks_T7R1PM8o.png" width="16"/><span class="br">Comment</span></a></td><td class="bh bi bs bj" style="width:25%"><a class="bk bl bm bn" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=375486636122493&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D375486636122493%26id%3D100009834785112%26refid%3D7&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img aria-hidden="true" class="bo bp bq k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yP/r/_ByufLrUwa0.png" width="16"/><span class="br">Share</span></a></td></tr></tbody></table></div><div class="bt bu"><a class="bv" href="/ufi/reaction/profile/browser/?ft_ent_identifier=375486636122493&amp;refid=52"><div/></a></div><div class="z"><div class="bw" id="375486719455818"><div><h3><a class="bx" href="/profile.php?refid=52&amp;__tn__=R">Skooter Martin</a></h3><div>Here be video!</div><div class="by bz ca"><span class="cb"><span class="cc p"><a href="/a/comment.php?like_comment_id=375486719455818&amp;snowflake&amp;ft_ent_identifier=375486636122493&amp;gfid=AQCmr23r2t95s71n&amp;refid=52&amp;__tn__=R">Like</a></span></span><span aria-hidden="true">· </span><a href="/comment/replies/?ctoken=375486636122493_375486719455818&amp;actor_id=100009834785112&amp;ft_ent_identifier=375486636122493&amp;gfid=AQBGto3WMI7ppdp2&amp;refid=52&amp;__tn__=R#comment_form_100009834785112_375486636122493_reply_375486636122493_375486719455818">Reply</a><span aria-hidden="true">· </span><a href="/mbasic/comment/advanced/?target_id=375486636122493&amp;at=edit&amp;ctoken=375486636122493_375486719455818&amp;refid=52&amp;__tn__=R">Edit</a><span aria-hidden="true">· </span><abbr>Just now</abbr></div></div></div></div><div class="z cd" id="u_0_0"/><div class="ce cf" id="composer-375486636122493"><form action="/a/comment.php?fs=8&amp;fr=%2Fhome%2F&amp;actionsource=1&amp;comment_logging&amp;ft_ent_identifier=375486636122493&amp;gfid=AQAGmSyT1rz5is6_&amp;av=100009834785112&amp;refid=52" method="post"><input autocomplete="off" name="fb_dtsg" type="hidden" value="AQHCIRobA_wm:AQGPEAZe4X1E"/><label class="cg" for="u_0_1">Write a comment...</label><table class="bf bg" id="u_0_1" role="presentation"><tbody><tr><td class="bh"><div class="ch ci"><table class="bf cj ck" role="presentation"><tbody><tr><td class="bh cl cm"><input class="cn co cp cq" id="composerInput" name="comment_text" type="text"/></td></tr></tbody></table></div></td><td class="cr"><div class="cs"><input class="bl ct cu cv" type="submit" value="Comment"/></div></td></tr></tbody></table><span class="cw o p"><a href="/mbasic/comment/advanced/?target_id=375486636122493&amp;pap=1&amp;at=compose&amp;refid=52">Attach a Photo</a><span aria-hidden="true">· </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D375486636122493%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D375486636122493%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52">Mention Friends</a></span></form></div></div></div></div><div/></div></div></div></div></body></html>';
			let expected = {
				media: [{
					srcUrl: 'https://instagram.fper1-1.fna.fbcdn.net/t50.2886-16/15502011_343634922671328_2901688185874546688_n.mp4',
				}],
				message: '',
				type: 'video'
			};

			doTest(done, html, expected);
		});

		it('reshared Instagram video with Jamie Oliver waffling should not have source link appended...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header" role="banner"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="j k" height="15" src="https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/5Zo8s-IGqA1.png" width="77"/></a></h1></div><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_2"><div><div><div class="o p"><a class="q" href="/edit/post/dialog/?cid=S%3A_I100011376849188%3A427323277656897&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D427323277656897%26id%3D100011376849188%26bacr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363410189507835893%26refid%3D8%26_ft_%3Dqid.6363410189507835893%253Amf_story_key.2318027179308458476%253Atop_level_post_id.427323277656897&amp;perm&amp;loc=permalink&amp;refid=52&amp;_ft_=qid.6363410189507835893%3Amf_story_key.2318027179308458476%3Atop_level_post_id.427323277656897">Edit</a><span aria-hidden="true">· </span><a class="q" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100011376849188%3A427323277656897&amp;continue=%2Fstories.php%3Faftercursorr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363410189507835893%23s_7322ceaca8dcde89b5a2284957e94773&amp;refid=52&amp;_ft_=qid.6363410189507835893%3Amf_story_key.2318027179308458476%3Atop_level_post_id.427323277656897">Delete</a></div><h3 class="r s"><span><strong><a href="/feest.devisd?fref=nf&amp;refid=52&amp;_ft_=qid.6363410189507835893%3Amf_story_key.2318027179308458476%3Atop_level_post_id.427323277656897&amp;__tn__=C">Feest Devisd</a></strong></span></h3></div><div class="t" style=""><p>The humble red cabbage but not as you know it guys!!! Out in my new Christmas book <a class="_5ayv _qdx" href="/hashtag/jamieschristmas?refid=52&amp;_ft_=qid.6363410189507835893%3Amf_story_key.2318027179308458476%3Atop_level_post_id.427323277656897&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">JamiesChristmas</span></a><span>link in my bio or watch the recipe over on @JamiesFoodTube</span><wbr/><span class="word_break"/>it’s a corker x x x x  <a href="https://instagram.fper1-1.fna.fbcdn.net/t50.2886-16/15441224_1879306018967674_6120133315090448384_n.mp4"><span>https://</span><wbr/><span class="word_break"/><span>instagram.fper1-</span><wbr/><span class="word_break"/><span>1.fna.fbcdn.net</span><wbr/><span class="word_break"/><span>/t50.2886-16/</span><wbr/><span class="word_break"/><span>15441224_1879306</span><wbr/><span class="word_break"/><span>018967674_61201</span><wbr/><span class="word_break"/><span>33315090448384_</span><wbr/><span class="word_break"/>n.mp4</a></p><p>Status updated with Social Stream<br/><a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fmysocialstream.com%2Ffind-out-more&amp;h=kAQE_pydn&amp;enc=AZPLuK2h5oHpCYCCE2sbpV3sS356khwOm_MJ4hib_CROtN1HFxPPBIDVF4fnHlc9DalOv_wPsmjdcc62m4E8qklhjN-9ZtY_YR4PmXe3t6Hpx7pzjgXhyg2205VLDwOy1kiWlNzMscbSnCCh-J2aPRd7v1D9jvy4jqJNv_B9mqC01_sXiMGSFS98zr1e7GW_HH0kObGMLHgUkVP2w17eb8X1VEW7CUOpz-eHQF2nzfp7cu-nTCeM2HVqvKqWfeoUlWYTVmCEBhUhm6olt7xUilu_DKUb-TN_kGB1G4EbMyWhYRWZEyWwuYOoKtvjqueATZE&amp;s=1" target="_blank"><span>http://</span><wbr/><span class="word_break"/><span>mysocialstream.c</span><wbr/><span class="word_break"/><span>om/</span><wbr/><span class="word_break"/>find-out-more</a></p></div><div class="u v"/></div><div class="w"><div class="o p"><abbr>1 hr</abbr><span aria-hidden="true">· </span><span class="x"><div><span class="o">Privacy:</span><span class="o"><a href="/privacyx/selector/?redir=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D427323277656897%26id%3D100011376849188%26bacr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363410189507835893%26refid%3D8%26_ft_%3Dqid.6363410189507835893%253Amf_story_key.2318027179308458476%253Atop_level_post_id.427323277656897&amp;ci=427323277656897&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQBYGa4xHRIDnEv6&amp;refid=52&amp;_ft_=qid.6363410189507835893%3Amf_story_key.2318027179308458476%3Atop_level_post_id.427323277656897">Public</a></span><input name="privacy[427323277656897]" type="hidden" value="300645083384735"/></div></span></div><div class="o p"><a class="q" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzEyNzYyNjI3NzM1s7A0r3PNKwkuSSwpLXYuSk0syczPCy7JL6qsqzM0MDAwNDQ2N7MwsTS0sKirM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I100011376849188%3A427323277656897%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D427323277656897%26id%3D100011376849188%26bacr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363410189507835893%26refid%3D8%26_ft_%3Dqid.6363410189507835893%253Amf_story_key.2318027179308458476%253Atop_level_post_id.427323277656897&amp;refid=52&amp;_ft_=qid.6363410189507835893%3Amf_story_key.2318027179308458476%3Atop_level_post_id.427323277656897">More</a></div></div></div></div></div><div/></div></div></div></div></body></html>';
			let expected = {
				message: 'The humble red cabbage but not as you know it guys!!! Out in my new Christmas book #JamiesChristmas link in my bio or watch the recipe over on @JamiesFoodTube it’s a corker x x x x',
				type: 'video'
			};

			doTest(done, html, expected);
		});

		it('reshared Instagram image with link should only have one image...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header" role="banner"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="j k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/y8/r/k97pj8-or6s.png" width="77"/></a></h1></div><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_2"><div><div><div class="o p"><a class="q" href="/edit/post/dialog/?cid=S%3A_I100011376849188%3A427361237653101&amp;ct=2&amp;nodeID=m_story_permalink_view&amp;redir=%2Fstory.php%3Fstory_fbid%3D427361237653101%26id%3D100011376849188%26bacr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363436101205260440%26refid%3D7%26_ft_%3Dqid.6363436101205260440%253Amf_story_key.-2665004739410748895%253Atop_level_post_id.427361237653101&amp;perm&amp;loc=permalink&amp;refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101">Edit</a><span aria-hidden="true">· </span><a class="q" href="/delete.php?perm&amp;story_permalink_token=S%3A_I100011376849188%3A427361237653101&amp;continue=%2Fstories.php%3Faftercursorr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363436101205260440%23s_efbd5a904fc7f06000d0dfac163ab1f8&amp;refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101">Delete</a></div><h3 class="r s"><span><strong><a href="/feest.devisd?fref=nf&amp;refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=C">Feest Devisd</a></strong></span></h3></div><div class="t" style=""><p>12 DEC: A Husky dog looks on before a sled and skijoring race in the village of Kadnikovo outside Yekaterinburg, Russia. PHOTO:  Maxim Shemetov/ REUTERS <br/><a class="_5ayv _qdx" href="/hashtag/bbcsnapshot?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">BBCSnapshot</span></a><a class="_5ayv _qdx" href="/hashtag/photography?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">photography</span></a><a class="_5ayv _qdx" href="/hashtag/husky?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">husky</span></a><a class="_5ayv _qdx" href="/hashtag/dog?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">dog</span></a><a class="_5ayv _qdx" href="/hashtag/sled?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">sled</span></a><a class="_5ayv _qdx" href="/hashtag/skijoring?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">skijoring</span></a><a class="_5ayv _qdx" href="/hashtag/snow?refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101&amp;__tn__=%2As"><span class="_5aw4 _qdz">#</span><span class="_5ayu">snow</span></a><a href="https://instagram.fper1-1.fna.fbcdn.net/t51.2885-15/s750x750/sh0.08/e35/14592193_694597030708327_6342766131744342016_n.jpg?ig_cache_key=MTQwMzYxNTAzNzQwNjU1MzQ3OA%3D%3D.2"><span>https://</span><wbr/><span class="word_break"/><span>instagram.fper1-</span><wbr/><span class="word_break"/><span>1.fna.fbcdn.net</span><wbr/><span class="word_break"/><span>/t51.2885-15/</span><wbr/><span class="word_break"/><span>s750x750/sh0.08/</span><wbr/><span class="word_break"/><span>e35/</span><wbr/><span class="word_break"/><span>14592193_6945970</span><wbr/><span class="word_break"/><span>30708327_634276</span><wbr/><span class="word_break"/><span>6131744342016_n</span><wbr/><span class="word_break"/><span>.jpg?ig_cache_k</span><wbr/><span class="word_break"/><span>ey=MTQwMzYxNTAz</span><wbr/><span class="word_break"/><span>NzQwNjU1MzQ3OA%</span><wbr/><span class="word_break"/>3D%3D.2</a></p><p>Status updated with Social Stream<br/><a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fmysocialstream.com%2Ffind-out-more&amp;h=FAQHnHSuV&amp;enc=AZMR71lz1UFIVM92JaNBPe_SsBG7e8a2wZUKF4uhfCnsVTdlXpHp6_VQk8Rb_sfOBYU6ON2HzxBrw6RAXFTr53H04gAe-whKrxqKx8SOACB5c93F1YYDG-dnQ-uRoGHpqHm7Xj5lxpxUbWCNNPz_0wC8HLOo3bCQTY703W7mgac422xNcx820FvTy76RPZEFPvaqB-JwMy7Yoy-uZQeFofKKRaqpdKOm65HdeD8gx0I7c4eB_baKhIHKoEH9jfBV5CqYCec23cQPCGZx7_6RNPNWED7NRH-9s1c0Phv_77fP7_krmMxiJYTq0gMOj2i8CuY&amp;s=1" target="_blank"><span>http://</span><wbr/><span class="word_break"/><span>mysocialstream.c</span><wbr/><span class="word_break"/><span>om/</span><wbr/><span class="word_break"/>find-out-more</a></p></div><div class="u v"><a class="w x" href="https://instagram.fper1-1.fna.fbcdn.net/t51.2885-15/s750x750/sh0.08/e35/14592193_694597030708327_6342766131744342016_n.jpg?ig_cache_key=MTQwMzYxNTAzNzQwNjU1MzQ3OA%3D%3D.2" id="u_0_3"><div class="e y z"><table class="ba bb" role="presentation"><tbody><tr><td class="bc bd"><img class="k" height="112" role="presentation" src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQD7eU5lL45p2RKn&amp;w=112&amp;h=112&amp;url=https%3A%2F%2Finstagram.fper1-1.fna.fbcdn.net%2Ft51.2885-15%2Fs750x750%2Fsh0.08%2Fe35%2F14592193_694597030708327_6342766131744342016_n.jpg%3Fig_cache_key%3DMTQwMzYxNTAzNzQwNjU1MzQ3OA%253D%253D.2&amp;cfs=1&amp;jq=75&amp;ext=jpg&amp;hash=AQDmnDHL_aZVmhEa" width="112"/></td><td class="be"><h3 class="bf s bg">instagram.fper1-1.fna.fbcdn.net</h3><div class="bf bh">instagram.fper1-1.fna.fbcdn.net<div class="bf"/></div></td></tr></tbody></table></div></a></div></div><div class="bi"><div class="o p"><abbr>1 hr</abbr><span aria-hidden="true">· </span><span class="bj"><div><span class="o">Privacy:</span><span class="o"><a href="/privacyx/selector/?redir=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D427361237653101%26id%3D100011376849188%26bacr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363436101205260440%26refid%3D7%26_ft_%3Dqid.6363436101205260440%253Amf_story_key.-2665004739410748895%253Atop_level_post_id.427361237653101&amp;ci=427361237653101&amp;ct=4&amp;sel=300645083384735&amp;as=1&amp;gfid=AQCIWiqkXZno1uc_&amp;refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101">Public</a></span><input name="privacy[427361237653101]" type="hidden" value="300645083384735"/></div></span></div><div class="o p"><a class="q" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzEyNzYzNDI2NzM1NjQwrHPNKwkuSSwpLXYuSk0syczPCy7JL6qsqzM0MDAwNAQqszCxNLSwqKszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I100011376849188%3A427361237653101%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D427361237653101%26id%3D100011376849188%26bacr%3D1481596890%253A1481596890%253A1%253A-2665004739410748895%253A1481596864%253A6363436101205260440%26refid%3D7%26_ft_%3Dqid.6363436101205260440%253Amf_story_key.-2665004739410748895%253Atop_level_post_id.427361237653101&amp;refid=52&amp;_ft_=qid.6363436101205260440%3Amf_story_key.-2665004739410748895%3Atop_level_post_id.427361237653101">More</a></div></div></div></div></div><div/></div></div></div></div></body></html>';
			let expected = {
				media:[{
					imageUrl: 'https://instagram.fper1-1.fna.fbcdn.net/t51.2885-15/s750x750/sh0.08/e35/14592193_694597030708327_6342766131744342016_n.jpg?ig_cache_key=MTQwMzYxNTAzNzQwNjU1MzQ3OA%3D%3D.2'
				}],
				message: '12 DEC: A Husky dog looks on before a sled and skijoring race in the village of Kadnikovo outside Yekaterinburg, Russia. PHOTO: Maxim Shemetov/ REUTERS\n#BBCSnapshot #photography #husky #dog #sled #skijoring #snow'
			};

			doTest(done, html, expected);
		});
	});

	describe('Different language posts', function() {

		// Same post content (with different language HTML)
		let doLanguageTest = (done, html, message_time, comment_time, fb_dtsg) => {
			let commentParameters = '&fb_dtsg=' + fb_dtsg + CHARSET_TEST;
			let expectedPost = new Post({
				message: "Look forward to meeting you tomorrow and going for marmite chicken at hawkers",
				likeStatus: Post.LikeStatusNone,
				rawTimestamp: message_time,
				type: 'status',
				media: [],
				comments: [
					new Comment({ id: '10153381626219562', message: 'Likewise Kate. Looks like Henry has told you about our famous meals', rawTimestamp: comment_time, vendor: 'facebook',
						creator: {name: 'Chris De Souza', profileUrl: '/chris.desouza.507?refid=52&_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413'} })
				],
				actions: [
					new Action({ type: 'Share', target: '/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10153381624429562&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413' }),
					new Action({ type: 'Like', target: '/a/like.php?ul&perm&ifab&ft_ent_identifier=10153381624429562&av=550398225&gfid=AQC616j-xU4eNOp5&ref_component=mbasic_photo_permalink_actionbar&ref_page=%2Fwap%2Fstory.php&refid=52&_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413' }),
					new Action({ type: 'Comment', target: '/a/comment.php?fs=8&actionsource=13&redirectosoftpermalink&comment_logging&ft_ent_identifier=10153381624429562&gfid=AQBgoxYcnSemi7J1&_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&av=550398225&refid=52' + commentParameters })
				]
			})
			doTest(done, html, expectedPost)
		}

		it('English (UK)', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="origin-when-crossorigin" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .k{background:#f6f7f8;border:0;font-size:small;margin:0;}.k .r{font-size:x-small;}.l{margin:0 6px 6px;padding:6px;}.b .l .l{border-color:#e9eaed;margin:6px 0 0;}.s{display:inline-block;}.q{margin-top:5px;}.p{margin:5px 0;}.l a,.l a:visited{color:#2b55ad;}.l a:hover,.l a:focus{background:#2b55ad;color:#fff;}.k .l{font-size:small;padding:4px;}.k .q{margin-top:6px;}.k .p{margin:6px 0;}.b .m{background:white;margin:0;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}.bu{color:#9197a3;}.n{color:#4e5665;}.bt{font-size:12px;line-height:16px;}.bv{font-weight:normal;}.o{font-weight:bold;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .t,.b .t:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .t:focus,.b .t:hover{background-color:#3b5998;color:#fff;}.fcg{color:gray;}.r{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.w .bp a{font-weight:bold;}.v>div{border-top:1px solid rgba(0, 0, 0, .101);}.v>.v>div:first-child{border-top:none;}.u,.u .br{background-color:#f6f7f8;color:#141823;}.cg{border-bottom:1px solid #ddd;}.b .cg{padding-bottom:8px;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media screen and (orientation:portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .z{border-color:#ddd;border-width:1px 0 0;}.b .z .bd{background-color:#f6f7f8;}.b .z .bd:hover,.b .z .bd:hover .bh{background-color:#e9eaed;}.b .z .bh{background-color:inherit;}.cf{padding:8px 8px 0;}.ch{color:#141823;display:block;font-size:small;}.b .cf .ck table{border:none;}.b .cf .cq{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cb{padding-top:4px;}.ct{padding-left:4px;}.cx{margin-top:4px;}form{margin:0;border:0;}.b .ba{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .ba tbody,.b .ci>tr>td,.b .ci>tbody>tr>td,.b .ba td.ci{vertical-align:top;}.b .bb>tr>td,.b .bb>tbody>tr>td,.b .ba td.bb{vertical-align:middle;}.b .ba td{padding:0;}.b .ba td.cp{padding:2px;}.b .ba td.bo{padding:4px;}.b .bc{width:100%;}.cm{background:#fff;}.cj .cr{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cj .cl{border:1px solid #9197a3;}.co{border:0;display:block;margin:0;padding:0;}.b .cp{padding:2px;}.b .bo{padding:4px;}.cu{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cu{border-radius:2px;}.cu[disabled] .bk{opacity:.3;}.cw,a.cw,html .b a.cw{color:#fff;}.b .cw{background-color:#4e69a2;border:1px solid #385490;}.b a.cw:hover,.b .cw:hover{background-color:#465e91;}.cw[disabled]{color:#899bc1;}.b .cw[disabled]:hover{background-color:#4e69a2;}.cu .bm{display:inline-block;}.b .cu .bm{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cu::after,.b .cu.bf::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cu .bk{vertical-align:top;}.cu .bm{line-height:20px;margin-top:4px;}.cu .bk.bl{margin-top:6px;}.cu.bf{padding-left:8px;}.cu.bf .bk{margin-right:6px;}.b .cu{padding:0 8px;}.b a.cu{height:26px;line-height:26px;}.b a.cu .bk.bl{margin-top:5px;}.b .cu.bf{padding-left:7px;}.bk,.img.bk{display:inline-block;pointer-events:none;vertical-align:middle;}.bm{pointer-events:none;}.y{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.x .bh,.x .bd{background-color:#fff;}.bd{background-color:#fff;position:relative;}.bd.bd.bd{padding:6px 0;}.bh{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bi,button.bi{width:100%;}.bh{display:block;}.bh{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bd a.bh{color:#4e5665;}.b .bd a.bh:hover,.b .bd a.bh:focus{background:#f2f2f2;color:#4e5665;}.bd:hover,.bd:focus,.bd:hover .bh,.bd:focus .bh{background:#f2f2f2;}.bh{padding:0 4px;}.bd .bh .bj{display:block;margin:0 auto;}.bd .bf.bh .bj{margin:0 auto 1px;}.bd .bm{pointer-events:auto;}.bq{background:#eceff5;font-size:small;padding:8px;}.bq a{font-weight:bold;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.img.ca{margin-right:3px;vertical-align:baseline;}.bz{white-space:nowrap;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_0"><div><div><h3 class="n o"><a href="/k8jerrum?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C"><strong><a href="/k8jerrum?fref=nf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Kate Jerrum</a></strong><span class="fcg"> &gt; </span>‎<strong><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Chris De Souza</a></strong></a></h3></div><div class="p"><p>Look forward to meeting you tomorrow and going for marmite chicken at hawkers <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></p></div></div><div class="q"><div class="r fcg"><abbr>21 hrs</abbr><span aria-hidden="true"> · </span><span class="s"><span><span class="r">Friends of friends</span></span></span></div><div class="r fcg"><a class="t" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDU2tjA0MzIxMbI0NTOqc80rCU_MyQnILy5xLkpNLMnMzwsuyS-qrKszM7CwNDQxsTCrqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I605504561%3A10153381624429562%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">More</a></div></div></div></div><div class="e u" id="ufi_10153381624429562"><div class="v w"><div class="x y z"><table class="ba bb"><tbody><tr><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQC616j-xU4eNOp5&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Like</span></a></td><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="#composer-10153381624429562"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Comment</span></a></td><td class="bc bd bn be" style="width:33%"><a class="bf bg bh bi" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10153381624429562&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Share</span></a></td></tr></tbody></table></div><div class="bo bp bq br"><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a> likes this.</div><div class="v"><div class="bo" id="10153381626219562"><h3><a class="bs" href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a></h3><div>Likewise Kate. Looks like Henry has told you about our famous meals <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></div><div class="bt bu bv"><span class="bw"><span class="bx fcg"><a href="/a/comment.php?like_comment_id=10153381626219562&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQDG24lxp-MEZWrf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Like</a><span aria-hidden="true"> · </span><a class="by bz" aria-label="Like" href="/10153381626219562/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="ca img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;actor_id=550398225&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQA2Etkf-pV93sCG&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413#comment_form_605504561_10153381624429562">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzM4MTYyNDQyOTU2Ml8xMDE1MzM4MTYyNjIxOTU2Mg%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Report</a><span aria-hidden="true"> · </span><abbr>Yesterday at 17:02</abbr></div><div class="cb" id="comment_replies_more_1:10153381624429562_10153381626219562"><div class="bt cc cd"><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;count=1&amp;pc=1&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQAAvZki-0tM8o1k&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">1 reply</a></div></div></div></div><div class="v ce" id="u_0_1"></div><div class="cf cg" id="composer-10153381624429562"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQBgoxYcnSemi7J1&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQEKf7UsDeZ9:AQF1K27QSyMB" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ch" for="u_0_2">Write a comment...</label><table class="ba ci" id="u_0_2"><tbody><tr><td class="bc"><div class="cj ck"><table class="ba cl cm"><tbody><tr><td class="bc cn bb"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cs"><div class="ct"><input value="Comment" type="submit" class="bg cu cv cw" /></div></td></tr></tbody></table><span class="cx r fcg"><a href="/mbasic/comment/advanced/?target_id=10153381624429562&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			doLanguageTest(done, html, '21 hrs', 'Yesterday at 17:02', 'AQEKf7UsDeZ9:AQF1K27QSyMB')
		});

		it('English (US)', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="origin-when-crossorigin" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .k{background:#f6f7f8;border:0;font-size:small;margin:0;}.k .r{font-size:x-small;}.l{margin:0 6px 6px;padding:6px;}.b .l .l{border-color:#e9eaed;margin:6px 0 0;}.s{display:inline-block;}.q{margin-top:5px;}.p{margin:5px 0;}.l a,.l a:visited{color:#2b55ad;}.l a:hover,.l a:focus{background:#2b55ad;color:#fff;}.k .l{font-size:small;padding:4px;}.k .q{margin-top:6px;}.k .p{margin:6px 0;}.b .m{background:white;margin:0;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}.bu{color:#9197a3;}.n{color:#4e5665;}.bt{font-size:12px;line-height:16px;}.bv{font-weight:normal;}.o{font-weight:bold;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .t,.b .t:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .t:focus,.b .t:hover{background-color:#3b5998;color:#fff;}.fcg{color:gray;}.r{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.w .bp a{font-weight:bold;}.v>div{border-top:1px solid rgba(0, 0, 0, .101);}.v>.v>div:first-child{border-top:none;}.u,.u .br{background-color:#f6f7f8;color:#141823;}.cg{border-bottom:1px solid #ddd;}.b .cg{padding-bottom:8px;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media screen and (orientation:portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .z{border-color:#ddd;border-width:1px 0 0;}.b .z .bd{background-color:#f6f7f8;}.b .z .bd:hover,.b .z .bd:hover .bh{background-color:#e9eaed;}.b .z .bh{background-color:inherit;}.cf{padding:8px 8px 0;}.ch{color:#141823;display:block;font-size:small;}.b .cf .ck table{border:none;}.b .cf .cq{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cb{padding-top:4px;}.ct{padding-left:4px;}.cx{margin-top:4px;}form{margin:0;border:0;}.b .ba{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .ba tbody,.b .ci>tr>td,.b .ci>tbody>tr>td,.b .ba td.ci{vertical-align:top;}.b .bb>tr>td,.b .bb>tbody>tr>td,.b .ba td.bb{vertical-align:middle;}.b .ba td{padding:0;}.b .ba td.cp{padding:2px;}.b .ba td.bo{padding:4px;}.b .bc{width:100%;}.cm{background:#fff;}.cj .cr{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cj .cl{border:1px solid #9197a3;}.co{border:0;display:block;margin:0;padding:0;}.b .cp{padding:2px;}.b .bo{padding:4px;}.cu{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cu{border-radius:2px;}.cu[disabled] .bk{opacity:.3;}.cw,a.cw,html .b a.cw{color:#fff;}.b .cw{background-color:#4e69a2;border:1px solid #385490;}.b a.cw:hover,.b .cw:hover{background-color:#465e91;}.cw[disabled]{color:#899bc1;}.b .cw[disabled]:hover{background-color:#4e69a2;}.cu .bm{display:inline-block;}.b .cu .bm{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cu::after,.b .cu.bf::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cu .bk{vertical-align:top;}.cu .bm{line-height:20px;margin-top:4px;}.cu .bk.bl{margin-top:6px;}.cu.bf{padding-left:8px;}.cu.bf .bk{margin-right:6px;}.b .cu{padding:0 8px;}.b a.cu{height:26px;line-height:26px;}.b a.cu .bk.bl{margin-top:5px;}.b .cu.bf{padding-left:7px;}.bk,.img.bk{display:inline-block;pointer-events:none;vertical-align:middle;}.bm{pointer-events:none;}.y{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.x .bh,.x .bd{background-color:#fff;}.bd{background-color:#fff;position:relative;}.bd.bd.bd{padding:6px 0;}.bh{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bi,button.bi{width:100%;}.bh{display:block;}.bh{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bd a.bh{color:#4e5665;}.b .bd a.bh:hover,.b .bd a.bh:focus{background:#f2f2f2;color:#4e5665;}.bd:hover,.bd:focus,.bd:hover .bh,.bd:focus .bh{background:#f2f2f2;}.bh{padding:0 4px;}.bd .bh .bj{display:block;margin:0 auto;}.bd .bf.bh .bj{margin:0 auto 1px;}.bd .bm{pointer-events:auto;}.bq{background:#eceff5;font-size:small;padding:8px;}.bq a{font-weight:bold;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.img.ca{margin-right:3px;vertical-align:baseline;}.bz{white-space:nowrap;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_0"><div><div><h3 class="n o"><a href="/k8jerrum?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C"><strong><a href="/k8jerrum?fref=nf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Kate Jerrum</a></strong><span class="fcg"> &gt; </span>‎<strong><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Chris De Souza</a></strong></a></h3></div><div class="p"><p>Look forward to meeting you tomorrow and going for marmite chicken at hawkers <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></p></div></div><div class="q"><div class="r fcg"><abbr>21 hrs</abbr><span aria-hidden="true"> · </span><span class="s"><span><span class="r">Friends of Friends</span></span></span></div><div class="r fcg"><a class="t" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDU2tjA0MzIxMbI0NTOqc80rCU_MyQnILy5xLkpNLMnMzwsuyS-qrKszM7CwNDQxsTCrqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I605504561%3A10153381624429562%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">More</a></div></div></div></div><div class="e u" id="ufi_10153381624429562"><div class="v w"><div class="x y z"><table class="ba bb"><tbody><tr><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQC616j-xU4eNOp5&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Like</span></a></td><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="#composer-10153381624429562"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Comment</span></a></td><td class="bc bd bn be" style="width:33%"><a class="bf bg bh bi" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10153381624429562&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Share</span></a></td></tr></tbody></table></div><div class="bo bp bq br"><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a> likes this.</div><div class="v"><div class="bo" id="10153381626219562"><h3><a class="bs" href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a></h3><div>Likewise Kate. Looks like Henry has told you about our famous meals <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></div><div class="bt bu bv"><span class="bw"><span class="bx fcg"><a href="/a/comment.php?like_comment_id=10153381626219562&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQDG24lxp-MEZWrf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Like</a><span aria-hidden="true"> · </span><a class="by bz" aria-label="Like" href="/10153381626219562/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="ca img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;actor_id=550398225&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQA2Etkf-pV93sCG&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413#comment_form_605504561_10153381624429562">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzM4MTYyNDQyOTU2Ml8xMDE1MzM4MTYyNjIxOTU2Mg%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Report</a><span aria-hidden="true"> · </span><abbr>Yesterday at 5:02pm</abbr></div><div class="cb" id="comment_replies_more_1:10153381624429562_10153381626219562"><div class="bt cc cd"><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;count=1&amp;pc=1&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQAAvZki-0tM8o1k&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">1 reply</a></div></div></div></div><div class="v ce" id="u_0_1"></div><div class="cf cg" id="composer-10153381624429562"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQBgoxYcnSemi7J1&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQG9z7PCOHh2:AQEwWb48YVtj" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ch" for="u_0_2">Write a comment...</label><table class="ba ci" id="u_0_2"><tbody><tr><td class="bc"><div class="cj ck"><table class="ba cl cm"><tbody><tr><td class="bc cn bb"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cs"><div class="ct"><input value="Comment" type="submit" class="bg cu cv cw" /></div></td></tr></tbody></table><span class="cx r fcg"><a href="/mbasic/comment/advanced/?target_id=10153381624429562&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			doLanguageTest(done, html, '21 hrs', 'Yesterday at 5:02pm', 'AQG9z7PCOHh2:AQEwWb48YVtj')
		})

		it('English (Pirate)', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Scrawlin&#039;s</title><meta name="referrer" content="origin-when-crossorigin" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .k{background:#f6f7f8;border:0;font-size:small;margin:0;}.k .r{font-size:x-small;}.l{margin:0 6px 6px;padding:6px;}.b .l .l{border-color:#e9eaed;margin:6px 0 0;}.s{display:inline-block;}.q{margin-top:5px;}.p{margin:5px 0;}.l a,.l a:visited{color:#2b55ad;}.l a:hover,.l a:focus{background:#2b55ad;color:#fff;}.k .l{font-size:small;padding:4px;}.k .q{margin-top:6px;}.k .p{margin:6px 0;}.b .m{background:white;margin:0;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}.bu{color:#9197a3;}.n{color:#4e5665;}.bt{font-size:12px;line-height:16px;}.bv{font-weight:normal;}.o{font-weight:bold;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .t,.b .t:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .t:focus,.b .t:hover{background-color:#3b5998;color:#fff;}.fcg{color:gray;}.r{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.w .bp a{font-weight:bold;}.v>div{border-top:1px solid rgba(0, 0, 0, .101);}.v>.v>div:first-child{border-top:none;}.u,.u .br{background-color:#f6f7f8;color:#141823;}.cg{border-bottom:1px solid #ddd;}.b .cg{padding-bottom:8px;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media screen and (orientation:portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .z{border-color:#ddd;border-width:1px 0 0;}.b .z .bd{background-color:#f6f7f8;}.b .z .bd:hover,.b .z .bd:hover .bh{background-color:#e9eaed;}.b .z .bh{background-color:inherit;}.cf{padding:8px 8px 0;}.ch{color:#141823;display:block;font-size:small;}.b .cf .ck table{border:none;}.b .cf .cq{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cb{padding-top:4px;}.ct{padding-left:4px;}.cx{margin-top:4px;}form{margin:0;border:0;}.b .ba{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .ba tbody,.b .ci>tr>td,.b .ci>tbody>tr>td,.b .ba td.ci{vertical-align:top;}.b .bb>tr>td,.b .bb>tbody>tr>td,.b .ba td.bb{vertical-align:middle;}.b .ba td{padding:0;}.b .ba td.cp{padding:2px;}.b .ba td.bo{padding:4px;}.b .bc{width:100%;}.cm{background:#fff;}.cj .cr{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cj .cl{border:1px solid #9197a3;}.co{border:0;display:block;margin:0;padding:0;}.b .cp{padding:2px;}.b .bo{padding:4px;}.cu{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cu{border-radius:2px;}.cu[disabled] .bk{opacity:.3;}.cw,a.cw,html .b a.cw{color:#fff;}.b .cw{background-color:#4e69a2;border:1px solid #385490;}.b a.cw:hover,.b .cw:hover{background-color:#465e91;}.cw[disabled]{color:#899bc1;}.b .cw[disabled]:hover{background-color:#4e69a2;}.cu .bm{display:inline-block;}.b .cu .bm{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cu::after,.b .cu.bf::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cu .bk{vertical-align:top;}.cu .bm{line-height:20px;margin-top:4px;}.cu .bk.bl{margin-top:6px;}.cu.bf{padding-left:8px;}.cu.bf .bk{margin-right:6px;}.b .cu{padding:0 8px;}.b a.cu{height:26px;line-height:26px;}.b a.cu .bk.bl{margin-top:5px;}.b .cu.bf{padding-left:7px;}.bk,.img.bk{display:inline-block;pointer-events:none;vertical-align:middle;}.bm{pointer-events:none;}.y{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.x .bh,.x .bd{background-color:#fff;}.bd{background-color:#fff;position:relative;}.bd.bd.bd{padding:6px 0;}.bh{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bi,button.bi{width:100%;}.bh{display:block;}.bh{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bd a.bh{color:#4e5665;}.b .bd a.bh:hover,.b .bd a.bh:focus{background:#f2f2f2;color:#4e5665;}.bd:hover,.bd:focus,.bd:hover .bh,.bd:focus .bh{background:#f2f2f2;}.bh{padding:0 4px;}.bd .bh .bj{display:block;margin:0 auto;}.bd .bf.bh .bj{margin:0 auto 1px;}.bd .bm{pointer-events:auto;}.bq{background:#eceff5;font-size:small;padding:8px;}.bq a{font-weight:bold;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.img.ca{margin-right:3px;vertical-align:baseline;}.bz{white-space:nowrap;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_0"><div><div><h3 class="n o"><a href="/k8jerrum?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C"><strong><a href="/k8jerrum?fref=nf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Kate Jerrum</a></strong><span class="fcg"> &gt; </span>‎<strong><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Chris De Souza</a></strong></a></h3></div><div class="p"><p>Look forward to meeting you tomorrow and going for marmite chicken at hawkers <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></p></div></div><div class="q"><div class="r fcg"><abbr>20 turns o&#039;the hourglass</abbr><span aria-hidden="true"> · </span><span class="s"><span><span class="r">Mateys o&#039; Mateys</span></span></span></div><div class="r fcg"><a class="t" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDU2tjA0MzIxMbI0NTOqc80rCU_MyQnILy5xLkpNLMnMzwsuyS-qrKszM7CwNDQxsTCrqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I605504561%3A10153381624429562%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Show yerself more</a></div></div></div></div><div class="e u" id="ufi_10153381624429562"><div class="v w"><div class="x y z"><table class="ba bb"><tbody><tr><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQC616j-xU4eNOp5&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Arr!</span></a></td><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="#composer-10153381624429562"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Weigh in</span></a></td><td class="bc bd bn be" style="width:33%"><a class="bf bg bh bi" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10153381624429562&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Blabber t&#039; yer mates</span></a></td></tr></tbody></table></div><div class="bo bp bq br"><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a> be eyein&#039; this with pleasure.</div><div class="v"><div class="bo" id="10153381626219562"><h3><a class="bs" href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a></h3><div>Likewise Kate. Looks like Henry has told you about our famous meals <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="smile emoticon" /></div><div class="bt bu bv"><span class="bw"><span class="bx fcg"><a href="/a/comment.php?like_comment_id=10153381626219562&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQDG24lxp-MEZWrf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Arrr, This be pleasin&#039; to me eye.</a><span aria-hidden="true"> · </span><a class="by bz" aria-label="Arrr!" href="/10153381626219562/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="ca img" />1 be fancyin&#039; this</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;actor_id=550398225&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQA2Etkf-pV93sCG&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413#comment_form_605504561_10153381624429562">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzM4MTYyNDQyOTU2Ml8xMDE1MzM4MTYyNjIxOTU2Mg%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Denounce this misdeed</a><span aria-hidden="true"> · </span><abbr>before las&#039; sunset roundabout 5:02in the evenin&#039;</abbr></div><div class="cb" id="comment_replies_more_1:10153381624429562_10153381626219562"><div class="bt cc cd"><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;count=1&amp;pc=1&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQAAvZki-0tM8o1k&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">1 reply</a></div></div></div></div><div class="v ce" id="u_0_1"></div><div class="cf cg" id="composer-10153381624429562"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQBgoxYcnSemi7J1&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQHsyH2_xFRA:AQFtvnWj5V0L" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ch" for="u_0_2">Scrawl a message...</label><table class="ba ci" id="u_0_2"><tbody><tr><td class="bc"><div class="cj ck"><table class="ba cl cm"><tbody><tr><td class="bc cn bb"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cs"><div class="ct"><input value="Weigh in" type="submit" class="bg cu cv cw" /></div></td></tr></tbody></table><span class="cx r fcg"><a href="/mbasic/comment/advanced/?target_id=10153381624429562&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Spot Yer Mateys</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			doLanguageTest(done, html, '20 turns o\'the hourglass', 'before las\' sunset roundabout 5:02in the evenin\'', 'AQHsyH2_xFRA:AQFtvnWj5V0L')
		});

		it('Spanish', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comentarios</title><meta name="referrer" content="origin-when-crossorigin" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .k{background:#f6f7f8;border:0;font-size:small;margin:0;}.k .r{font-size:x-small;}.l{margin:0 6px 6px;padding:6px;}.b .l .l{border-color:#e9eaed;margin:6px 0 0;}.s{display:inline-block;}.q{margin-top:5px;}.p{margin:5px 0;}.l a,.l a:visited{color:#2b55ad;}.l a:hover,.l a:focus{background:#2b55ad;color:#fff;}.k .l{font-size:small;padding:4px;}.k .q{margin-top:6px;}.k .p{margin:6px 0;}.b .m{background:white;margin:0;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}.bu{color:#9197a3;}.n{color:#4e5665;}.bt{font-size:12px;line-height:16px;}.bv{font-weight:normal;}.o{font-weight:bold;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .t,.b .t:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .t:focus,.b .t:hover{background-color:#3b5998;color:#fff;}.fcg{color:gray;}.r{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.w .bp a{font-weight:bold;}.v>div{border-top:1px solid rgba(0, 0, 0, .101);}.v>.v>div:first-child{border-top:none;}.u,.u .br{background-color:#f6f7f8;color:#141823;}.cg{border-bottom:1px solid #ddd;}.b .cg{padding-bottom:8px;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media screen and (orientation:portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .z{border-color:#ddd;border-width:1px 0 0;}.b .z .bd{background-color:#f6f7f8;}.b .z .bd:hover,.b .z .bd:hover .bh{background-color:#e9eaed;}.b .z .bh{background-color:inherit;}.cf{padding:8px 8px 0;}.ch{color:#141823;display:block;font-size:small;}.b .cf .ck table{border:none;}.b .cf .cq{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cb{padding-top:4px;}.ct{padding-left:4px;}.cx{margin-top:4px;}form{margin:0;border:0;}.b .ba{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .ba tbody,.b .ci>tr>td,.b .ci>tbody>tr>td,.b .ba td.ci{vertical-align:top;}.b .bb>tr>td,.b .bb>tbody>tr>td,.b .ba td.bb{vertical-align:middle;}.b .ba td{padding:0;}.b .ba td.cp{padding:2px;}.b .ba td.bo{padding:4px;}.b .bc{width:100%;}.cm{background:#fff;}.cj .cr{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cj .cl{border:1px solid #9197a3;}.co{border:0;display:block;margin:0;padding:0;}.b .cp{padding:2px;}.b .bo{padding:4px;}.cu{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cu{border-radius:2px;}.cu[disabled] .bk{opacity:.3;}.cw,a.cw,html .b a.cw{color:#fff;}.b .cw{background-color:#4e69a2;border:1px solid #385490;}.b a.cw:hover,.b .cw:hover{background-color:#465e91;}.cw[disabled]{color:#899bc1;}.b .cw[disabled]:hover{background-color:#4e69a2;}.cu .bm{display:inline-block;}.b .cu .bm{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cu::after,.b .cu.bf::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cu .bk{vertical-align:top;}.cu .bm{line-height:20px;margin-top:4px;}.cu .bk.bl{margin-top:6px;}.cu.bf{padding-left:8px;}.cu.bf .bk{margin-right:6px;}.b .cu{padding:0 8px;}.b a.cu{height:26px;line-height:26px;}.b a.cu .bk.bl{margin-top:5px;}.b .cu.bf{padding-left:7px;}.bk,.img.bk{display:inline-block;pointer-events:none;vertical-align:middle;}.bm{pointer-events:none;}.y{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.x .bh,.x .bd{background-color:#fff;}.bd{background-color:#fff;position:relative;}.bd.bd.bd{padding:6px 0;}.bh{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bi,button.bi{width:100%;}.bh{display:block;}.bh{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bd a.bh{color:#4e5665;}.b .bd a.bh:hover,.b .bd a.bh:focus{background:#f2f2f2;color:#4e5665;}.bd:hover,.bd:focus,.bd:hover .bh,.bd:focus .bh{background:#f2f2f2;}.bh{padding:0 4px;}.bd .bh .bj{display:block;margin:0 auto;}.bd .bf.bh .bj{margin:0 auto 1px;}.bd .bm{pointer-events:auto;}.bq{background:#eceff5;font-size:small;padding:8px;}.bq a{font-weight:bold;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.img.ca{margin-right:3px;vertical-align:baseline;}.bz{white-space:nowrap;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_0"><div><div><h3 class="n o"><a href="/k8jerrum?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C"><strong><a href="/k8jerrum?fref=nf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Kate Jerrum</a></strong><span class="fcg"> &gt; </span>‎<strong><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Chris De Souza</a></strong></a></h3></div><div class="p"><p>Look forward to meeting you tomorrow and going for marmite chicken at hawkers <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="Emoticono smile" /></p></div></div><div class="q"><div class="r fcg"><abbr>21 h</abbr><span aria-hidden="true"> · </span><span class="s"><span><span class="r">Amigos de amigos</span></span></span></div><div class="r fcg"><a class="t" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDU2tjA0MzIxMbI0NTOqc80rCU_MyQnILy5xLkpNLMnMzwsuyS-qrKszM7CwNDQxsTCrqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I605504561%3A10153381624429562%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Más</a></div></div></div></div><div class="e u" id="ufi_10153381624429562"><div class="v w"><div class="x y z"><table class="ba bb"><tbody><tr><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQC616j-xU4eNOp5&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Me gusta</span></a></td><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="#composer-10153381624429562"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Comentar</span></a></td><td class="bc bd bn be" style="width:33%"><a class="bf bg bh bi" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10153381624429562&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Compartir</span></a></td></tr></tbody></table></div><div class="bo bp bq br">A <a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a> le gusta esto.</div><div class="v"><div class="bo" id="10153381626219562"><h3><a class="bs" href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a></h3><div>Likewise Kate. Looks like Henry has told you about our famous meals <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="Emoticono smile" /></div><div class="bt bu bv"><span class="bw"><span class="bx fcg"><a href="/a/comment.php?like_comment_id=10153381626219562&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQDG24lxp-MEZWrf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Me gusta</a><span aria-hidden="true"> · </span><a class="by bz" aria-label="Me gusta" href="/10153381626219562/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="ca img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;actor_id=550398225&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQA2Etkf-pV93sCG&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413#comment_form_605504561_10153381624429562">Responder</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzM4MTYyNDQyOTU2Ml8xMDE1MzM4MTYyNjIxOTU2Mg%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Denunciar</a><span aria-hidden="true"> · </span><abbr>Ayer a las 17:02</abbr></div><div class="cb" id="comment_replies_more_1:10153381624429562_10153381626219562"><div class="bt cc cd"><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;count=1&amp;pc=1&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQAAvZki-0tM8o1k&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">1 respuesta</a></div></div></div></div><div class="v ce" id="u_0_1"></div><div class="cf cg" id="composer-10153381624429562"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQBgoxYcnSemi7J1&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQGsVgPwkHcb:AQHBKZgXlOWL" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ch" for="u_0_2">Escribe un comentario...</label><table class="ba ci" id="u_0_2"><tbody><tr><td class="bc"><div class="cj ck"><table class="ba cl cm"><tbody><tr><td class="bc cn bb"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cs"><div class="ct"><input value="Comentar" type="submit" class="bg cu cv cw" /></div></td></tr></tbody></table><span class="cx r fcg"><a href="/mbasic/comment/advanced/?target_id=10153381624429562&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Adjuntar una foto</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Mencionar a amigos</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			doLanguageTest(done, html, '21 h', 'Ayer a las 17:02', 'AQGsVgPwkHcb:AQHBKZgXlOWL')
		});

		it('German', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Kommentare</title><meta name="referrer" content="origin-when-crossorigin" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.b .k{background:#f6f7f8;border:0;font-size:small;margin:0;}.k .r{font-size:x-small;}.l{margin:0 6px 6px;padding:6px;}.b .l .l{border-color:#e9eaed;margin:6px 0 0;}.s{display:inline-block;}.q{margin-top:5px;}.p{margin:5px 0;}.l a,.l a:visited{color:#2b55ad;}.l a:hover,.l a:focus{background:#2b55ad;color:#fff;}.k .l{font-size:small;padding:4px;}.k .q{margin-top:6px;}.k .p{margin:6px 0;}.b .m{background:white;margin:0;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}.bu{color:#9197a3;}.n{color:#4e5665;}.bt{font-size:12px;line-height:16px;}.bv{font-weight:normal;}.o{font-weight:bold;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .t,.b .t:visited{color:#6d84b4;}.b a:focus,.b a:hover,.b .t:focus,.b .t:hover{background-color:#3b5998;color:#fff;}.fcg{color:gray;}.r{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.w .bp a{font-weight:bold;}.v>div{border-top:1px solid rgba(0, 0, 0, .101);}.v>.v>div:first-child{border-top:none;}.u,.u .br{background-color:#f6f7f8;color:#141823;}.cg{border-bottom:1px solid #ddd;}.b .cg{padding-bottom:8px;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media screen and (orientation:portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.b .z{border-color:#ddd;border-width:1px 0 0;}.b .z .bd{background-color:#f6f7f8;}.b .z .bd:hover,.b .z .bd:hover .bh{background-color:#e9eaed;}.b .z .bh{background-color:inherit;}.cf{padding:8px 8px 0;}.ch{color:#141823;display:block;font-size:small;}.b .cf .ck table{border:none;}.b .cf .cq{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.cb{padding-top:4px;}.ct{padding-left:4px;}.cx{margin-top:4px;}form{margin:0;border:0;}.b .ba{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .ba tbody,.b .ci>tr>td,.b .ci>tbody>tr>td,.b .ba td.ci{vertical-align:top;}.b .bb>tr>td,.b .bb>tbody>tr>td,.b .ba td.bb{vertical-align:middle;}.b .ba td{padding:0;}.b .ba td.cp{padding:2px;}.b .ba td.bo{padding:4px;}.b .bc{width:100%;}.cm{background:#fff;}.cj .cr{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cj .cl{border:1px solid #9197a3;}.co{border:0;display:block;margin:0;padding:0;}.b .cp{padding:2px;}.b .bo{padding:4px;}.cu{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .cu{border-radius:2px;}.cu[disabled] .bk{opacity:.3;}.cw,a.cw,html .b a.cw{color:#fff;}.b .cw{background-color:#4e69a2;border:1px solid #385490;}.b a.cw:hover,.b .cw:hover{background-color:#465e91;}.cw[disabled]{color:#899bc1;}.b .cw[disabled]:hover{background-color:#4e69a2;}.cu .bm{display:inline-block;}.b .cu .bm{display:inline-block;margin-top:0;vertical-align:middle;}.b a.cu::after,.b .cu.bf::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .cu .bk{vertical-align:top;}.cu .bm{line-height:20px;margin-top:4px;}.cu .bk.bl{margin-top:6px;}.cu.bf{padding-left:8px;}.cu.bf .bk{margin-right:6px;}.b .cu{padding:0 8px;}.b a.cu{height:26px;line-height:26px;}.b a.cu .bk.bl{margin-top:5px;}.b .cu.bf{padding-left:7px;}.bk,.img.bk{display:inline-block;pointer-events:none;vertical-align:middle;}.bm{pointer-events:none;}.y{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.x .bh,.x .bd{background-color:#fff;}.bd{background-color:#fff;position:relative;}.bd.bd.bd{padding:6px 0;}.bh{-webkit-appearance:none;border:none;margin:0;padding:0;}input.bi,button.bi{width:100%;}.bh{display:block;}.bh{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .bd a.bh{color:#4e5665;}.b .bd a.bh:hover,.b .bd a.bh:focus{background:#f2f2f2;color:#4e5665;}.bd:hover,.bd:focus,.bd:hover .bh,.bd:focus .bh{background:#f2f2f2;}.bh{padding:0 4px;}.bd .bh .bj{display:block;margin:0 auto;}.bd .bf.bh .bj{margin:0 auto 1px;}.bd .bm{pointer-events:auto;}.bq{background:#eceff5;font-size:small;padding:8px;}.bq a{font-weight:bold;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.img.ca{margin-right:3px;vertical-align:baseline;}.bz{white-space:nowrap;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="e"><div id="m_story_permalink_view"><div class="k"><div class="l m" id="u_0_0"><div><div><h3 class="n o"><a href="/k8jerrum?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C"><strong><a href="/k8jerrum?fref=nf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Kate Jerrum</a></strong><span class="fcg"> &gt; </span>‎<strong><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;__tn__=C">Chris De Souza</a></strong></a></h3></div><div class="p"><p>Look forward to meeting you tomorrow and going for marmite chicken at hawkers <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="&#x201e;smile&#x201c;-Emoticon" /></p></div></div><div class="q"><div class="r fcg"><abbr>20 Std.</abbr><span aria-hidden="true"> · </span><span class="s"><span><span class="r">Freunde von Freunden</span></span></span></div><div class="r fcg"><a class="t" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwNDU2tjA0MzIxMbI0NTOqc80rCU_MyQnILy5xLkpNLMnMzwsuyS-qrKszM7CwNDQxsTCrqzOoAwA%22%2C%22story_permalink_token%22%3A%22S%3A_I605504561%3A10153381624429562%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Mehr</a></div></div></div></div><div class="e u" id="ufi_10153381624429562"><div class="v w"><div class="x y z"><table class="ba bb"><tbody><tr><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQC616j-xU4eNOp5&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Gefällt mir</span></a></td><td class="bc bd be" style="width:33%"><a class="bf bg bh bi" href="#composer-10153381624429562"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Kommentieren</span></a></td><td class="bc bd bn be" style="width:33%"><a class="bf bg bh bi" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10153381624429562&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bj bk bl img" /><span class="bm">Teilen</span></a></td></tr></tbody></table></div><div class="bo bp bq br"><a href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a> gefällt das.</div><div class="v"><div class="bo" id="10153381626219562"><h3><a class="bs" href="/chris.desouza.507?refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Chris De Souza</a></h3><div>Likewise Kate. Looks like Henry has told you about our famous meals <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yo/r/X8YPpi6kcyo.png" width="16" height="16" class="img" alt="&#x201e;smile&#x201c;-Emoticon" /></div><div class="bt bu bv"><span class="bw"><span class="bx fcg"><a href="/a/comment.php?like_comment_id=10153381626219562&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153381624429562&amp;av=550398225&amp;gfid=AQDG24lxp-MEZWrf&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Gefällt mir</a><span aria-hidden="true"> · </span><a class="by bz" aria-label="&#x201e;Gef&#xe4;llt mir&#x201c;-Angabe" href="/10153381626219562/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png" width="10" height="9" class="ca img" />1</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;actor_id=550398225&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQA2Etkf-pV93sCG&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413#comment_form_605504561_10153381624429562">Antworten</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzM4MTYyNDQyOTU2Ml8xMDE1MzM4MTYyNjIxOTU2Mg%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153381624429562%26id%3D605504561%26bacr%3D1455169783%253A1455169783%253A36%253A-6322863257039796822%253A1455088827%253A0%253A0%253A180%26refid%3D28%26_ft_%3Dqid.6249906637511777662%253Amf_story_key.3881978671396764413&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Melden</a><span aria-hidden="true"> · </span><abbr>Gestern um 17:02</abbr></div><div class="cb" id="comment_replies_more_1:10153381624429562_10153381626219562"><div class="bt cc cd"><a href="/comment/replies/?ctoken=10153381624429562_10153381626219562&amp;count=1&amp;pc=1&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQAAvZki-0tM8o1k&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">1 Antwort</a></div></div></div></div><div class="v ce" id="u_0_1"></div><div class="cf cg" id="composer-10153381624429562"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153381624429562&amp;gfid=AQBgoxYcnSemi7J1&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQE2H9vNHwvq:AQF7lG1Y2ckd" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ch" for="u_0_2">Kommentar verfassen ...</label><table class="ba ci" id="u_0_2"><tbody><tr><td class="bc"><div class="cj ck"><table class="ba cl cm"><tbody><tr><td class="bc cn bb"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cs"><div class="ct"><input value="Kommentieren" type="submit" class="bg cu cv cw" /></div></td></tr></tbody></table><span class="cx r fcg"><a href="/mbasic/comment/advanced/?target_id=10153381624429562&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Foto anhängen</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153381624429562%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6249906637511777662%3Amf_story_key.3881978671396764413">Freunde erwähnen</a></span></form></div></div></div></div></div></div></div></div></body></html>'
			doLanguageTest(done, html, '20 Std.', 'Gestern um 17:02', 'AQE2H9vNHwvq:AQF7lG1Y2ckd')
		});

		describe('Different language edge cases', function() {

			it('reshared photo in Brasilian Portugese...', function(done) {
				let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Comentários</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div class=\"g\"><h1 class=\"h\" id=\"header\"><a class=\"i\" href=\"/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png\" width=\"77\" height=\"16\" class=\"j k\" alt=\"facebook\" /></a></h1></div><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"l\"><div class=\"m n\" id=\"u_0_0\"><div><div><h3 class=\"o p\"><strong><a href=\"/PerthCity/?refid=52&amp;_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701&amp;__tn__=C\">Perth City</a></strong> compartilhou a <a href=\"/perthurbanist/photos/a.485754548137581.107124.480198198693216/993654387347592/?type=3&amp;refid=52&amp;_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701&amp;__tn__=C\">foto</a> de <a href=\"/perthurbanist/?refid=52&amp;_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701&amp;__tn__=C\">Perth Urbanist</a>.</h3></div><div class=\"q\"><div class=\"r s m t\" id=\"u_0_1\"><div><h3 class=\"o u\"><a href=\"/perthurbanist/?refid=52&amp;_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701&amp;__tn__=C\">Perth Urbanist</a></h3><div class=\"v\"><p>Construction has now commenced on Yagan Square. </p><p> Yagan Square will act as the catalyst to link the Perth CBD with Northbridge, and create a new public realm precinct unique to its setting.</p><p> The square is expected open in 2017.</p><p> What would you like to see Yagan Square become?</p></div><div class=\"q\"><div class=\"w x\"><a class=\"y z ba\" href=\"/perthurbanist/photos/a.485754548137581.107124.480198198693216/993654387347592/?type=3&amp;refid=52&amp;_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701&amp;__tn__=E\"><img src=\"https://scontent.fmel1-1.fna.fbcdn.net/hphotos-xpl1/v/t1.0-0/cp0/e15/q65/s240x240/12744745_993654387347592_1756012430702210494_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=b0ab5cb032a231f802333707d09139a1&amp;oe=5755492C\" width=\"240\" height=\"144\" class=\"k\" /></a></div></div></div></div></div></div><div class=\"bb\"><div class=\"bc bd\"><abbr>15 de fevereiro às 15:49</abbr><span aria-hidden=\"true\"> · </span><span class=\"be\"><span><span class=\"bc\">Público</span></span></span></div><div class=\"bc bd\"><a class=\"bf\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22szQ3Njc0MbY0MzAxMzexqHPNKwnOSCxKdS5KTSzJzM8LLskvqqyrMzQ0tzSxMLIwsTQ1MzcwrKszqAMA%22%2C%22story_permalink_token%22%3A%22S%3A_I117948284956701%3A973714396046748%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D973714396046748%26id%3D117948284956701%26refid%3D17%26_ft_%3Dtop_level_post_id.973714396046748%253Atl_objid.973714396046748%253Athid.117948284956701%253A306061129499414%253A3%253A0%253A1456819199%253A2071892520718652633&amp;refid=52&amp;_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701\">Mais</a></div></div></div></div></div></div></div></div></div></body></html>';
				let expected = {
					resharedPhoto: '/perthurbanist/photos/a.485754548137581.107124.480198198693216/993654387347592/?type=3&refid=52&_ft_=top_level_post_id.973714396046748%3Atl_objid.973714396046748%3Athid.117948284956701&__tn__=E',
					type: 'photo'
				};

				doTest(done, html, expected);
			});

			it('edited Spanish post should not have \'Ver historial de ediciones\' in the message body...', function(done) {
				let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>Perth Beer Economy.</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div id=\"objects_container\"><div id=\"root\" role=\"main\" class=\"e\"><div id=\"m_story_permalink_view\"><div class=\"bd\"><div class=\"be bf\" id=\"u_0_0\"><div><div><div class=\"bg fcg\"><a class=\"bh\" href=\"/edits/?cid=1755784927974273&amp;refid=18\">Ver historial de ediciones</a></div><h3 class=\"bi bj\"><a href=\"/profile.php?id=100002617321721&amp;refid=18&amp;__tn__=C\"><strong><a href=\"/profile.php?id=100002617321721&amp;fref=nf&amp;refid=18&amp;__tn__=C\">Paul Buckland</a></strong><span class=\"fcg\"> &gt; </span>‎<strong><a href=\"/groups/1667167856835981?refid=18&amp;__tn__=C\">Perth Beer Economy.</a></strong></a></h3></div><div class=\"bk\"><p>What would people pay for this bar it is about 3.5meters long African mahogany top<br />  very heavy<br /> Buffalo horns not included</p></div><div class=\"bl\"><div class=\"bm bn\" style=\"width:205px; height:205px;\"><a class=\"bo bp\" href=\"/photo.php?fbid=900006153429954&amp;id=100002617321721&amp;set=pcb.1755784927974273&amp;relevant_count=3&amp;source=48&amp;refid=18\" style=\"top:0px; left:0px; width: 205px; height: 102px;\"><img src=\"https://scontent.fmel1-1.fna.fbcdn.net/hphotos-xaf1/v/t1.0-0/cp0/e15/q65/c0.21.960.478/s206x206/12608_900006153429954_67010844170361988_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=83f872e2123af26e2d4440982fc98982&amp;oe=5752FE8C\" width=\"205\" height=\"102\" class=\"bq img\" /></a><a class=\"bo bp\" href=\"/photo.php?fbid=900006190096617&amp;id=100002617321721&amp;set=pcb.1755784927974273&amp;relevant_count=2&amp;source=48&amp;refid=18\" style=\"top:104px; left:0px; width: 102px; height: 101px;\"><img src=\"https://scontent.fmel1-1.fna.fbcdn.net/hphotos-xaf1/v/t1.0-0/cp0/e15/q65/c0.30.110.109/p110x80/1928364_900006190096617_4296898704417101088_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=c7dca1573c46be60e8eebf278fe1aa45&amp;oe=575C9B1E\" width=\"102\" height=\"101\" class=\"bq img\" /></a><a class=\"bo bp\" href=\"/photo.php?fbid=900006213429948&amp;id=100002617321721&amp;set=pcb.1755784927974273&amp;relevant_count=1&amp;source=48&amp;refid=18\" style=\"top:104px; left:104px; width: 101px; height: 101px;\"><img src=\"https://scontent.fmel1-1.fna.fbcdn.net/hphotos-xap1/v/t1.0-0/cp0/e15/q65/c46.0.118.118/p118x118/10403222_900006213429948_644313403519034509_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=68a8248f77e297011a391a89efffa006&amp;oe=575855D2\" width=\"101\" height=\"101\" class=\"bq img\" /></a></div></div></div><div class=\"br\"><div class=\"bg fcg\"><abbr>6 min</abbr><span aria-hidden=\"true\"> · </span><span class=\"bs\"><span><span class=\"bg\">Perth Beer Economy.</span></span></span></div><div class=\"bg fcg\"><a class=\"bh\" href=\"/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQ3NTW3MLE0Mrc0NzEyN65zzStxL8ovLfBNzMkJyC8ucS5KTSzJzM8LLskvqqyrMzQAAiMzQ3NjI0NzI8O6OoM6AA%22%2C%22story_permalink_token%22%3A%22S%3A_I100002617321721%3AVK%3A1755784927974273%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1667167856835981%3Fview%3Dpermalink%26id%3D1755784927974273%26bacr%3D1456207867%253A1456207867%253A13.5%253A7076042241301750598%253A1449043862%253A0%253A0%253A2460%26refid%3D28%26_ft_%3Dqid.6254365191723271424%253Amf_story_key.8572780413964432946&amp;refid=18\">Más</a></div></div></div></div><div class=\"e bt\" id=\"ufi_1755784927974273\"><div class=\"bu bv\"><div class=\"bw bx by\"><table class=\"l bz\"><tbody><tr><td class=\"r ca cb\" style=\"width:33%\"><a class=\"cc w cd ce\" href=\"/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1755784927974273&amp;av=100009834785112&amp;gfid=AQCIeeNYGnYZTvk4&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fprofile_tribe.php&amp;refid=18\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png\" width=\"16\" height=\"16\" class=\"cf cg ch img\" /><span class=\"ci\">Me gusta</span></a></td><td class=\"r ca cb\" style=\"width:33%\"><a class=\"cc w cd ce\" href=\"#composer-1755784927974273\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\" width=\"16\" height=\"16\" class=\"cf cg ch img\" /><span class=\"ci\">Comentar</span></a></td><td class=\"r ca cj cb\" style=\"width:33%\"><a class=\"cc w cd ce\" href=\"/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009834785112&amp;sid=1755784927974273&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fgroups%2F1667167856835981%3Fview%3Dpermalink%26id%3D1755784927974273%26bacr%3D1456207867%253A1456207867%253A13.5%253A7076042241301750598%253A1449043862%253A0%253A0%253A2460%26refid%3D28%26_ft_%3Dqid.6254365191723271424%253Amf_story_key.8572780413964432946&amp;cwevent=composer_entry&amp;av=100009834785112&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fprofile_tribe.php&amp;refid=18\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png\" width=\"16\" height=\"16\" class=\"cf cg ch img\" /><span class=\"ci\">Compartir</span></a></td></tr></tbody></table></div></div></div></div><div class=\"dj\" style=\"display:none\"><div class=\"dk\"><div class=\"dl\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yR/r/CjVACNCmi_H.png\" width=\"54\" height=\"24\" class=\"dm dn img\" /><div class=\"do\"><div class=\"dp\"><a class=\"dq dr ds\" href=\"#\">Ver biografía</a><a class=\"dq dr ds\" href=\"#\">Agregar al grupo</a><a class=\"dq dr ds\" href=\"#\">Invitar al evento</a></div></div></div></div></div></div></div></div></div></body></html>';
				let expected = {
					message: 'What would people pay for this bar it is about 3.5meters long African mahogany top\nvery heavy\nBuffalo horns not included'
				};
				doTest(done, html, expected);
			});
		});
	});
});

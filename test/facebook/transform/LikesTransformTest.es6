import {LikesTransform} from '../../../src/facebook/transform/LikesTransform.es6';
import {ScrapeTestAid} from '../../env/facebook/transform/ScrapeTestAid.es6';

let aid = null;
let chai = require('chai');
let subject = null;

chai.should();

describe('LikesTransform tests', function() {

	beforeEach(() => {
		subject = new LikesTransform({});
		aid = new ScrapeTestAid(subject, 'transform');
	});

	describe('#foreign language support:', function() {

		it('Gaelic language posts should be able to count likes...', (done) => {
			let html = '<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tráchtanna</title></head><body class="b c d e" tabindex="0"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img alt="facebook" class="j k" height="15" src="https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/5Zo8s-IGqA1.png" width="79"/></a></h1></div><div id="objects_container"><div class="l e" id="root" role="main"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_0"><div><div><h3 class="p q"><a href="/hnbot/?refid=52&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297&amp;__tn__=C">Hacker News</a></h3></div><div class="r" style=""><p>Literate Clojure Programming: Anatomy of a Org-Mode File <br/>(Discussion on HN - <a href="http://lm.facebook.com/l.php?u=http%3A%2F%2Fbit.ly%2F2bRKdAk&amp;h=cAQHIGvo8&amp;enc=AZPK1lNPk4MNeWES4eUoBlfGdG8l5FYhDgb904sJE0_DUr6gzHBy_vL0TQOy1n7hNirvFiEyUWD1-zveqo3F1ouLN95uq0rbVTue-OUi893feGAq82WYMndyPrHFFZZrwZRwUSvKjjcP6b3cTaLm-kkSnfqG2iCBAvea1FEJLkxvmQ&amp;s=1" target="_blank"><span>http://bit.ly/</span><wbr/><span class="word_break"/>2bRKdAk</a>)</p></div><div class="s t"><a class="u v" href="http://lm.facebook.com/l.php?u=http%3A%2F%2Ffgiasson.com%2Fblog%2Findex.php%2F2016%2F08%2F11%2Fliterate-clojure-programming-anatomy-of-a-org-mode-file%2F&amp;h=ZAQEdI4Hu&amp;enc=AZOv-a2RDvGYZkEWXtYnW-DrZMdzDdJ3VkBxDDbJuJ605r2SG09DMnu4Lu_qCIN0pG2lpG-UDNu_AWH5nP2dPxWpQ3LVNoGOjQ10yvwNWNYTDYeebjUPbUVaQ0SgI-kXghvr7sFCE6Da0Td8C0_5wgtV&amp;s=1" id="u_0_1" target="_blank"><div class="e w x"><table class="y z"><tbody><tr><td class="ba bb"><img class="k" height="112" src="https://external.fper1-1.fna.fbcdn.net/safe_image.php?d=AQAZO-YnaXfHc_Jr&amp;w=200&amp;h=200&amp;url=https%3A%2F%2Fs0.wp.com%2Fi%2Fblank.jpg&amp;cfs=1&amp;jq=75&amp;sx=0&amp;sy=0&amp;sw=200&amp;sh=200&amp;ext=jpg" width="112"/></td><td class="bc"><h3 class="bd q be">Literate [Clojure] Programming: Anatomy of a Org-mode file</h3><div class="bd bf">fgiasson.com<div class="bd"/></div></td></tr></tbody></table></div></a></div></div><div class="bg"><div class="bh bi"><abbr>8 nóiméad</abbr><span aria-hidden="true">· </span><span class="bj"><span><span class="bh">Os Comhair an Phobail</span></span></span></div><div class="bh bi"><a class="bk" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQ0MgQCIwtzSxMTQ1PDOte8kuCMxKJU56LUxJLM_Lzgkvyiyro6Q3MLUzMLC0NTU2NDcxPDujqDOgA%22%2C%22story_permalink_token%22%3A%22S%3A_I178568815531741%3A1121111287944151%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1121111287944151%26id%3D178568815531741%26bacr%3D1473079936%253A1473079936%253A2%253A-7498689617793832268%253A1473079867%253A0%26refid%3D8%26_ft_%3Dqid.6326831636811994407%253Amf_story_key.-6969008274351922297&amp;refid=52&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297">Tuilleadh</a></div></div></div></div><div class="e bl" id="ufi_1121111287944151"><div class="bm bn"><div class="bo bp bq"><table class="y z"><tbody><tr><td class="bc br bs" style="width:33%"><a class="bt bu bv bw" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=1121111287944151&amp;av=100009543463363&amp;gfid=AQCYmSSBsrIXbc9P&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297"><img class="bx by bz k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yc/r/yB-I64VDoBZ.png" width="16"/><span class="ca">Is maith liom é seo</span></a></td><td class="bc br bs" style="width:33%"><a class="bt bu bv bw" href="#composer-1121111287944151"><img class="bx by bz k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yx/r/Psiw6TN0rH8.png" width="16"/><span class="ca">Scríobh trácht</span></a></td><td class="bc br cb bs" style="width:33%"><a class="bt bu bv bw" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1121111287944151&amp;m=self&amp;exit_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1121111287944151%26id%3D178568815531741%26bacr%3D1473079936%253A1473079936%253A2%253A-7498689617793832268%253A1473079867%253A0%26refid%3D8%26_ft_%3Dqid.6326831636811994407%253Amf_story_key.-6969008274351922297&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297"><img class="bx by bz k" height="16" src="https://static.xx.fbcdn.net/rsrc.php/v3/yU/r/qQMCy4a8cyx.png" width="16"/><span class="ca">Roinn</span></a></td></tr></tbody></table></div><div class="w cc cd ce">Is maith le <a href="/1121111287944151/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1121111287944151%26id%3D178568815531741%26bacr%3D1473079936%253A1473079936%253A2%253A-7498689617793832268%253A1473079867%253A0%26refid%3D8%26_ft_%3Dqid.6326831636811994407%253Amf_story_key.-6969008274351922297&amp;refid=52&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297">beirt</a>é seo.</div><div class="cf cg" id="composer-1121111287944151"><form action="/a/comment.php?fs=8&amp;fr=%2F&amp;actionsource=1&amp;comment_logging&amp;ft_ent_identifier=1121111287944151&amp;gfid=AQBYyRS_oZZVjfOw&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297&amp;av=100009543463363&amp;refid=52" method="post"><input autocomplete="off" name="fb_dtsg" type="hidden" value="AQGcGQ-MRlXJ:AQFJ1FmY2mlJ"/><input name="charset_test" type="hidden" value="€,´,€,´,水,Д,Є"/><label class="ch" for="u_0_2">Scríobh trácht anseo...</label><table class="y z" id="u_0_2"><tbody><tr><td class="bc"><div class="ci cj"><table class="y ck cl"><tbody><tr><td class="bc cm cn"><input class="co cp cq cr" id="composerInput" name="comment_text" type="text"/></td></tr></tbody></table></div></td><td class="ba"><div class="cs"><input class="bu ct cu cv" type="submit" value="Scríobh trácht"/></div></td></tr></tbody></table><span class="cw bh bi"><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1121111287944151%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1121111287944151%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6326831636811994407%3Amf_story_key.-6969008274351922297">Luaigh Cairde</a></span></form></div><div id="add_comment_link_placeholder"/></div></div></div><div/></div></div></div></div></body></html>';
			let expected = { 
				likeStatus: 0,
				likeCount: 0
			};
			
			aid.doTest(done, html, expected);
		});
	});
});
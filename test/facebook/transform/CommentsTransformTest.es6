import {Comment} from '../../../src/data/comment.es6';
import {CommentsTransform} from '../../../src/facebook/transform/CommentsTransform.es6';
import {ScrapeTestAid} from '../../env/facebook/transform/ScrapeTestAid.es6';

let aid = null;
let chai = require('chai');
let subject = null;

chai.should();

describe('CommentsTransform tests', () => {

	beforeEach(() => {
		subject = new CommentsTransform();
		aid = new ScrapeTestAid(subject, 'transform');
	});

	describe('#extract comment creators populated', () => {

		it('creator populated', function(done) {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><h1 class="i" id="header"><a class="j" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="k l" alt="facebook" /></a></h1></div><div id="objects_container"><div id="root" role="main" class="f"><div id="m_story_permalink_view"><div class="m"><div class="n o" id="u_0_0"><div><div><h3 class="p q"><strong><a href="/mike.bur.3?fref=nf&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&amp;__tn__=C">Mike Bur</a></strong> added<a href="/story.php?story_fbid=10207137798899498&amp;id=1117810821&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&amp;__tn__=C">2 new photos</a>.</h3></div><div class="r"><p>Swim</p></div><div class="s"><div class="t u" style="width:205px; height:210px;"><a class="v w" href="/photo.php?fbid=10207137796139429&amp;id=1117810821&amp;set=pcb.10207137798899498&amp;source=48&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646" style="top:0px; left:0px;"><img src="https://scontent.fadl1-1.fna.fbcdn.net/hphotos-xtp1/v/t1.0-0/c27.0.106.213/p160x160/12348081_10207137796139429_6822283307896066403_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=3320fafade0bcf28d79f6147001a9fb8&amp;oe=56DB4836" width="104" height="210" class="x l" /></a><a class="v w" href="/photo.php?fbid=10207137796259432&amp;id=1117810821&amp;set=pcb.10207137798899498&amp;source=48&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646" style="top:0px; left:106px;"><img src="https://scontent.fadl1-1.fna.fbcdn.net/hphotos-xfl1/v/t1.0-0/c30.0.100.213/p160x160/12342467_10207137796259432_9116886526397470293_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=2b5e308d7465a2c7eab1c5c31763c522&amp;oe=56ECEDF7" width="99" height="210" class="x l" /></a></div></div></div><div class="y"><div class="z ba"><abbr>44 mins</abbr><span aria-hidden="true"> · </span><a class="bb" href="/profile.php?id=103317853043264&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Cottesloe</a><span aria-hidden="true"> · </span><span class="bc"><span><span class="z">Public</span></span></span></div><div class="z ba"><span aria-hidden="true"> · </span><a class="bd" href="/nfx/basic/direct_actions/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22hideable_token%22%3A%22MzQwMjA3NDY3t7SwsLQ0sbSoc80rCS5JLCktdi5KTSzJzM8LLskvqqyrMzQ0NLcwNLAwMqyrM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I1117810821%3A10207137798899498%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">More</a></div></div></div></div><div class="f be" id="ufi_10207137798899498"><div class="bf bg"><div class="bh bi bj"><table class="bk bl"><tbody><tr><td class="bm bn bo" style="width:33%"><a class="bp bq br bs" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier=10207137798899498&amp;av=550398225&amp;gfid=AQBVuYfvVw4HzHmO&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yy/r/P2H0Ng8Ff2w.png" width="16" height="16" class="bt bu bv l" /><span class="bw">Like</span></a></td><td class="bm bn bo" style="width:33%"><a class="bp bq br bs" href="#composer-10207137798899498"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bt bu bv l" /><span class="bw">Comment</span></a></td><td class="bm bn bx bo" style="width:33%"><a class="bp bq br bs" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=550398225&amp;sid=10207137798899498&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;cwevent=composer_entry&amp;av=550398225&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fstory.php&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bt bu bv l" /><span class="bw">Share</span></a></td></tr></tbody></table></div><div class="by bz ca cb"><a href="/10207137798899498/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">4 people</a> like this.</div><div class="bf"><div class="by" id="10207137835660417"><h3><a class="cc" href="/wayne.burgess.7792?refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Wayne Burgess</a></h3><div>Beach looks good mike</div><div class="cd ce q"><span class="cf"><span class="cg ba"><a class="bd" href="/a/comment.php?like_comment_id=10207137835660417&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10207137798899498&amp;av=550398225&amp;gfid=AQDgRPgjdbJUR_1K&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10207137798899498_10207137835660417&amp;actor_id=550398225&amp;ft_ent_identifier=10207137798899498&amp;gfid=AQBtfkY8ITpTBizS&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646#comment_form_1117810821_10207137798899498">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDIwNzEzNzc5ODg5OTQ5OF8xMDIwNzEzNzgzNTY2MDQxNw%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Report</a><span aria-hidden="true"> · </span><abbr>32 minutes ago</abbr></div></div><div class="by" id="10207138080706543"><h3><a class="cc" href="/LiithaKrishnan?refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Liitha Krishnan</a></h3><div>Beautiful beach</div><div class="cd ce q"><span class="cf"><span class="cg ba"><a class="bd" href="/a/comment.php?like_comment_id=10207138080706543&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10207137798899498&amp;av=550398225&amp;gfid=AQDiYQZDS_NTxPaH&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=10207137798899498_10207138080706543&amp;actor_id=550398225&amp;ft_ent_identifier=10207137798899498&amp;gfid=AQCgpuoSwMWpofw8&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646#comment_form_1117810821_10207137798899498">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22confirm_actions%22%3Afalse%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDIwNzEzNzc5ODg5OTQ5OF8xMDIwNzEzODA4MDcwNjU0Mw%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fstory.php%3Fstory_fbid%3D10207137798899498%26id%3D1117810821%26bacr%3D1449798214%253A1449798214%253A1%253A8066764526319610646%253A1449795635%253A0%253A0%253A2340%26refid%3D8%26_ft_%3Dqid.6226835915828417629%253Amf_story_key.8066764526319610646&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Report</a><span aria-hidden="true"> · </span><abbr>26 minutes ago</abbr></div></div></div><div class="bf ch" id="u_0_1"></div><div class="ci cj" id="composer-10207137798899498"><form method="post" action="/a/comment.php?fs=8&amp;actionsource=1&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10207137798899498&amp;gfid=AQDE_TTi8NjpNm9o&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646&amp;av=550398225&amp;refid=52"><input type="hidden" name="fb_dtsg" value="AQGDm4dPM5Tb" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ck" for="u_0_2">Write a comment...</label><table class="bk cl" id="u_0_2"><tbody><tr><td class="bm"><div class="cm cn"><table class="bk co cp"><tbody><tr><td class="bm cq bl"><input class="cr cs ct cu" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="cv"><div class="cw"><input value="Comment" type="submit" class="bq cx cy cz" /></div></td></tr></tbody></table><span class="da z ba"><a href="/mbasic/comment/advanced/?target_id=10207137798899498&amp;pap=1&amp;at=compose&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10207137798899498%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10207137798899498%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></body></html>';
			let expected = [
				new Comment({
					id: '10207137835660417',
					message: 'Beach looks good mike',
					rawTimestamp: '32 minutes ago',
					vendor: 'facebook',
					creator: {
						id: 'wayne.burgess.7792',
						name: 'Wayne Burgess',
						photoUrl: '',
						profileUrl: '/wayne.burgess.7792?refid=52&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646',
						vendor: 'facebook'
					}
				}),
				new Comment({
					id: '10207138080706543',
					message: 'Beautiful beach',
					rawTimestamp: '26 minutes ago',
					vendor: 'facebook',
					creator: {
						id: 'LiithaKrishnan',
						name: 'Liitha Krishnan',
						photoUrl: '',
						profileUrl: '/LiithaKrishnan?refid=52&_ft_=qid.6226835915828417629%3Amf_story_key.8066764526319610646',
						vendor: 'facebook'
					}
				})
			];
			aid.doTest(done, html, expected);
		})

		it('parse comments from profile picture update', (done) => {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Profile pictures</title><meta name="referrer" content="default" id="meta_referrer" /><noscript><meta http-equiv="X-Frame-Options" content="DENY" /></noscript><style type="text/css">/*<![CDATA[*/.bm{background-color:#fff;}.m{background-color:#000;}.n{padding:2px 3px;}.bn{padding:6px 3px;}.o{width:100%;}.o .q{text-align:right;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .bz,.b .bz:visited{color:#6d84b4;}.b .p,.b .p:visited{color:#fff;}.b a:focus,.b a:hover,.b .bz:focus,.b .bz:hover{background-color:#3b5998;color:#fff;}.b .p:focus,.b .p:hover{background-color:#fff;color:#3b5998;}.b .u{border-color:#ddd;border-width:1px 0 0;}.b .u .y{background-color:#f6f7f8;}.b .u .y:hover,.b .u .y:hover .bd{background-color:#e9eaed;}.b .u .bd{background-color:inherit;}.b .u .z .bi{color:#5890ff;}.cc .ce a{font-weight:bold;}.cb>div{border-top:1px solid rgba(0, 0, 0, .101);}.cb>.cb>div:first-child{border-top:none;}.ca,.ca .cg{background-color:#f6f7f8;color:#141823;}.cs{border-bottom:1px solid #ddd;}.b .cs{padding-bottom:8px;}.t{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.s .bd,.s .y{background-color:#fff;}.b .v{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .v tbody,.b .cu>tr>td,.b .cu>tbody>tr>td,.b .v td.cu{vertical-align:top;}.b .w>tr>td,.b .w>tbody>tr>td,.b .v td.w{vertical-align:middle;}.b .v td{padding:0;}.b .v td.db{padding:2px;}.b .v td.cd{padding:4px;}.b .x{width:100%;}.y{background-color:#fff;position:relative;}.y.y.y{padding:6px 0;}.bd{-webkit-appearance:none;border:none;margin:0;padding:0;}input.be,button.be{width:100%;}.bd{display:block;}.bd{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .y a.bd{color:#4e5665;}.b .y a.bd:hover,.b .y a.bd:focus{background:#f2f2f2;color:#4e5665;}.y:hover,.y:focus,.y:hover .bd,.y:focus .bd{background:#f2f2f2;}.bd{padding:0 4px;}.y .bd .bf{display:block;margin:0 auto;}.y .bb.bd .bf{margin:0 auto 1px;}.y .bi{pointer-events:auto;}.bg,.img.bg{display:inline-block;pointer-events:none;vertical-align:middle;}.bi{pointer-events:none;}.img{border:0;display:inline-block;vertical-align:top;}i.img u{position:absolute;width:0;height:0;overflow:hidden;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media only screen and (device-width: 320px) and (device-height: 568px){}@media only screen and (device-width: 320px) and (device-height: 480px){}@media (max-height:540px){}@media (max-height:400px){}@media screen and (orientation:portrait){}@media only screen and (orientation: portrait){}@media only screen and (orientation: landscape){}.e{background:#f6f7f8;}.cf{background:#eceff5;font-size:small;padding:8px;}.cf a{font-weight:bold;}.cr{padding:8px 8px 0;}.ct{color:#141823;display:block;font-size:small;}.b .cr .cw table{border:none;}.b .cr .dc{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.bl{padding:4px;}.cn{padding-top:4px;}.df{padding-left:4px;}.dj{margin-top:4px;}form{margin:0;border:0;}.cy{background:#fff;}.cv .dd{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.b .cv .cx{border:1px solid #9197a3;}.da{border:0;display:block;margin:0;padding:0;}.b .db{padding:2px;}.b .cd{padding:4px;}.dg{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .dg{border-radius:2px;}.dg[disabled] .bg{opacity:.3;}.di,a.di,html .b a.di{color:#fff;}.b .di{background-color:#4e69a2;border:1px solid #385490;}.b a.di:hover,.b .di:hover{background-color:#465e91;}.di[disabled]{color:#899bc1;}.b .di[disabled]:hover{background-color:#4e69a2;}.dg .bi{display:inline-block;}.b .dg .bi{display:inline-block;margin-top:0;vertical-align:middle;}.b a.dg::after,.b .dg.bb::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .dg .bg{vertical-align:top;}.dg .bi{line-height:20px;margin-top:4px;}.dg .bg.bh{margin-top:6px;}.dg.bb{padding-left:8px;}.dg.bb .bg{margin-right:6px;}.b .dg{padding:0 8px;}.b a.dg{height:26px;line-height:26px;}.b a.dg .bg.bh{margin-top:5px;}.b .dg.bb{padding-left:7px;}.bv{color:gray;}.bu{font-size:small;}body,tr,input,textarea,.f{font-size:medium;}.bk{border-bottom:1px solid #ddd;font-size:small;}.by,.br{display:inline;}.bk .bx,.bk .by .f,.bk .by.bu,.bk .by .bu{font-size:x-small;}.bt{margin-top:2px;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}.cj{color:#9197a3;}.ci{font-size:12px;line-height:16px;}.ck{font-weight:normal;}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}#page{position:relative;}.h{background:#3b5998;height:24px;}.i{display:inline-block;}.j{padding:4px 5px 5px;}/*]]>*/</style><meta name="robots" content="noindex" /><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" id="header"><a class="i" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=%2Fwap%2Fphoto.php&amp;refid=13"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/y8/r/k97pj8-or6s.png" width="77" height="16" class="j img" alt="facebook" /></a></h1></div><div id="objects_container"><div class="k e" id="root" role="main"><div class="l"><div><div><div class="m"><div style="text-align:center;"><img src="https://scontent.fper2-1.fna.fbcdn.net/hphotos-xfp1/v/t1.0-0/cp0/e15/q65/s320x320/12734088_234981433506348_2057691236210521989_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=1078666d342469ef115ba857a33288ed&amp;oe=576DAB10" width="320" height="180" class="img" /></div></div><div class="m n"><table cellspacing="0" cellpadding="0" class="o"><tr><td valign="top"><a class="p" href="/photo.php?fbid=107249772946182&amp;id=100009834785112&amp;set=a.107249819612844.1073741826.100009834785112&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Previous</a></td><td valign="top" class="q"><a class="p" href="/photo.php?fbid=107249772946182&amp;id=100009834785112&amp;set=a.107249819612844.1073741826.100009834785112&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Next</a></td></tr></table></div></div><div><div class="s t u"><table class="v w"><tbody><tr><td class="x y z ba" style="width:25%"><a class="bb bc bd be" href="/a/like.php?ul=1&amp;perm&amp;ifab&amp;ft_ent_identifier=234981433506348&amp;av=100009543463363&amp;gfid=AQBcW4KLjhUkQFBu&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fphoto.php&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yu/r/VYNYSvu5NAQ.png" width="16" height="16" class="bf bg bh img" /><span class="bi">Like</span></a></td><td class="x y ba" style="width:25%"><a class="bb bc bd be" href="#composer-234981433506348"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="bf bg bh img" /><span class="bi">Comment</span></a></td><td class="x y ba" style="width:25%"><a class="bb bc bd be" href="/photos/xtag_faces/?photo_id=234981433506348&amp;owner_id=100009834785112&amp;return_uri=%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112&amp;page_source=photo&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fphoto.php&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yE/r/Q-U_WZzAqVP.png" width="16" height="16" class="bf bg bh img" /><span class="bi">Tag</span></a></td><td class="x y bj ba" style="width:25%"><a class="bb bc bd be" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=234981433506348&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=%2Fwap%2Fphoto.php&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="bf bg bh img" /><span class="bi">Share</span></a></td></tr></tbody></table></div></div><div><div class="bk bl bm bn"><div class="bo"><a class="bp" href="/profile.php?id=100009834785112&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377"><strong class="bq">Skooter Martin</strong></a><br /><div><div id="voice_replace_id" class="br"></div></div></div><div class="bs bt bu"><span class="bv"><div class="bw"><div class="bx bu bv"><abbr>2 hours ago</abbr><span aria-hidden="true"> · </span><span class="by bu">Public</span><span aria-hidden="true"> · </span>in <a href="/100009834785112/albums/107249819612844/?refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Profile pictures</a></div><span class="bx bu bv"><a class="bz" href="https://scontent.fper2-1.fna.fbcdn.net/hphotos-xlp1/t31.0-8/fr/cp0/e15/q65/12711223_234981433506348_2057691236210521989_o.jpg?efg=eyJpIjoiYiJ9">View full size</a><span aria-hidden="true"> · </span><a class="bz" href="/tokenizer/single/?mode=share_msg&amp;sid=234981433506348&amp;returnURI=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;ref_component=mbasic_photo_permalink&amp;ref_page=%2Fwap%2Fphoto.php&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Send as message</a><span aria-hidden="true"> · </span><a class="bz" href="/nfx/basic/handle_action/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22photo_viewer%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22234981433506348%22%2C%22is_impostor%22%3A%22%22%7D&amp;is_direct=1&amp;action_key=RESOLVE_PROBLEM&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;ext=1456543305&amp;hash=AeTYRPDGEKXGB0m7&amp;ref_component=mbasic_photo_permalink&amp;ref_page=%2Fwap%2Fphoto.php&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Report</a></span></div></span></div></div><div><div class="e ca" id="ufi_234981433506348"><div class="cb cc"><div class="cd ce cf cg">You and <a href="/234981433506348/likes/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">8 others</a> like this.</div><div class="cb"><div class="cd" id="234983670172791"><h3><a class="ch" href="/teest.devisd?refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Teest Devisd</a></h3><div>A little late, but a little cute little lad nonetheless...</div><div class="ci cj ck"><span class="cl"><span class="cm bv"><a href="/a/comment.php?like_comment_id=234983670172791&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=234981433506348&amp;gfid=AQAkJuwJMiUVQBc-&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=234981433506348_234983670172791&amp;actor_id=100009543463363&amp;ft_ent_identifier=234981433506348&amp;gfid=AQB6IcLurhXzOSGF&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377#comment_form_100009834785112_234981433506348_reply_234981433506348_234983670172791">Reply</a><span aria-hidden="true"> · </span><a href="/mbasic/comment/advanced/?target_id=234981433506348&amp;at=edit&amp;ctoken=234981433506348_234983670172791&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Edit</a><span aria-hidden="true"> · </span><abbr>2 hours ago</abbr></div></div><div class="cd" id="234984726839352"><h3><a class="ch" href="/amytomlinson916?refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Amy Tomlinson</a></h3><div>How gorgeous is that xx</div><div class="ci cj ck"><span class="cl"><span class="cm bv"><a href="/a/comment.php?like_comment_id=234984726839352&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=234981433506348&amp;gfid=AQBVEv4iFFZKs--y&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=234981433506348_234984726839352&amp;actor_id=100009543463363&amp;ft_ent_identifier=234981433506348&amp;gfid=AQABBTSbthEIDy10&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377#comment_form_100009834785112_234981433506348_reply_234981433506348_234984726839352">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoyMzQ5ODE0MzM1MDYzNDhfMjM0OTg0NzI2ODM5MzUy%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Report</a><span aria-hidden="true"> · </span><abbr>2 hours ago</abbr></div></div><div class="cd" id="234987963505695"><h3><a class="ch" href="/kelly.stace.3?refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Kelly Stace</a></h3><div>Sooo cute!!!</div><div class="ci cj ck"><span class="cl"><span class="cm bv"><a href="/a/comment.php?like_comment_id=234987963505695&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=234981433506348&amp;gfid=AQDCgBxAFWmsvSnd&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=234981433506348_234987963505695&amp;actor_id=100009543463363&amp;ft_ent_identifier=234981433506348&amp;gfid=AQD8EzxuUtnoss-8&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377#comment_form_100009834785112_234981433506348_reply_234981433506348_234987963505695">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoyMzQ5ODE0MzM1MDYzNDhfMjM0OTg3OTYzNTA1Njk1%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Report</a><span aria-hidden="true"> · </span><abbr>2 hours ago</abbr></div></div><div class="cd" id="235006286837196"><h3><a class="ch" href="/sian.churcher.1?refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Sian Churcher</a></h3><div>Can totally tell he&#039;s your boy! Looks like you!!</div><div class="ci cj ck"><span class="cl"><span class="cm bv"><a href="/a/comment.php?like_comment_id=235006286837196&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=234981433506348&amp;gfid=AQCILVd1h1mbhpqP&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=234981433506348_235006286837196&amp;actor_id=100009543463363&amp;ft_ent_identifier=234981433506348&amp;gfid=AQCK80qkViuvq8od&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377#comment_form_100009834785112_234981433506348_reply_234981433506348_235006286837196">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoyMzQ5ODE0MzM1MDYzNDhfMjM1MDA2Mjg2ODM3MTk2%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Report</a><span aria-hidden="true"> · </span><abbr>1 hour ago</abbr></div><div class="cn" id="comment_replies_more_1:234981433506348_235006286837196"><div class="ci co cp"><a href="/comment/replies/?ctoken=234981433506348_235006286837196&amp;count=1&amp;pc=1&amp;ft_ent_identifier=234981433506348&amp;gfid=AQCRcxaMVqNah6cJ&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">1 reply</a></div></div></div><div class="cd" id="235009963503495"><h3><a class="ch" href="/jan.stone.9235?refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Jan Stone</a></h3><div>What a lovely photo <img src="https://static.xx.fbcdn.net/rsrc.php/v2/yL/r/_vxTn6fgK7m.png" width="16" height="16" class="m_fbEmoji_icon m_fbEmoji_size_16 img" /></div><div class="ci cj ck"><span class="cl"><span class="cm bv"><a href="/a/comment.php?like_comment_id=235009963503495&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=234981433506348&amp;gfid=AQCzfmEsf5S4wkhx&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=234981433506348_235009963503495&amp;actor_id=100009543463363&amp;ft_ent_identifier=234981433506348&amp;gfid=AQAKBk0goJQPAmyL&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377#comment_form_100009834785112_234981433506348_reply_234981433506348_235009963503495">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoyMzQ5ODE0MzM1MDYzNDhfMjM1MDA5OTYzNTAzNDk1%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fm.facebook.com%2Fphoto.php%3Ffbid%3D234981433506348%26id%3D100009834785112%26set%3Da.107249819612844.1073741826.100009834785112%26bacr%3D1456282253%253A1456282253%253A9%253A41774056594996059%253A1456280343%253A0%253A0%253A3600%26refid%3D28%26_ft_%3Dqid.6254692390982509928%253Amf_story_key.2531467133139350377&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Report</a><span aria-hidden="true"> · </span><abbr>1 hour ago</abbr></div></div></div><div class="cb cq" id="u_0_0"></div><div class="cr cs" id="composer-234981433506348"><form method="post" action="/a/comment.php?fs=7&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=234981433506348&amp;gfid=AQAlZdevMqU4JBMD&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377&amp;av=100009543463363&amp;refid=13"><input type="hidden" name="fb_dtsg" value="AQFq4fxFC09K:AQFHvlN8zO8P" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="ct" for="u_0_1">Write a comment...</label><table class="v cu" id="u_0_1"><tbody><tr><td class="x"><div class="cv cw"><table class="v cx cy"><tbody><tr><td class="x cz w"><input class="da db dc dd" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="de"><div class="df"><input value="Comment" type="submit" class="bc dg dh di" /></div></td></tr></tbody></table><span class="dj bu bv"><a href="/mbasic/comment/advanced/?target_id=234981433506348&amp;pap=1&amp;at=compose&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D234981433506348%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D234981433506348%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=13&amp;_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377">Mention Friends</a></span></form></div></div></div></div></div></div></div></div></div></div></div></body></html>';
			let expected = [
				new Comment({
					id: '234983670172791',
					message: 'A little late, but a little cute little lad nonetheless...',
					rawTimestamp: '2 hours ago',
					vendor: 'facebook',
					creator: {
						name: 'Teest Devisd',
						profileUrl: '/teest.devisd?refid=13&_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377'
					}
				}),
				new Comment({
					id: '234984726839352',
					message: 'How gorgeous is that xx',
					rawTimestamp: '2 hours ago',
					vendor: 'facebook',
					creator: {
						name: 'Amy Tomlinson',
						profileUrl: '/amytomlinson916?refid=13&_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377'
					}
				}),
				new Comment({
					id: '234987963505695',
					message: 'Sooo cute!!!',
					rawTimestamp: '2 hours ago',
					vendor: 'facebook',
					creator: {
						name: 'Kelly Stace',
						profileUrl: '/kelly.stace.3?refid=13&_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377'
					}
				}),
				new Comment({
					id: '235006286837196',
					message: 'Can totally tell he\'s your boy! Looks like you!!',
					rawTimestamp: '1 hour ago',
					vendor: 'facebook',
					creator: {
						name: 'Sian Churcher',
						profileUrl: '/sian.churcher.1?refid=13&_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377'
					}
				}),
				new Comment({
					id: '235009963503495',
					message: 'What a lovely photo',
					rawTimestamp: '1 hour ago',
					vendor: 'facebook',
					creator: {
						name: 'Jan Stone',
						profileUrl: '/jan.stone.9235?refid=13&_ft_=qid.6254692390982509928%3Amf_story_key.2531467133139350377'
					}
				})
			];
			aid.doTest(done, html, expected);
		})

		it('comment profile URL without parameters', (done) => {
			let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>TestAlbum</title><meta name="referrer" content="default" id="meta_referrer" /><style type="text/css">/*<![CDATA[*/.bh .cb{margin:6px -6px 0;}.bh.bi .cb{margin:6px -9px 0;}.bh .cf{margin:6px -4px -4px;}.b .m{border:0;border-collapse:collapse;margin:0;padding:0;width:100%;}.b .m tbody,.b .dj>tr>td,.b .dj>tbody>tr>td,.b .m td.dj{vertical-align:top;}.b .ck>tr>td,.b .ck>tbody>tr>td,.b .m td.ck{vertical-align:middle;}.b .m td{padding:0;}.b .m td.w{padding:2px;}.b .m td.bg{padding:4px;}.b .t{width:100%;}.ct{background:#f6f7f8;}.bf{background:#fff;}.b .dz{padding:0;}.b .w{padding:2px;}.b .bg{padding:4px;}.bj{width:100%;}.bj .bt{text-align:right;}.bu{font-size:small;margin-top:0;}.b a,.b a:visited{color:#3b5998;text-decoration:none;}.b .br,.b .br:visited{color:#6d84b4;}.b .bd,.b .bd:visited{color:#fff;}.b a:focus,.b a:hover,.b .br:focus,.b .br:hover{background-color:#3b5998;color:#fff;}.b .bd:focus,.b .bd:hover{background-color:#fff;color:#3b5998;}.b .cj{border-color:#ddd;border-width:1px 0 0;}.b .cj .cl{background-color:#f6f7f8;}.b .cj .cl:hover,.b .cj .cl:hover .co{background-color:#e9eaed;}.b .cj .co{background-color:inherit;}.b .cj .cm .ca{color:#5890ff;}.cw .cx a{font-weight:bold;}.cv>div{border-top:1px solid rgba(0, 0, 0, .101);}.cv>.cv>div:first-child{border-top:none;}.cu,.cu .cz{background-color:#f6f7f8;color:#141823;}.dh{border-bottom:1px solid #ddd;}.b .dh{padding-bottom:8px;}.cd{display:inline-block;margin:2px;overflow:hidden;position:relative;}.cd:after{border:1px solid rgba(0, 0, 0, .1);bottom:0;content:"";left:0;position:absolute;right:0;top:0;}.ce{background:#f2f2f2;}.cc:hover .ce{background:none;}.ci{border-color:#d3d6db #cdd0d6 #c0c4cc;border-style:solid;border-width:1px;}.ch .co,.ch .cl{background-color:#fff;}.cl{background-color:#fff;position:relative;}.cl.cl.cl{padding:6px 0;}.co{-webkit-appearance:none;border:none;margin:0;padding:0;}input.cp,button.cp{width:100%;}.co{display:block;}.co{background-color:#fff;color:#4e5665;font-size:small;text-align:center;white-space:nowrap;}.b .cl a.co{color:#4e5665;}.b .cl a.co:hover,.b .cl a.co:focus{background:#f2f2f2;color:#4e5665;}.cl:hover,.cl:focus,.cl:hover .co,.cl:focus .co{background:#f2f2f2;}.co{padding:0 4px;}.cl .co .cq{display:block;margin:0 auto;}.cl .bv.co .cq{margin:0 auto 1px;}.cl .ca{pointer-events:auto;}.by,.s.by{display:inline-block;pointer-events:none;vertical-align:middle;}.ca{pointer-events:none;}.s{border:0;display:inline-block;vertical-align:top;}i.s u{position:absolute;width:0;height:0;overflow:hidden;}@-webkit-keyframes mPlatformDialogOauthV4_moveUp{from{opacity:1;transform:translateY(0%);}to{opacity:0;transform:translateY(10%);}}@-webkit-keyframes mPlatformDialogOauthV4_moveDown{from{opacity:0;transform:translateY(10%);}to{opacity:1;transform:translateY(0%);}}@media screen and (orientation:portrait){}@media only screen and (orientation: landscape){}.cy{background:#eceff5;font-size:small;padding:8px;}.cy a{font-weight:bold;}.dg{padding:8px 8px 0;}.di{color:#141823;display:block;font-size:small;}.b .dg .dl table{border:none;}.b .dg .dp{border:1px solid #999;height:36px;padding:3px 3px 4px 0;width:98%;}.dr{padding-left:4px;}.dt{margin-top:4px;}form{margin:0;border:0;}.dk .ec{height:24px;line-height:24px;margin-left:2px;}.dn{background:#fff;}.dk .dq{background-color:transparent;color:#4e5665;display:block;padding:0;width:100%;}.dx .s{display:block;}.dk .dm .eb{padding:2px;}.dk .dm .dx{padding:4px;}.b .dk .dm{border:1px solid #9197a3;}.v{border:0;display:block;margin:0;padding:0;}.z{-webkit-appearance:none;background:none;display:inline-block;font-size:12px;height:28px;line-height:28px;margin:0;overflow:visible;padding:0 9px;text-align:center;vertical-align:top;white-space:nowrap;}.b .z{border-radius:2px;}.bx,a.bx,.b a.bx,.b a.bx:visited{background-color:#f6f7f8;color:#4e5665;}.b a.bx:hover,.b .bx:hover{background-color:#e9eaed;color:#4e5665;}.b .bx{border:1px solid #bdc1c9;}.z[disabled] .by{opacity:.3;}.bx[disabled]{color:#bdc1c9;}.b .bx[disabled]:hover{background-color:#f6f7f8;color:#bdc1c9;}.bb,a.bb,html .b a.bb{color:#fff;}.b .bb{background-color:#4e69a2;border:1px solid #385490;}.b a.bb:hover,.b .bb:hover{background-color:#465e91;}.bb[disabled]{color:#899bc1;}.b .bb[disabled]:hover{background-color:#4e69a2;}.z .ca{display:inline-block;}.b .z .ca{display:inline-block;margin-top:0;vertical-align:middle;}.b a.z::after,.b .z.bv::after{content:"";display:inline-block;height:100%;vertical-align:middle;}html .z .by{vertical-align:top;}.z .ca{line-height:20px;margin-top:4px;}.z .by.bz{margin-top:8px;}.z .by.cr{margin-top:6px;}.z .by.dy{margin-top:4px;}.z.bv{padding-left:8px;}.z.bv .by{margin-right:6px;}.z.bw{display:block;width:100%;}a.z.bw,.b label.z.bw{display:block;width:auto;}.b .z{padding:0 8px;}.b a.z{height:26px;line-height:26px;}.b a.z .by.bz{margin-top:7px;}.b a.z .by.cr{margin-top:5px;}.b a.z .by.dy{margin-top:3px;}.b .z.bv{padding-left:7px;}.bq{color:gray;}.bp{font-size:small;}body,tr,input,textarea,.g{font-size:medium;}.bn{word-wrap:break-word;}.bs{margin-top:8px;}.bk .bo{font-size:x-small;}.bk .bs{font-size:small;margin:6px 0;}.db{color:#9197a3;}.bl{font-size:12px;line-height:16px;}.dc{font-weight:normal;}.bm{font-weight:bold;}@-webkit-keyframes highlightFade{0%{background:#fff9d7;}50%{background:#fff9d7;}100%{background:transparent;}}body{text-align:left;direction:ltr;}body,tr,input,textarea,button{font-family:sans-serif;}body,p,figure,h1,h2,h3,h4,h5,h6,ul,ol,li,dl,dd,dt{margin:0;padding:0;}h1,h2,h3,h4,h5,h6{font-size:1em;font-weight:bold;}ul,ol{list-style:none;}article,aside,figcaption,figure,footer,header,nav,section{display:block;}.d #viewport{margin:0 auto;max-width:600px;}.i{background-color:#3b5998;}.f{background:#dcdee3;}#page{position:relative;}.r,.r.s{display:block;}.o{display:block;}.p{height:20px;width:20px;}.k{background:#3b5998;padding:0 4px 4px;height:22px;}.k.k .x{background:#fff;border:1px solid #243872;box-sizing:border-box;font-size:small;height:22px;margin:0;padding:0;width:100%;}.l.k{padding:1px 1px 3px;}.k .q{padding:1px 3px 0 0;}.k.k.k .ba{background:#627aba;border:1px solid #2e417e;color:#fff;font-size:x-small;font-weight:normal;margin-left:3px;height:22px;line-height:20px;}.j{padding:2px 3px;}.du{font-size:small;padding:7px 8px 8px;}.eg{display:block;margin-top:8px;padding:2px;text-align:center;}.ee{display:block;font-size:x-small;margin:-3px -3px 1px -3px;padding:3px;}.b .du td.ed{padding-right:4px;}.b .du td.ef{padding-left:4px;}.du.dv{background-color:#4e5665;}.dv{border-top:1px solid #373e4d;color:#bdc1c9;}.dv .eg{border:1px solid #bdc1c9;color:#bdc1c9;}.b .dv a,.b .dv a:visited{color:#bdc1c9;}.b .dv a:focus,.b .dv a:hover{background:#dcdee3;color:#141823;}.dv .eg:focus,.dv .eg:hover{background:#dcdee3;border:1px solid #dcdee3;color:#141823;}.dw{margin-bottom:8px;}.du.dv .dw>table{background:#d3d7dc;border:1px solid #373e4d;}.ea{background:#d3d7dc;}.bc{padding-bottom:1px;}.be{display:inline-block;font-size:small;padding:2px 4px 2px;}/*]]>*/</style><link rel="manifest" href="/data/manifest" /></head><body tabindex="0" class="b c d e f"><div class="g"><div id="viewport"><div class="h"><div class="i j" id="header"><form method="get" class="k l" action="/search/"><input type="hidden" name="search" value="Search" /><input type="hidden" name="search_source" value="top_nav" /><table class="m"><tbody><tr><td class="n"><a class="o p q" href="/home.php?ref_component=mbasic_home_logo&amp;ref_page=XPhotosAlbumPermalinkController"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/ym/r/Gjhrhb7r0lb.png" width="20" height="20" class="r s" alt="Facebook logo" /></a></td><td class="t u"><input class="v w x" name="query" placeholder="Search Facebook" autocomplete="off" autocorrect="off" spellcheck="false" type="text" /></td><td class="n"><input value="Search" type="submit" class="y z ba bb" /></td></tr></tbody></table></form><div class="bc"><a class="bd be" accesskey="1" aria-label="Home" href="/home.php?a_type=sr&amp;ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController" style="display:block;height:0;overflow:hidden;position:absolute;width:0;padding:0">&nbsp;</a><a class="bd be" href="/home.php?ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController" tabindex="-1" aria-hidden="1">Home</a><a class="bd be" href="/teest.devisd?v=info&amp;ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController">Edit Profile</a><a class="bd be" accesskey="2" href="/friends/center/mbasic/?fb_ref=tn&amp;sr=1&amp;ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController">Find Friends</a><a class="bd be" accesskey="4" href="/messages/?ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController">Messages</a><a class="bd be" accesskey="3" href="/notifications.php?ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController">Notifications</a><a class="bd be" accesskey="6" href="/buddylist.php?ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController">Chat(1)</a><a class="bd be" accesskey="5" href="/menu/bookmarks/?ref_component=mbasic_home_header&amp;ref_page=XPhotosAlbumPermalinkController">Menu</a></div></div></div><div id="objects_container"><div id="root" role="main" class="f"><table class="m"><tbody><tr><td class="t"><div class="bf bg"><div class="bh bi"><div><table cellspacing="0" cellpadding="0" class="bj"><tr><td valign="top"><div class="bk"><div class="bl bm bn">TestAlbum</div><span class="bo bp bq"><abbr>Monday at 15:17</abbr><span aria-hidden="true"> · </span><span>Privacy:&nbsp;<a href="/privacy/selectorx/?fbid=1547833552211412&amp;selected_privacyx=291667064279714&amp;return_uri=https%3A%2F%2Fm.facebook.com%2Fteest.devisd%2Falbums%2F1547833552211412%2F%3Ffbt_id%3D1547833552211412%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;context=album_permalink">Friends</a></span><span aria-hidden="true"> · </span><a class="br" href="/a/post/subscribe/?subscribe&amp;ft_ent_identifier=1547833552211412&amp;gfid=AQAz_6TRQQwXxtvk">Stop notifications</a></span><div class="bs">Test Album</div></div></td><td valign="top" class="bt"><div class="bu"><a href="/photos/edit/album/1547833552211412/?cancel_uri=https%3A%2F%2Fm.facebook.com%2Fteest.devisd%2Falbums%2F1547833552211412%2F%3Ffbt_id%3D1547833552211412%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;referrer=album_permalink">Edit</a></div></td></tr></table></div><div><a class="bv y z bw bx" href="/composer/mbasic/?c_src=add_photo_in_album&amp;referrer=add_photo_in_album&amp;target=100009543463363&amp;album_id=1547833552211412&amp;ctype=inline&amp;cwevent=composer_entry&amp;av=100009543463363&amp;icv=lgc_view_photo&amp;lgc_view_photo"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yr/r/kdqLgRkNCQu.png" width="12" height="12" class="by bz s" /><span class="ca">Add Photos</span></a></div><div class="cb"><div style="text-align:center;" id="thumbnail_area"><a class="cc cd" href="/photo.php?fbid=1547833355544765&amp;id=100009543463363&amp;set=a.1547833552211412.1073741843.100009543463363&amp;source=56"><img src="https://scontent.fper1-1.fna.fbcdn.net/hphotos-xtp1/v/t1.0-0/cp0/e15/q65/c233.0.315.315/s75x225/12729066_1547833355544765_2022898844229182395_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=fd49ac80690e85d2b78f0f3d29dbe695&amp;oe=5725BD30" width="72" height="72" class="ce s" /></a><a class="cc cd" href="/photo.php?fbid=1547833358878098&amp;id=100009543463363&amp;set=a.1547833552211412.1073741843.100009543463363&amp;source=56"><img src="https://scontent.fper1-1.fna.fbcdn.net/hphotos-xfl1/v/t1.0-0/cp0/e15/q65/c18.0.479.479/s75x225/1001072_1547833358878098_1351903127458013912_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=b4b9b6c186e097ddb36254fa529bd279&amp;oe=5770234B" width="72" height="72" class="ce s" /></a><a class="cc cd" href="/photo.php?fbid=1547833362211431&amp;id=100009543463363&amp;set=a.1547833552211412.1073741843.100009543463363&amp;source=56"><img src="https://scontent.fper1-1.fna.fbcdn.net/hphotos-xlp1/v/t1.0-0/cp0/e15/q65/c85.0.326.326/s75x225/12743988_1547833362211431_1456221009165092547_n.jpg?efg=eyJpIjoiYiJ9&amp;oh=91f335c80f69bd3096825768d8814b3d&amp;oe=575FFA6B" width="72" height="72" class="ce s" /></a></div></div><div></div><div class="cf cg"><div class="ch ci cj"><table class="m ck"><tbody><tr><td class="t cl cm cn" style="width:33%"><a class="bv y co cp" href="/a/like.php?ul=1&amp;perm&amp;ifab&amp;ft_ent_identifier=1547833552211412&amp;av=100009543463363&amp;gfid=AQB5WSEWa8e0hMz_&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=XPhotosAlbumPermalinkController"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yu/r/VYNYSvu5NAQ.png" width="16" height="16" class="cq by cr s" /><span class="ca">Like</span></a></td><td class="t cl cn" style="width:33%"><a class="bv y co cp" href="#composer-1547833552211412"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png" width="16" height="16" class="cq by cr s" /><span class="ca">Comment</span></a></td><td class="t cl cs cn" style="width:33%"><a class="bv y co cp" href="/composer/mbasic/?c_src=share&amp;referrer=permalink&amp;target=100009543463363&amp;sid=1547833552211412&amp;m=self&amp;exit_uri=https%3A%2F%2Fm.facebook.com%2Fteest.devisd%2Falbums%2F1547833552211412%2F%3Ffbt_id%3D1547833552211412%26lul%26ref_component%3Dmbasic_photo_permalink_actionbar&amp;cwevent=composer_entry&amp;av=100009543463363&amp;view_overview&amp;ref_component=mbasic_photo_permalink_actionbar&amp;ref_page=XPhotosAlbumPermalinkController"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yP/r/_ByufLrUwa0.png" width="16" height="16" class="cq by cr s" /><span class="ca">Share</span></a></td></tr></tbody></table></div><div class="ct cu" id="ufi_1547833552211412"><div class="cv cw"><div class="bg cx cy cz">You like this.</div><div class="cv"><div class="bg" id="1548823625445738"><h3><a class="da" href="/teest.devisd">Teest Devisd</a></h3><div>Interesting</div><div class="bl db dc"><span class="dd"><span class="de bq"><a href="/a/comment.php?like_comment_id=1548823625445738&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=1547833552211412&amp;gfid=AQCsbDT6pWIvHNUT">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken=1547833552211412_1548823625445738&amp;actor_id=100009543463363&amp;ft_ent_identifier=1547833552211412&amp;gfid=AQBBar72GfbtZXLN#comment_form_100009543463363_1547833552211412">Reply</a><span aria-hidden="true"> · </span><a href="/mbasic/comment/advanced/?target_id=1547833552211412&amp;at=edit&amp;ctoken=1547833552211412_1548823625445738">Edit</a><span aria-hidden="true"> · </span><abbr>5 minutes ago</abbr></div></div></div><div class="cv df" id="u_0_0"></div><div class="dg dh" id="composer-1547833552211412"><form method="post" action="/a/comment.php?fs=0&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=1547833552211412&amp;gfid=AQDmjOAiwpRDjIka&amp;av=100009543463363"><input type="hidden" name="fb_dtsg" value="AQHQU8Cf32I1:AQF6HFe9xn31" autocomplete="off" /><input type="hidden" name="charset_test" value="&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;" /><label class="di" for="u_0_1">Write a comment...</label><table class="m dj" id="u_0_1"><tbody><tr><td class="t"><div class="dk dl"><table class="m dm dn"><tbody><tr><td class="t do ck"><input class="v w dp dq" id="composerInput" name="comment_text" type="text" /></td></tr></tbody></table></div></td><td class="n"><div class="dr"><input value="Comment" type="submit" class="y z ds bb" /></div></td></tr></tbody></table><span class="dt bp bq"><a href="/mbasic/comment/advanced/?target_id=1547833552211412&amp;pap=1&amp;at=compose">Attach a Photo</a><span aria-hidden="true"> · </span><a href="/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1547833552211412%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1547833552211412%26pap%26at%3Dcompose&amp;friends_key=ids">Mention Friends</a></span></form></div></div></div></div></div></div></td></tr></tbody></table></div></div><div><div class="du dv"><div id="search_div"><form method="get" action="/search/"><input type="hidden" name="search" /><input type="hidden" name="search_source" value="footer" /><div class="dk dw"><table class="m dm dn"><tbody><tr><td class="n dx ck"><label for="u_0_2"><img src="https://static.xx.fbcdn.net/rsrc.php/v2/yp/r/eZuLK-TGwK1.png" width="20" height="20" class="dy s" /></label></td><td class="t do ck"><input class="v dz ea dq" name="query" id="u_0_2" type="text" /></td><td class="n eb ck"><input value="Search" type="submit" class="y z ec bb" /></td></tr></tbody></table></div></form></div><table class="m"><tbody><tr><td class="t ed" style="width:50%"><a class="ee" accesskey="0" href="/help/?ref_component=mbasic_footer&amp;ref_page=XPhotosAlbumPermalinkController">Help</a><a class="ee" accesskey="7" href="/settings/?ref_component=mbasic_footer&amp;ref_page=XPhotosAlbumPermalinkController">Settings &amp; Privacy</a><a class="ee" href="/pages/create/?ref_type=site_footer">Create Page</a></td><td class="t ef" style="width:50%"><a class="ee" href="/bugnub/?source=Footer&amp;ref_component=mbasic_footer&amp;ref_page=XPhotosAlbumPermalinkController">Report a Problem</a><a class="ee" accesskey="8" href="/policies/?ref_component=mbasic_footer&amp;ref_page=XPhotosAlbumPermalinkController">Terms &amp; Policies</a><a class="ee" href="/logout.php?h=AfeGuvHKArfyLyBT&amp;t=1455674415&amp;ref_component=mbasic_footer&amp;ref_page=XPhotosAlbumPermalinkController">Log Out (Teest Devisd)</a></td></tr></tbody></table><a class="eg" href="#header">Back to Top</a></div></div></div></div></body></html>';
			let expected = [
				new Comment({
					id: '1548823625445738',
					message: 'Interesting',
					rawTimestamp: '5 minutes ago',
					vendor: 'facebook',
					creator: {
						name: 'Teest Devisd',
						profileUrl: '/teest.devisd'
					}
				})
			];
			aid.doTest(done, html, expected);
		});
	});

	describe('#foreign language support:', function() {

		it('Chinese comments page should parse correct number of comments...', (done) => {
			let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>评论</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div id=\"objects_container\"><div class=\"l e\" id=\"root\" role=\"main\"><div id=\"m_story_permalink_view\"><div class=\"e bk\" id=\"ufi_10153423098103441\"><div class=\"bl bm\"><div class=\"bl\"><div class=\"v cf\" id=\"see_prev_10153423098103441\"><a href=\"/story.php?story_fbid=10153423098103441&amp;id=107787018440&amp;p=10&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\" width=\"16\" height=\"16\" class=\"bz k\" />&nbsp;查看之前的评论…</a></div><div class=\"v\" id=\"10153423270528441\"><h3><a class=\"cg\" href=\"/craig.short.3597?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Craig Short</a></h3><div>Not funny at all</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423270528441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQCvdBByl1-7-_c0&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a><span aria-hidden=\"true\"> · </span><a class=\"cl cm\" aria-label=\"&#x8d5e;\" href=\"/10153423270528441/likes/?cancel_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/ya/r/FVWZGFsk3kW.png\" width=\"10\" height=\"9\" class=\"cn k\" />1</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423270528441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAajWK0nliAfrBz&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423270528441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzI3MDUyODQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>36 分钟前</abbr></div></div><div class=\"v\" id=\"10153423276223441\"><h3><a class=\"cg\" href=\"/krissy.sands?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Kristel Sands</a></h3><div>The disturbing part was the father not grabbing his daughter but running in front of her instead?!?!</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423276223441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAR8J6Ih9pV-NTl&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423276223441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQDSrvtweVT-6ezj&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423276223441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzI3NjIyMzQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>28 分钟前</abbr></div></div><div class=\"v\" id=\"10153423292928441\"><h3><a class=\"cg\" href=\"/Ayhan.Aydin1?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Ayhan Aydin</a></h3><div>These guys are idiots.</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423292928441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQCvD76MTsUm1gdL&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423292928441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQDU2o74kMKDCXeX&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423292928441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzI5MjkyODQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>13 分钟前</abbr></div></div><div class=\"v\" id=\"10153423315803441\"><h3><a class=\"cg\" href=\"/kcmonaro?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Ken A Coker</a></h3><div>I thought you could still be charged with assault weather the gun was loaded/fake or not? The ppl targeted did not know it was fake? Why are the police not charging them?</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423315803441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAEyBM7kJHFr7NU&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423315803441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAiSLZxl05xknfK&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423315803441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzMxNTgwMzQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>9 分钟前</abbr></div><div class=\"co\" id=\"comment_replies_more_1:10153423098103441_10153423315803441\"><div class=\"bc cp cq\"><a href=\"/comment/replies/?ctoken=10153423098103441_10153423315803441&amp;count=1&amp;pc=1&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQCoXKxEk77MdPZS&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">1 条回复</a></div></div></div><div class=\"v\" id=\"10153423318018441\"><h3><a class=\"cg\" href=\"/tracey.allan.5?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Tracey Allan</a></h3><div>They should be put into a prison. It would be interesting to see how the inmates would tolerate their so called pranks. Idiots.</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423318018441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQDykkDLlTMKhM1q&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423318018441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAXbn84VRtibW3c&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423318018441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzMxODAxODQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>7 分钟前</abbr></div></div><div class=\"v\" id=\"10153423319963441\"><h3><a class=\"cg\" href=\"/stuart.peterson.14?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Stuart Peterson</a></h3><div>What is worse is that they own La Torre Family Restaurant in Wallan!</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423319963441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQC9DrNO6gYidZeN&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423319963441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAgQ4PTQQLNn2Kv&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423319963441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzMxOTk2MzQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>4 分钟前</abbr></div></div><div class=\"v\" id=\"10153423320093441\"><h3><a class=\"cg\" href=\"/roger.callewaert?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Roger Callewaert</a></h3><div>I di not find these funny at all</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423320093441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQCS2aRFCPTIt8k8&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423320093441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQCJ4sGrXLtVC4Sb&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423320093441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzMyMDA5MzQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>4 分钟前</abbr></div></div><div class=\"v\" id=\"10153423323018441\"><h3><a class=\"cg\" href=\"/erich.leten?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Erich Leten</a></h3><div>I see child molesters.</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423323018441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQA9mj3D_87dgGph&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423323018441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAh91TffZmX75un&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423323018441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzMyMzAxODQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>刚刚</abbr></div></div></div><div class=\"bl cr\" id=\"u_0_0\"></div><div class=\"cs ct\" id=\"composer-10153423098103441\"><form method=\"post\" action=\"/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQBxiw706o4qFX1Q&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059&amp;av=100009834785112&amp;refid=52\"><input type=\"hidden\" name=\"fb_dtsg\" value=\"AQGkTdGJ6C2Z:AQFGDL7UZmX0\" autocomplete=\"off\" /><input type=\"hidden\" name=\"charset_test\" value=\"&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;\" /><label class=\"cu\" for=\"u_0_2\">写评论...</label><table class=\"x y\" id=\"u_0_2\"><tbody><tr><td class=\"bb\"><div class=\"cv cw\"><table class=\"x cx cy\"><tbody><tr><td class=\"bb cz bq\"><input class=\"da db dc dd\" id=\"composerInput\" name=\"comment_text\" type=\"text\" /></td></tr></tbody></table></div></td><td class=\"z\"><div class=\"de\"><input value=\"&#x8bc4;&#x8bba;\" type=\"submit\" class=\"bu df dg dh\" /></div></td></tr></tbody></table><span class=\"di bg bh\"><a href=\"/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153423098103441%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153423098103441%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">提及好友</a></span></form></div></div></div></div></div></div></div><img src=\"https://pixel.facebook.com/si/kappa/?Ko=sp\" class=\"k\" /></div></body></html>';
			let test = (data) => data.length.should.equal(8);
			
			aid.doTest(done, html, test);
		});

		it('Chinese comments page should parse correct...', (done) => {
			let html = '<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>评论</title></head><body tabindex=\"0\" class=\"b c d e\"><div class=\"f\"><div id=\"viewport\"><div id=\"objects_container\"><div class=\"l e\" id=\"root\" role=\"main\"><div id=\"m_story_permalink_view\"><div class=\"e bk\" id=\"ufi_10153423098103441\"><div class=\"bl bm\"><div class=\"bl\"><div class=\"v cf\" id=\"see_prev_10153423098103441\"><a href=\"/story.php?story_fbid=10153423098103441&amp;id=107787018440&amp;p=10&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\"><img src=\"https://static.xx.fbcdn.net/rsrc.php/v2/yw/r/ks_T7R1PM8o.png\" width=\"16\" height=\"16\" class=\"bz k\" />&nbsp;查看之前的评论…</a></div><div class=\"v\" id=\"10153423323018441\"><h3><a class=\"cg\" href=\"/erich.leten?rc=p&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">Erich Leten</a></h3><div>I see child molesters.</div><div class=\"bc ch ci\"><span class=\"cj\"><span class=\"ck bh\"><a href=\"/a/comment.php?like_comment_id=10153423323018441&amp;snowflake&amp;redirectosoftpermalink&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQA9mj3D_87dgGph&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">赞</a></span></span><span aria-hidden=\"true\"> · </span><a href=\"/comment/replies/?ctoken=10153423098103441_10153423323018441&amp;actor_id=100009834785112&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQAh91TffZmX75un&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059#comment_form_107787018440_10153423098103441_reply_10153423098103441_10153423323018441\">回复</a><span aria-hidden=\"true\"> · </span><a href=\"/nfx/basic/question/?context_str=%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22reportable_ent_token%22%3A%22RW50Q29tbWVudDoxMDE1MzQyMzA5ODEwMzQ0MV8xMDE1MzQyMzMyMzAxODQ0MQ%3D%3D%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri=https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D10153423098103441%26id%3D107787018440%26refid%3D28%26_ft_%3Dqid.6254721210065053038%253Amf_story_key.41774056594996059&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">举报</a><span aria-hidden=\"true\"> · </span><abbr>刚刚</abbr></div></div></div><div class=\"bl cr\" id=\"u_0_0\"></div><div class=\"cs ct\" id=\"composer-10153423098103441\"><form method=\"post\" action=\"/a/comment.php?fs=8&amp;actionsource=13&amp;redirectosoftpermalink&amp;comment_logging&amp;ft_ent_identifier=10153423098103441&amp;gfid=AQBxiw706o4qFX1Q&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059&amp;av=100009834785112&amp;refid=52\"><input type=\"hidden\" name=\"fb_dtsg\" value=\"AQGkTdGJ6C2Z:AQFGDL7UZmX0\" autocomplete=\"off\" /><input type=\"hidden\" name=\"charset_test\" value=\"&#x20ac;,&#xb4;,&#x20ac;,&#xb4;,&#x6c34;,&#x414;,&#x404;\" /><label class=\"cu\" for=\"u_0_2\">写评论...</label><table class=\"x y\" id=\"u_0_2\"><tbody><tr><td class=\"bb\"><div class=\"cv cw\"><table class=\"x cx cy\"><tbody><tr><td class=\"bb cz bq\"><input class=\"da db dc dd\" id=\"composerInput\" name=\"comment_text\" type=\"text\" /></td></tr></tbody></table></div></td><td class=\"z\"><div class=\"de\"><input value=\"&#x8bc4;&#x8bba;\" type=\"submit\" class=\"bu df dg dh\" /></div></td></tr></tbody></table><span class=\"di bg bh\"><a href=\"/friends/selector/?return_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153423098103441%26pap%26at%3Dcompose&amp;cancel_uri=%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D10153423098103441%26pap%26at%3Dcompose&amp;friends_key=ids&amp;refid=52&amp;_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059\">提及好友</a></span></form></div></div></div></div></div></div></div><img src=\"https://pixel.facebook.com/si/kappa/?Ko=sp\" class=\"k\" /></div></body></html>';
			let tests = (data) => {
				data[0].creator.name.should.equal('Erich Leten')
				data[0].creator.profileUrl.should.equal('/erich.leten?rc=p&refid=52&_ft_=qid.6254721210065053038%3Amf_story_key.41774056594996059');
				data[0].message.should.equal('I see child molesters.');
			}
			
			aid.doTest(done, html, tests);
		});

		it('fetch comments that have their content rapped in an extra div', (done) => {
				let html = '<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Comments</title><meta name="referrer" content="default" id="meta_referrer"><link rel="manifest" href="/data/manifest/" crossorigin="use-credentials"></head><body tabindex="0" class="b c d e"><div class="f"><div id="viewport"><div class="g"><h1 class="h" role="banner" id="header"><a class="i" href="/home.php?ref_component&#61;mbasic_home_logo&amp;ref_page&#61;%2Fwap%2Fstory.php&amp;refid&#61;52"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/5Zo8s-IGqA1.png" width="77" height="15" class="j k" alt="facebook"></a></h1></div><div id="objects_container"><div class="e" id="root" role="main"><div id="m_story_permalink_view"><div class="l"><div class="m n" id="u_0_0"><div><div><h3 class="o p"><span><strong><a href="/DailyMail/?refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;C">Daily Mail</a></strong></span></h3></div><div class="q" style=""><p>Products such as <a href="/Cheerios/?refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;%2As">Cheerios</a>, Kellogg\'s Corn Flakes, <a href="/DoritosANZ/?refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;%2As">Doritos</a> crisps and <a href="/ritzcrackers/?refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;%2As">Ritz Crackers</a> were found to have traces of glyphosate.</p></div><div class="r s"><a class="t u" href="http://lm.facebook.com/l.php?u&#61;http%3A%2F%2Fdailym.ai%2F2gdD1lI&amp;h&#61;QAQGqsUFy&amp;enc&#61;AZP641DHTEfprWyLAb0m1G26CkO6tp74peUDR_7J0iSMz-KLTqmVbuz15zyG9q7np_vd-Wd5gLy7m4kYnVSyRAFVGBKqhBkgjex8sj3Qo36QXxiaBrMEzzfYtbAg38igLzWQGRXtBCz_GiDvbvE4zM0whDVa30n7NgxXxzn5Stz9F7aczyyNty_fA-nKMHe9PO4muqfz2YjGO-cHl_FGYeCdM1CMaOr_QPuhgeR5Va_CabDJBM0h_Q54XJ6UFMfVfPh7QuJXcQC1AhJbB9QPMYjGTdd6qX1RfSp3dkXgseljDA&amp;s&#61;1" id="u_0_2" target="_blank"><div class="e v w"><table class="x y" role="presentation"><tbody><tr><td class="z ba"><img src="https://external.fper2-1.fna.fbcdn.net/safe_image.php?d&#61;AQBbAU0thKttu-zH&amp;w&#61;224&amp;h&#61;224&amp;url&#61;https%3A%2F%2Fs3.amazonaws.com%2Fprod-cust-photo-posts-jfaikqealaka%2F2836-cca745ab43c5bbfac69b1aece09819d3.png&amp;cfs&#61;1&amp;jq&#61;75&amp;ext&#61;jpg" width="112" height="112" class="k" role="presentation"></td><td class="bb"><h3 class="bc p bd">Weedkiller used on GM crops is found in snacks</h3><div class="bc be">dailymail.co.uk<div class="bc"></div></div></td></tr></tbody></table></div></a></div></div><div class="bf"><div class="bg bh"><abbr>4 mins</abbr><span aria-hidden="true"> · </span><span class="bi"><span><span class="bg">Public</span></span></span></div><div class="bg bh"><a href="/save/story/basic/?story_id&#61;S%3A_I164305410295882%3A1640002652726143&amp;action&#61;SAVE&amp;surface&#61;mbasic_story&amp;mechanism&#61;ufi_action_link&amp;after_cursor&#61;MTQ3OTI2NTU0NjoxNDc5MjY1NTQ2OjE6LTgwMDE4ODk0NDc0OTU0NzIyMTI6MTQ3OTI2NTI1Mzo2MzUzMzk3MTQzNDg3ODA0MTgx&amp;ext&#61;1479524747&amp;hash&#61;AeT7Lfvp8yjX_Dir&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143">Save</a><span aria-hidden="true"> · </span><a class="bj" href="/nfx/basic/direct_actions/?context_str&#61;%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22hideable_token%22%3A%22MzQzMTAwMDIzNTI3MjM0Ma5zzSsJzkgsSnUuSk0syczPCy7JL6qsqzM0MzE2MDUxNDCyNLWwMKqrM6gDAA%22%2C%22story_permalink_token%22%3A%22S%3A_I164305410295882%3A1640002652726143%22%7D&amp;redirect_uri&#61;https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1640002652726143%26id%3D164305410295882%26bacr%3D1479265546%253A1479265546%253A1%253A-8001889447495472212%253A1479265253%253A6353397143487804181%26refid%3D8%26_ft_%3Dqid.6353397143487804181%253Amf_story_key.-8001889447495472212%253Atop_level_post_id.1640002652726143&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143">More</a></div></div></div></div><div class="e bk" id="ufi_1640002652726143"><div class="bl bm"><div class="bn bo bp bq"><table class="x y" role="presentation"><tbody><tr><td class="bb br bs" style="width:25%"><a class="bt bu bv bw" href="/a/like.php?ul&amp;perm&amp;ifab&amp;ft_ent_identifier&#61;1640002652726143&amp;av&#61;100009543463363&amp;gfid&#61;AQCeV8lgluhy3ICu&amp;ref_component&#61;mbasic_photo_permalink_actionbar&amp;ref_page&#61;%2Fwap%2Fstory.php&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143" role="button" aria-pressed="false"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yc/r/yB-I64VDoBZ.png" width="16" height="16" class="bx by bz k" aria-hidden="true"><span class="ca">Like</span></a></td><td class="bb br bs" style="width:25%"><a class="bt bu bv bw" href="/reactions/picker/?ft_id&#61;1640002652726143&amp;origin_uri&#61;https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1640002652726143%26id%3D164305410295882%26bacr%3D1479265546%253A1479265546%253A1%253A-8001889447495472212%253A1479265253%253A6353397143487804181%26refid%3D8%26_ft_%3Dqid.6353397143487804181%253Amf_story_key.-8001889447495472212%253Atop_level_post_id.1640002652726143&amp;av&#61;100009543463363&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;refid&#61;52" role="button" aria-pressed="false"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/4o8rk0I8aTS.png" width="16" height="16" class="bx by k" aria-hidden="true"><span class="ca">React</span></a></td><td class="bb br bs" style="width:25%"><a class="bt bu bv bw" href="#composer-1640002652726143"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yx/r/Psiw6TN0rH8.png" width="16" height="16" class="bx by bz k" aria-hidden="true"><span class="ca">Comment</span></a></td><td class="bb br cb bs" style="width:25%"><a class="bt bu bv bw" href="/composer/mbasic/?c_src&#61;share&amp;referrer&#61;permalink&amp;target&#61;100009543463363&amp;sid&#61;1640002652726143&amp;m&#61;self&amp;exit_uri&#61;https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1640002652726143%26id%3D164305410295882%26bacr%3D1479265546%253A1479265546%253A1%253A-8001889447495472212%253A1479265253%253A6353397143487804181%26refid%3D8%26_ft_%3Dqid.6353397143487804181%253Amf_story_key.-8001889447495472212%253Atop_level_post_id.1640002652726143&amp;cwevent&#61;composer_entry&amp;av&#61;100009543463363&amp;view_overview&amp;ref_component&#61;mbasic_photo_permalink_actionbar&amp;ref_page&#61;%2Fwap%2Fstory.php&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yU/r/qQMCy4a8cyx.png" width="16" height="16" class="bx by bz k" aria-hidden="true"><span class="ca">Share</span></a></td></tr></tbody></table></div><div class="cc cd"><a class="ce" href="/ufi/reaction/profile/browser/?ft_ent_identifier&#61;1640002652726143&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143"><div class="cf cg"><span class="ch"><span class="ci"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yj/r/6WffvhOaXGY.png" width="16" height="16" class="k" role="presentation" alt="Like"></span><span class="ci"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/IfsimazVjj4.png" width="16" height="16" class="k" role="presentation" alt="Wow"></span><span class="ci"><img src="https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/6K8v8Ju8kL2.png" width="16" height="16" class="k" role="presentation" alt="Angry"></span></span><div class="cj" aria-label="29 left reactions including Like, Wow and Angry">29</div></div></a></div><div class="ck cl" id="composer-1640002652726143"><form method="post" action="/a/comment.php?fs&#61;8&amp;fr&#61;%2F&amp;actionsource&#61;1&amp;comment_logging&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQAtEwMEhqM2Dkhf&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;av&#61;100009543463363&amp;refid&#61;52"><input type="hidden" name="fb_dtsg" value="AQHK0VoB3wyB:AQFdxGcPsyXf" autocomplete="off"><input type="hidden" name="charset_test" value="€,´,€,´,水,Д,Є"><label class="cm" for="u_0_1">Write a comment...</label><table class="x y" role="presentation" id="u_0_1"><tbody><tr><td class="bb"><div class="cn co"><table class="x cp cq" role="presentation"><tbody><tr><td class="bb cr cs"><input class="ct cu cv cw" id="composerInput" name="comment_text" type="text"></td></tr></tbody></table></div></td><td class="z"><div class="cx"><input value="Comment" type="submit" class="bu cy cz da"></div></td></tr></tbody></table><span class="db bg bh"><a href="/friends/selector/?return_uri&#61;%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1640002652726143%26pap%26at%3Dcompose&amp;cancel_uri&#61;%2Fmbasic%2Fcomment%2Fadvanced%2F%3Ftarget_id%3D1640002652726143%26pap%26at%3Dcompose&amp;friends_key&#61;ids&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143">Mention Friends</a></span></form></div><div class="bl"><div class="v" id="1640009499392125"><div><h3><a class="dc" href="/profile.php?id&#61;100009110449905&amp;rc&#61;p&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Mark Briggs</a></h3><div>Really? Lol Monsanto</div><div class="bc dd de"><span class="df"><span class="dg bh"><a href="/a/comment.php?like_comment_id&#61;1640009499392125&amp;snowflake&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQDi_dl_W-lfxKiD&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken&#61;1640002652726143_1640009499392125&amp;actor_id&#61;100009543463363&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQAmeT_iHULtaYna&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R#comment_form_164305410295882_1640002652726143_reply_1640002652726143_1640009499392125">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str&#61;%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22reportable_ent_token%22%3A%22RW50R2VuZXJpY0NvbW1lbnQ6MTY0MDAwMjY1MjcyNjE0M18xNjQwMDA5NDk5MzkyMTI1%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri&#61;https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1640002652726143%26id%3D164305410295882%26bacr%3D1479265546%253A1479265546%253A1%253A-8001889447495472212%253A1479265253%253A6353397143487804181%26refid%3D8%26_ft_%3Dqid.6353397143487804181%253Amf_story_key.-8001889447495472212%253Atop_level_post_id.1640002652726143&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Report</a><span aria-hidden="true"> · </span><abbr>Just now</abbr></div></div></div><div class="v" id="1640008526058889"><div><h3><a class="dc" href="/Sandi.Cheney?rc&#61;p&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Sandi Cheney</a></h3><div>Glyphosate in food?!?!</div><div class="bc dd de"><span class="df"><span class="dg bh"><a href="/a/comment.php?like_comment_id&#61;1640008526058889&amp;snowflake&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQBpDjXOabodMelJ&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken&#61;1640002652726143_1640008526058889&amp;actor_id&#61;100009543463363&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQCy_HxUG-J5_1nd&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R#comment_form_164305410295882_1640002652726143_reply_1640002652726143_1640008526058889">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str&#61;%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22reportable_ent_token%22%3A%22RW50R2VuZXJpY0NvbW1lbnQ6MTY0MDAwMjY1MjcyNjE0M18xNjQwMDA4NTI2MDU4ODg5%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri&#61;https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1640002652726143%26id%3D164305410295882%26bacr%3D1479265546%253A1479265546%253A1%253A-8001889447495472212%253A1479265253%253A6353397143487804181%26refid%3D8%26_ft_%3Dqid.6353397143487804181%253Amf_story_key.-8001889447495472212%253Atop_level_post_id.1640002652726143&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Report</a><span aria-hidden="true"> · </span><abbr>2 minutes ago</abbr></div></div></div><div class="v" id="1640010512725357"><div><h3><a class="dc" href="/PrettyPrivleged?rc&#61;p&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Rachel Domek-Kossoy</a></h3><div><a href="/debbyjaeger?refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Debs Jama</a></div><div class="bc dd de"><span class="df"><span class="dg bh"><a href="/a/comment.php?like_comment_id&#61;1640010512725357&amp;snowflake&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQBOGlB655WsLXil&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Like</a></span></span><span aria-hidden="true"> · </span><a href="/comment/replies/?ctoken&#61;1640002652726143_1640010512725357&amp;actor_id&#61;100009543463363&amp;ft_ent_identifier&#61;1640002652726143&amp;gfid&#61;AQC0jimJnvDYwjK6&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R#comment_form_164305410295882_1640002652726143_reply_1640002652726143_1640010512725357">Reply</a><span aria-hidden="true"> · </span><a href="/nfx/basic/question/?context_str&#61;%7B%22breadcrumbs%22%3A%5B%5D%2C%22story_location%22%3A%22permalink%22%2C%22is_from_feed_tombstone%22%3Afalse%2C%22actions_taken%22%3A%22%22%2C%22is_rapid_reporting%22%3Afalse%2C%22reportable_ent_token%22%3A%22RW50R2VuZXJpY0NvbW1lbnQ6MTY0MDAwMjY1MjcyNjE0M18xNjQwMDEwNTEyNzI1MzU3%22%2C%22is_impostor%22%3A%22%22%7D&amp;redirect_uri&#61;https%3A%2F%2Fmbasic.facebook.com%2Fstory.php%3Fstory_fbid%3D1640002652726143%26id%3D164305410295882%26bacr%3D1479265546%253A1479265546%253A1%253A-8001889447495472212%253A1479265253%253A6353397143487804181%26refid%3D8%26_ft_%3Dqid.6353397143487804181%253Amf_story_key.-8001889447495472212%253Atop_level_post_id.1640002652726143&amp;refid&#61;52&amp;_ft_&#61;qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&amp;__tn__&#61;R">Report</a><span aria-hidden="true"> · </span><abbr>Just now</abbr></div></div></div></div><div id="add_comment_link_placeholder"></div></div></div></div><div></div></div></div></div></div></body></html>';
				let tests = (data) => {
					data[0].creator.name.should.equal('Mark Briggs')
					data[0].creator.profileUrl.should.equal('/profile.php?id=100009110449905&rc=p&refid=52&_ft_=qid.6353397143487804181%3Amf_story_key.-8001889447495472212%3Atop_level_post_id.1640002652726143&__tn__=R');
					data[0].message.should.equal('Really? Lol Monsanto');
				}

				aid.doTest(done, html, tests);
		});
	});
});